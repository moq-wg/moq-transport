<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Media over QUIC Transport</title>
<meta content="Suhas Nandakumar" name="author">
<meta content="Victor Vasiliev" name="author">
<meta content="Ian Swett" name="author">
<meta content="Alan Frindell" name="author">
<meta content="
       This document defines the core behavior for Media over QUIC Transport
(MOQT), a media transport protocol designed to operate over QUIC and
WebTransport, which have similar functionality. MOQT allows a producer of
media to publish data and have it consumed via subscription by a
multiplicity of endpoints. It supports intermediate content distribution
networks and is designed for high scale and low latency distribution. 
    " name="description">
<meta content="xml2rfc 3.29.0" name="generator">
<meta content="media over quic" name="keyword">
<meta content="draft-ietf-moq-transport-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.29.0
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.8
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.4
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-moq-transport.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">moq-transport</td>
<td class="right">July 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Nandakumar, et al.</td>
<td class="center">Expires 15 January 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Media Over QUIC</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-moq-transport-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-07-14" class="published">14 July 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-01-15">15 January 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Nandakumar</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">V. Vasiliev</div>
<div class="org">Google</div>
</div>
<div class="author">
      <div class="author-name">I. Swett, <span class="editor">Ed.</span>
</div>
<div class="org">Google</div>
</div>
<div class="author">
      <div class="author-name">A. Frindell, <span class="editor">Ed.</span>
</div>
<div class="org">Meta</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Media over QUIC Transport</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines the core behavior for Media over QUIC Transport
(MOQT), a media transport protocol designed to operate over QUIC and
WebTransport, which have similar functionality. MOQT allows a producer of
media to publish data and have it consumed via subscription by a
multiplicity of endpoints. It supports intermediate content distribution
networks and is designed for high scale and low latency distribution.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://moq-wg.github.io/moq-transport/draft-ietf-moq-transport.html">https://moq-wg.github.io/moq-transport/draft-ietf-moq-transport.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-moq-transport/">https://datatracker.ietf.org/doc/draft-ietf-moq-transport/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Media Over QUIC Working Group mailing list (<span><a href="mailto:moq@ietf.org">mailto:moq@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/moq/">https://mailarchive.ietf.org/arch/browse/moq/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/moq/">https://www.ietf.org/mailman/listinfo/moq/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/moq-wg/moq-transport">https://github.com/moq-wg/moq-transport</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 15 January 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-motivation" class="internal xref">Motivation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.1">
                    <p id="section-toc.1-1.1.2.1.2.1.1" class="keepWithNext"><a href="#section-1.1.1" class="auto internal xref">1.1.1</a>.  <a href="#name-latency" class="internal xref">Latency</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.2">
                    <p id="section-toc.1-1.1.2.1.2.2.1" class="keepWithNext"><a href="#section-1.1.2" class="auto internal xref">1.1.2</a>.  <a href="#name-leveraging-quic" class="internal xref">Leveraging QUIC</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.3">
                    <p id="section-toc.1-1.1.2.1.2.3.1" class="keepWithNext"><a href="#section-1.1.3" class="auto internal xref">1.1.3</a>.  <a href="#name-convergence" class="internal xref">Convergence</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.4">
                    <p id="section-toc.1-1.1.2.1.2.4.1"><a href="#section-1.1.4" class="auto internal xref">1.1.4</a>.  <a href="#name-relays" class="internal xref">Relays</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-terms-and-definitions" class="internal xref">Terms and Definitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-notational-conventions" class="internal xref">Notational Conventions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3.2.1">
                    <p id="section-toc.1-1.1.2.3.2.1.1"><a href="#section-1.3.1" class="auto internal xref">1.3.1</a>.  <a href="#name-location-structure" class="internal xref">Location Structure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3.2.2">
                    <p id="section-toc.1-1.1.2.3.2.2.1"><a href="#section-1.3.2" class="auto internal xref">1.3.2</a>.  <a href="#name-key-value-pair-structure" class="internal xref">Key-Value-Pair Structure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3.2.3">
                    <p id="section-toc.1-1.1.2.3.2.3.1"><a href="#section-1.3.3" class="auto internal xref">1.3.3</a>.  <a href="#name-reason-phrase-structure" class="internal xref">Reason Phrase Structure</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-object-data-model" class="internal xref">Object Data Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-objects" class="internal xref">Objects</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-subgroups" class="internal xref">Subgroups</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-groups" class="internal xref">Groups</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="auto internal xref">2.3.1</a>.  <a href="#name-group-ordering" class="internal xref">Group Ordering</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-track" class="internal xref">Track</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.1">
                    <p id="section-toc.1-1.2.2.4.2.1.1"><a href="#section-2.4.1" class="auto internal xref">2.4.1</a>.  <a href="#name-track-naming" class="internal xref">Track Naming</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="auto internal xref">2.5</a>.  <a href="#name-malformed-tracks" class="internal xref">Malformed Tracks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5.2.1">
                    <p id="section-toc.1-1.2.2.5.2.1.1"><a href="#section-2.5.1" class="auto internal xref">2.5.1</a>.  <a href="#name-scope" class="internal xref">Scope</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-sessions" class="internal xref">Sessions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-session-establishment" class="internal xref">Session establishment</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-webtransport" class="internal xref">WebTransport</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.  <a href="#name-quic" class="internal xref">QUIC</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="auto internal xref">3.1.3</a>.  <a href="#name-connection-url" class="internal xref">Connection URL</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-version-and-extension-negot" class="internal xref">Version and Extension Negotiation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-session-initialization" class="internal xref">Session initialization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-termination" class="internal xref">Termination</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-migration" class="internal xref">Migration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-congestion-control" class="internal xref">Congestion Control</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.1">
                    <p id="section-toc.1-1.3.2.6.2.1.1"><a href="#section-3.6.1" class="auto internal xref">3.6.1</a>.  <a href="#name-bufferbloat" class="internal xref">Bufferbloat</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.2">
                    <p id="section-toc.1-1.3.2.6.2.2.1"><a href="#section-3.6.2" class="auto internal xref">3.6.2</a>.  <a href="#name-application-limited" class="internal xref">Application-Limited</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.3">
                    <p id="section-toc.1-1.3.2.6.2.3.1"><a href="#section-3.6.3" class="auto internal xref">3.6.3</a>.  <a href="#name-consistent-throughput" class="internal xref">Consistent Throughput</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-publishing-and-retrieving-t" class="internal xref">Publishing and Retrieving Tracks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-subscriptions" class="internal xref">Subscriptions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-namespace-discovery" class="internal xref">Namespace Discovery</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-subscribing-to-namespaces" class="internal xref">Subscribing to Namespaces</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-announcements" class="internal xref">Announcements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-priorities" class="internal xref">Priorities</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-definitions" class="internal xref">Definitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-scheduling-algorithm" class="internal xref">Scheduling Algorithm</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-considerations-for-setting-" class="internal xref">Considerations for Setting Priorities</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-relays-2" class="internal xref">Relays</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-caching-relays" class="internal xref">Caching Relays</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-subscriber-interactions" class="internal xref">Subscriber Interactions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-graceful-subscriber-relay-s" class="internal xref">Graceful Subscriber Relay Switchover</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-publisher-interactions" class="internal xref">Publisher Interactions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="auto internal xref">7.3.1</a>.  <a href="#name-graceful-publisher-network-" class="internal xref">Graceful Publisher Network Switchover</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="auto internal xref">7.3.2</a>.  <a href="#name-graceful-publisher-relay-sw" class="internal xref">Graceful Publisher Relay Switchover</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-relay-object-handling" class="internal xref">Relay Object Handling</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-control-messages" class="internal xref">Control Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-request-id" class="internal xref">Request ID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-parameters" class="internal xref">Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a href="#section-8.2.1" class="auto internal xref">8.2.1</a>.  <a href="#name-version-specific-parameters" class="internal xref">Version Specific Parameters</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-client_setup-and-server_set" class="internal xref">CLIENT_SETUP and SERVER_SETUP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.1">
                    <p id="section-toc.1-1.8.2.3.2.1.1"><a href="#section-8.3.1" class="auto internal xref">8.3.1</a>.  <a href="#name-versions" class="internal xref">Versions</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.2">
                    <p id="section-toc.1-1.8.2.3.2.2.1"><a href="#section-8.3.2" class="auto internal xref">8.3.2</a>.  <a href="#name-setup-parameters" class="internal xref">Setup Parameters</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-goaway" class="internal xref">GOAWAY</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-max_request_id-2" class="internal xref">MAX_REQUEST_ID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="auto internal xref">8.6</a>.  <a href="#name-requests_blocked" class="internal xref">REQUESTS_BLOCKED</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a href="#section-8.7" class="auto internal xref">8.7</a>.  <a href="#name-subscribe" class="internal xref">SUBSCRIBE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.8">
                <p id="section-toc.1-1.8.2.8.1"><a href="#section-8.8" class="auto internal xref">8.8</a>.  <a href="#name-subscribe_ok" class="internal xref">SUBSCRIBE_OK</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.9">
                <p id="section-toc.1-1.8.2.9.1"><a href="#section-8.9" class="auto internal xref">8.9</a>.  <a href="#name-subscribe_error" class="internal xref">SUBSCRIBE_ERROR</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.10">
                <p id="section-toc.1-1.8.2.10.1"><a href="#section-8.10" class="auto internal xref">8.10</a>. <a href="#name-subscribe_update" class="internal xref">SUBSCRIBE_UPDATE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.11">
                <p id="section-toc.1-1.8.2.11.1"><a href="#section-8.11" class="auto internal xref">8.11</a>. <a href="#name-unsubscribe" class="internal xref">UNSUBSCRIBE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.12">
                <p id="section-toc.1-1.8.2.12.1"><a href="#section-8.12" class="auto internal xref">8.12</a>. <a href="#name-subscribe_done" class="internal xref">SUBSCRIBE_DONE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.13">
                <p id="section-toc.1-1.8.2.13.1"><a href="#section-8.13" class="auto internal xref">8.13</a>. <a href="#name-publish" class="internal xref">PUBLISH</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.14">
                <p id="section-toc.1-1.8.2.14.1"><a href="#section-8.14" class="auto internal xref">8.14</a>. <a href="#name-publish_ok" class="internal xref">PUBLISH_OK</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.15">
                <p id="section-toc.1-1.8.2.15.1"><a href="#section-8.15" class="auto internal xref">8.15</a>. <a href="#name-publish_error" class="internal xref">PUBLISH_ERROR</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.16">
                <p id="section-toc.1-1.8.2.16.1"><a href="#section-8.16" class="auto internal xref">8.16</a>. <a href="#name-fetch" class="internal xref">FETCH</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.16.2.1">
                    <p id="section-toc.1-1.8.2.16.2.1.1"><a href="#section-8.16.1" class="auto internal xref">8.16.1</a>.  <a href="#name-calculating-the-range-of-a-" class="internal xref">Calculating the Range of a Relative Joining Fetch</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.16.2.2">
                    <p id="section-toc.1-1.8.2.16.2.2.1"><a href="#section-8.16.2" class="auto internal xref">8.16.2</a>.  <a href="#name-calculating-the-range-of-an" class="internal xref">Calculating the Range of an Absolute Joining Fetch</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.17">
                <p id="section-toc.1-1.8.2.17.1"><a href="#section-8.17" class="auto internal xref">8.17</a>. <a href="#name-fetch_ok" class="internal xref">FETCH_OK</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.18">
                <p id="section-toc.1-1.8.2.18.1"><a href="#section-8.18" class="auto internal xref">8.18</a>. <a href="#name-fetch_error" class="internal xref">FETCH_ERROR</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.19">
                <p id="section-toc.1-1.8.2.19.1"><a href="#section-8.19" class="auto internal xref">8.19</a>. <a href="#name-fetch_cancel" class="internal xref">FETCH_CANCEL</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.20">
                <p id="section-toc.1-1.8.2.20.1"><a href="#section-8.20" class="auto internal xref">8.20</a>. <a href="#name-track_status" class="internal xref">TRACK_STATUS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.21">
                <p id="section-toc.1-1.8.2.21.1"><a href="#section-8.21" class="auto internal xref">8.21</a>. <a href="#name-track_status_ok" class="internal xref">TRACK_STATUS_OK</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.22">
                <p id="section-toc.1-1.8.2.22.1"><a href="#section-8.22" class="auto internal xref">8.22</a>. <a href="#name-track_status_error" class="internal xref">TRACK_STATUS_ERROR</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.23">
                <p id="section-toc.1-1.8.2.23.1"><a href="#section-8.23" class="auto internal xref">8.23</a>. <a href="#name-announce" class="internal xref">ANNOUNCE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.24">
                <p id="section-toc.1-1.8.2.24.1"><a href="#section-8.24" class="auto internal xref">8.24</a>. <a href="#name-announce_ok" class="internal xref">ANNOUNCE_OK</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.25">
                <p id="section-toc.1-1.8.2.25.1"><a href="#section-8.25" class="auto internal xref">8.25</a>. <a href="#name-announce_error" class="internal xref">ANNOUNCE_ERROR</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.26">
                <p id="section-toc.1-1.8.2.26.1"><a href="#section-8.26" class="auto internal xref">8.26</a>. <a href="#name-unannounce" class="internal xref">UNANNOUNCE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.27">
                <p id="section-toc.1-1.8.2.27.1"><a href="#section-8.27" class="auto internal xref">8.27</a>. <a href="#name-announce_cancel" class="internal xref">ANNOUNCE_CANCEL</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.28">
                <p id="section-toc.1-1.8.2.28.1"><a href="#section-8.28" class="auto internal xref">8.28</a>. <a href="#name-subscribe_namespace" class="internal xref">SUBSCRIBE_NAMESPACE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.29">
                <p id="section-toc.1-1.8.2.29.1"><a href="#section-8.29" class="auto internal xref">8.29</a>. <a href="#name-subscribe_namespace_ok" class="internal xref">SUBSCRIBE_NAMESPACE_OK</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.30">
                <p id="section-toc.1-1.8.2.30.1"><a href="#section-8.30" class="auto internal xref">8.30</a>. <a href="#name-subscribe_namespace_error" class="internal xref">SUBSCRIBE_NAMESPACE_ERROR</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.31">
                <p id="section-toc.1-1.8.2.31.1"><a href="#section-8.31" class="auto internal xref">8.31</a>. <a href="#name-unsubscribe_namespace" class="internal xref">UNSUBSCRIBE_NAMESPACE</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-data-streams-and-datagrams" class="internal xref">Data Streams and Datagrams</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-track-alias" class="internal xref">Track Alias</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-objects-2" class="internal xref">Objects</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a href="#section-9.2.1" class="auto internal xref">9.2.1</a>.  <a href="#name-canonical-object-properties" class="internal xref">Canonical Object Properties</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-datagrams" class="internal xref">Datagrams</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.1">
                    <p id="section-toc.1-1.9.2.3.2.1.1"><a href="#section-9.3.1" class="auto internal xref">9.3.1</a>.  <a href="#name-object-datagram" class="internal xref">Object Datagram</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.2">
                    <p id="section-toc.1-1.9.2.3.2.2.1"><a href="#section-9.3.2" class="auto internal xref">9.3.2</a>.  <a href="#name-object-datagram-status" class="internal xref">Object Datagram Status</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-streams" class="internal xref">Streams</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.1">
                    <p id="section-toc.1-1.9.2.4.2.1.1"><a href="#section-9.4.1" class="auto internal xref">9.4.1</a>.  <a href="#name-stream-cancellation" class="internal xref">Stream Cancellation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.2">
                    <p id="section-toc.1-1.9.2.4.2.2.1"><a href="#section-9.4.2" class="auto internal xref">9.4.2</a>.  <a href="#name-subgroup-header" class="internal xref">Subgroup Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.3">
                    <p id="section-toc.1-1.9.2.4.2.3.1"><a href="#section-9.4.3" class="auto internal xref">9.4.3</a>.  <a href="#name-closing-subgroup-streams" class="internal xref">Closing Subgroup Streams</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.4">
                    <p id="section-toc.1-1.9.2.4.2.4.1"><a href="#section-9.4.4" class="auto internal xref">9.4.4</a>.  <a href="#name-fetch-header" class="internal xref">Fetch Header</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="auto internal xref">9.5</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-extension-headers" class="internal xref">Extension Headers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-prior-group-id-gap" class="internal xref">Prior Group ID Gap</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-resource-exhaustion" class="internal xref">Resource Exhaustion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-timeouts" class="internal xref">Timeouts</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref"></a><a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="auto internal xref"></a><a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="auto internal xref"></a><a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-change-log" class="internal xref">Change Log</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-since-draft-ietf-moq-transp" class="internal xref">Since draft-ietf-moq-transport-12</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-since-draft-ietf-moq-transpo" class="internal xref">Since draft-ietf-moq-transport-11</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-since-draft-ietf-moq-transpor" class="internal xref">Since draft-ietf-moq-transport-10</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Media Over QUIC Transport (MOQT) is a protocol that is optimized
for the QUIC protocol <span>[<a href="#QUIC" class="cite xref">QUIC</a>]</span>, either directly or via WebTransport
<span>[<a href="#WebTransport" class="cite xref">WebTransport</a>]</span>, for the dissemination of media. MOQT utilizes a
publish/subscribe workflow in which producers of media publish data in
response to subscription requests from a multiplicity of endpoints. MOQT
supports wide range of use-cases with different resiliency and latency
(live, interactive) needs without compromising the scalability and cost
effectiveness associated with content delivery networks.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">MOQT is a generic protocol designed to work in concert with multiple
MoQ Streaming Formats. These MoQ Streaming Formats define how content is
encoded, packaged, and mapped to MOQT objects, along with policies for
discovery and subscription.<a href="#section-1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">
          <p id="section-1-3.1.1"><a href="#model" class="auto internal xref">Section 2</a> describes the data model employed by MOQT.<a href="#section-1-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.2">
          <p id="section-1-3.2.1"><a href="#session" class="auto internal xref">Section 3</a> covers aspects of setting up an MOQT session.<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.3">
          <p id="section-1-3.3.1"><a href="#priorities" class="auto internal xref">Section 6</a> covers mechanisms for prioritizing subscriptions.<a href="#section-1-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.4">
          <p id="section-1-3.4.1"><a href="#relays-moq" class="auto internal xref">Section 7</a> covers behavior at the relay entities.<a href="#section-1-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.5">
          <p id="section-1-3.5.1"><a href="#message" class="auto internal xref">Section 8</a> covers how control messages are encoded on the wire.<a href="#section-1-3.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.6">
          <p id="section-1-3.6.1"><a href="#data-streams" class="auto internal xref">Section 9</a> covers how data messages are encoded on the wire.<a href="#section-1-3.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="motivation">
<section id="section-1.1">
        <h3 id="name-motivation">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-motivation" class="section-name selfRef">Motivation</a>
        </h3>
<p id="section-1.1-1">The development of MOQT is driven by goals in a number of areas -
specifically latency, the robust feature set of QUIC and relay
support.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<div id="latency">
<section id="section-1.1.1">
          <h4 id="name-latency">
<a href="#section-1.1.1" class="section-number selfRef">1.1.1. </a><a href="#name-latency" class="section-name selfRef">Latency</a>
          </h4>
<p id="section-1.1.1-1">Latency is necessary to correct for variable network throughput. Ideally live
content is consumed at the same bitrate it is produced. End-to-end latency would
be fixed and only subject to encoding and transmission delays. Unfortunately,
networks have variable throughput, primarily due to congestion. Attempting to
deliver content encoded at a higher bitrate than the network can cause
queuing along the path from producer to consumer. The speed at which a protocol
can detect and respond to congestion determines the overall latency. TCP-based
protocols are simple but are slow to detect congestion and suffer from
head-of-line blocking. Protocols utilizing UDP directly can avoid queuing, but
the application is then responsible for the complexity of fragmentation,
congestion control, retransmissions, receiver feedback, reassembly, and
more. One goal of MOQT is to achieve the best of both these worlds: leverage the
features of QUIC to create a simple yet flexible low latency protocol that can
rapidly detect and respond to congestion.<a href="#section-1.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="leveraging-quic">
<section id="section-1.1.2">
          <h4 id="name-leveraging-quic">
<a href="#section-1.1.2" class="section-number selfRef">1.1.2. </a><a href="#name-leveraging-quic" class="section-name selfRef">Leveraging QUIC</a>
          </h4>
<p id="section-1.1.2-1">The parallel nature of QUIC streams can provide improvements in the face
of loss. A goal of MOQT is to design a streaming protocol to leverage
the transmission benefits afforded by parallel QUIC streams as well
exercising options for flexible loss recovery.<a href="#section-1.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="convergence">
<section id="section-1.1.3">
          <h4 id="name-convergence">
<a href="#section-1.1.3" class="section-number selfRef">1.1.3. </a><a href="#name-convergence" class="section-name selfRef">Convergence</a>
          </h4>
<p id="section-1.1.3-1">Some live media architectures today have separate protocols for ingest and
distribution, for example RTMP and HTTP based HLS or DASH. Switching protocols
necessitates intermediary origins which re-package the
media content. While specialization can have its benefits, there are efficiency
gains to be had in not having to re-package content. A goal of MOQT is to
develop a single protocol which can be used for transmission from contribution
to distribution. A related goal is the ability to support existing encoding and
packaging schemas, both for backwards compatibility and for interoperability
with the established content preparation ecosystem.<a href="#section-1.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="relays">
<section id="section-1.1.4">
          <h4 id="name-relays">
<a href="#section-1.1.4" class="section-number selfRef">1.1.4. </a><a href="#name-relays" class="section-name selfRef">Relays</a>
          </h4>
<p id="section-1.1.4-1">An integral feature of a protocol being successful is its ability to
deliver media at scale. Greatest scale is achieved when third-party
networks, independent of both the publisher and subscriber, can be
leveraged to relay the content. These relays must cache content for
distribution efficiency while simultaneously routing content and
deterministically responding to congestion in a multi-tenant network. A
goal of MOQT is to treat relays as first-class citizens of the protocol
and ensure that objects are structured such that information necessary
for distribution is available to relays while the media content itself
remains opaque and private.<a href="#section-1.1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="terms-and-definitions">
<section id="section-1.2">
        <h3 id="name-terms-and-definitions">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terms-and-definitions" class="section-name selfRef">Terms and Definitions</a>
        </h3>
<p id="section-1.2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">The following terms are used with the first letter capitalized.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.2-3">
          <dt id="section-1.2-3.1">Application:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.2">
            <p id="section-1.2-3.2.1">The entity using MOQT to transmit and receive data.<a href="#section-1.2-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.3">Client:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.4">
            <p id="section-1.2-3.4.1">The party initiating a Transport Session.<a href="#section-1.2-3.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.5">Server:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.6">
            <p id="section-1.2-3.6.1">The party accepting an incoming Transport Session.<a href="#section-1.2-3.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.7">Endpoint:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.8">
            <p id="section-1.2-3.8.1">A Client or Server.<a href="#section-1.2-3.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.9">Peer:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.10">
            <p id="section-1.2-3.10.1">The other endpoint than the one being described<a href="#section-1.2-3.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.11">Publisher:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.12">
            <p id="section-1.2-3.12.1">An endpoint that handles subscriptions by sending requested Objects from the requested track.<a href="#section-1.2-3.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.13">Subscriber:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.14">
            <p id="section-1.2-3.14.1">An endpoint that subscribes to and receives tracks.<a href="#section-1.2-3.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.15">Original Publisher:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.16">
            <p id="section-1.2-3.16.1">The initial publisher of a given track.<a href="#section-1.2-3.16.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.17">End Subscriber:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.18">
            <p id="section-1.2-3.18.1">A subscriber that initiates a subscription and does not send the data on to other subscribers.<a href="#section-1.2-3.18.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.19">Relay:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.20">
            <p id="section-1.2-3.20.1">An entity that is both a Publisher and a Subscriber, but not the Original
Publisher or End Subscriber.<a href="#section-1.2-3.20.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.21">Upstream:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.22">
            <p id="section-1.2-3.22.1">In the direction of the Original Publisher<a href="#section-1.2-3.22.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.23">Downstream:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.24">
            <p id="section-1.2-3.24.1">In the direction of the End Subscriber(s)<a href="#section-1.2-3.24.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.25">Transport Session:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.26">
            <p id="section-1.2-3.26.1">A raw QUIC connection or a WebTransport session.<a href="#section-1.2-3.26.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.27">Stream:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.28">
            <p id="section-1.2-3.28.1">A bidirectional or unidirectional bytestream provided by the
QUIC transport or WebTransport.<a href="#section-1.2-3.28.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.29">Congestion:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.30">
            <p id="section-1.2-3.30.1">Packet loss and queuing caused by degraded or overloaded networks.<a href="#section-1.2-3.30.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.31">Group:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.32">
            <p id="section-1.2-3.32.1">A temporal sequence of objects. A group represents a join point in a
track. See (<a href="#model-group" class="auto internal xref">Section 2.3</a>).<a href="#section-1.2-3.32.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.33">Object:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.34">
            <p id="section-1.2-3.34.1">An object is an addressable unit whose payload is a sequence of
bytes. Objects form the base element in the MOQT data model. See
(<a href="#model-object" class="auto internal xref">Section 2.1</a>).<a href="#section-1.2-3.34.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.35">Track:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.36">
            <p id="section-1.2-3.36.1">A track is a collection of groups. See (<a href="#model-track" class="auto internal xref">Section 2.4</a>).<a href="#section-1.2-3.36.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="notational-conventions">
<section id="section-1.3">
        <h3 id="name-notational-conventions">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-notational-conventions" class="section-name selfRef">Notational Conventions</a>
        </h3>
<p id="section-1.3-1">This document uses the conventions detailed in (<span>[<a href="#RFC9000" class="cite xref">RFC9000</a>], <a href="https://rfc-editor.org/rfc/rfc9000#section-1.3" class="relref">Section 1.3</a></span>)
when describing the binary encoding.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">As a quick reference, the following list provides a non normative summary
of the parts of RFC9000 field syntax that are used in this specification.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.3-3">
          <dt id="section-1.3-3.1">x (L):</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-3.2">
            <p id="section-1.3-3.2.1">Indicates that x is L bits long<a href="#section-1.3-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-3.3">x (i):</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-3.4">
            <p id="section-1.3-3.4.1">Indicates that x holds an integer value using the variable-length
encoding as described in (<span>[<a href="#RFC9000" class="cite xref">RFC9000</a>], <a href="https://rfc-editor.org/rfc/rfc9000#section-16" class="relref">Section 16</a></span>)<a href="#section-1.3-3.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-3.5">x (..):</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-3.6">
            <p id="section-1.3-3.6.1">Indicates that x can be any length including zero bits long.  Values
 in this format always end on a byte boundary.<a href="#section-1.3-3.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-3.7">[x (L)]:</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-3.8">
            <p id="section-1.3-3.8.1">Indicates that x is optional and has a length of L<a href="#section-1.3-3.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-3.9">x (L) ...:</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-3.10">
            <p id="section-1.3-3.10.1">Indicates that x is repeated zero or more times and that each instance
has a length of L<a href="#section-1.3-3.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.3-4">This document extends the RFC9000 syntax and with the additional field types:<a href="#section-1.3-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.3-5">
          <dt id="section-1.3-5.1">x (b):</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-5.2">
            <p id="section-1.3-5.2.1">Indicates that x consists of a variable length integer encoding as
described in (<span>[<a href="#RFC9000" class="cite xref">RFC9000</a>], <a href="https://rfc-editor.org/rfc/rfc9000#section-16" class="relref">Section 16</a></span>), followed by that many bytes
of binary data<a href="#section-1.3-5.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-5.3">x (tuple):</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-5.4">
            <p id="section-1.3-5.4.1">Indicates that x is a tuple, consisting of a variable length integer encoded
as described in (<span>[<a href="#RFC9000" class="cite xref">RFC9000</a>], <a href="https://rfc-editor.org/rfc/rfc9000#section-16" class="relref">Section 16</a></span>), followed by that many variable
length tuple fields, each of which are encoded as (b) above.<a href="#section-1.3-5.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.3-6">To reduce unnecessary use of bandwidth, variable length integers <span class="bcp14">SHOULD</span>
be encoded using the least number of bytes possible to represent the
required value.<a href="#section-1.3-6" class="pilcrow">¶</a></p>
<div id="location-structure">
<section id="section-1.3.1">
          <h4 id="name-location-structure">
<a href="#section-1.3.1" class="section-number selfRef">1.3.1. </a><a href="#name-location-structure" class="section-name selfRef">Location Structure</a>
          </h4>
<p id="section-1.3.1-1">Location identifies a particular Object in a Group within a Track.<a href="#section-1.3.1-1" class="pilcrow">¶</a></p>
<span id="name-location-structure-2"></span><div id="moq-location">
<figure id="figure-1">
            <div class="alignLeft art-text artwork" id="section-1.3.1-2.1">
<pre>
Location {
  Group (i),
  Object (i)
}
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-location-structure-2" class="selfRef">Location structure</a>
            </figcaption></figure>
</div>
<p id="section-1.3.1-3">In this document, the constituent parts of any Location A can be referred to
using A.Group or A.Object.<a href="#section-1.3.1-3" class="pilcrow">¶</a></p>
<p id="section-1.3.1-4">Location A &lt; Location B if:<a href="#section-1.3.1-4" class="pilcrow">¶</a></p>
<p id="section-1.3.1-5"><code>A.Group &lt; B.Group || (A.Group == B.Group &amp;&amp; A.Object &lt; B.Object)</code><a href="#section-1.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-value-pair-structure">
<section id="section-1.3.2">
          <h4 id="name-key-value-pair-structure">
<a href="#section-1.3.2" class="section-number selfRef">1.3.2. </a><a href="#name-key-value-pair-structure" class="section-name selfRef">Key-Value-Pair Structure</a>
          </h4>
<p id="section-1.3.2-1">Key-Value-Pair is a flexible structure designed to carry key/value
pairs in which the key is a variable length integer and the value
is either a variable length integer or a byte field of arbitrary
length.<a href="#section-1.3.2-1" class="pilcrow">¶</a></p>
<p id="section-1.3.2-2">Key-Value-Pair is used in both the data plane and control plane, but
is optimized for use in the data plane.<a href="#section-1.3.2-2" class="pilcrow">¶</a></p>
<span id="name-moqt-key-value-pair"></span><div id="moq-key-value-pair">
<figure id="figure-2">
            <div class="alignLeft art-text artwork" id="section-1.3.2-3.1">
<pre>
Key-Value-Pair {
  Type (i),
  [Length (i),]
  Value (..)
}
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-moqt-key-value-pair" class="selfRef">MOQT Key-Value-Pair</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-1.3.2-4.1">
              <p id="section-1.3.2-4.1.1">Type: an unsigned integer, encoded as a varint, identifying the
type of the value and also the subsequent serialization.<a href="#section-1.3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.3.2-4.2">
              <p id="section-1.3.2-4.2.1">Length: Only present when Type is odd. Specifies the length of the Value field.
The maximum length of a value is 2^16-1 bytes.  If an endpoint receives a
length larger than the maximum, it <span class="bcp14">MUST</span> close the session with a Protocol
Violation.<a href="#section-1.3.2-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.3.2-4.3">
              <p id="section-1.3.2-4.3.1">Value: A single varint encoded value when Type is even, otherwise a
sequence of Length bytes.<a href="#section-1.3.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.3.2-5">If a receiver understands a Type, and the following Value or
Length/Value does not match the serialization defined by that Type,
the receiver <span class="bcp14">MUST</span> terminate the session with error code 'Key-Value
Formatting Error'.<a href="#section-1.3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reason-phrase">
<section id="section-1.3.3">
          <h4 id="name-reason-phrase-structure">
<a href="#section-1.3.3" class="section-number selfRef">1.3.3. </a><a href="#name-reason-phrase-structure" class="section-name selfRef">Reason Phrase Structure</a>
          </h4>
<p id="section-1.3.3-1">Reason Phrase provides a way for the sender to encode additional diagnostic
information about the error condition, where appropriate.<a href="#section-1.3.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-1.3.3-2">
<pre>
Reason Phrase {
  Reason Phrase Length (i),
  Reason Phrase Value (..)
}
</pre><a href="#section-1.3.3-2" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-1.3.3-3.1">
              <p id="section-1.3.3-3.1.1">Reason Phrase Length: A variable-length integer specifying the length of the
reason phrase in bytes. The reason phrase length has a maximum length of
1024 bytes. If an endpoint receives a length exceeding the maximum, it <span class="bcp14">MUST</span>
close the session with a Protocol Violation<a href="#section-1.3.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.3.3-3.2">
              <p id="section-1.3.3-3.2.1">Reason Phrase Value: Additional diagnostic information about the error condition.
The reason phrase value is encoded as UTF-8 string and does not carry information,
such as language tags, that would aid comprehension by any entity other than
the one that created the text.<a href="#section-1.3.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="model">
<section id="section-2">
      <h2 id="name-object-data-model">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-object-data-model" class="section-name selfRef">Object Data Model</a>
      </h2>
<p id="section-2-1">MOQT has a hierarchical data model, comprised of tracks which contain
groups, and groups that contain objects. Inside of a group, the objects
can be organized into subgroups.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">To give an example of how an application might use this data model,
consider an application sending high and low resolution video using a
codec with temporal scalability. Each resolution is sent as a separate
track to allow the subscriber to pick the appropriate resolution given
the display environment and available bandwidth. Each "group of pictures"
in a video is sent as a group because the first frame is needed to
decode later frames. This allows the client to join at the logical points
where they can get the information to start decoding the media.
The temporal layers are sent as separate sub groups to allow the
priority mechanism to favour the base layer when there is not enough
bandwidth to send both the base and enhancement layers. Each frame of
video on a given layer is sent as a single object.<a href="#section-2-2" class="pilcrow">¶</a></p>
<div id="model-object">
<section id="section-2.1">
        <h3 id="name-objects">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-objects" class="section-name selfRef">Objects</a>
        </h3>
<p id="section-2.1-1">The basic data element of MOQT is an object.  An object is an
addressable unit whose payload is a sequence of bytes.  All objects
belong to a group, indicating ordering and potential
dependencies (see <a href="#model-group" class="auto internal xref">Section 2.3</a>).  An object is uniquely identified by
its track namespace, track name, group ID, and object ID, and must be an
identical sequence of bytes regardless of how or where it is retrieved.
An Object can become unavailable, but its contents <span class="bcp14">MUST NOT</span> change over
time.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">Objects are comprised of two parts: metadata and a payload.  The metadata is
never encrypted and is always visible to relays (see <a href="#relays-moq" class="auto internal xref">Section 7</a>). The
payload portion may be encrypted, in which case it is only visible to the
Original Publisher and End Subscribers. The Original Publisher is solely
responsible for the content of the object payload. This includes the
underlying encoding, compression, any end-to-end encryption, or
authentication. A relay <span class="bcp14">MUST NOT</span> combine, split, or otherwise modify object
payloads.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">Objects within a Group are ordered numerically by their Object ID.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="model-subgroup">
<section id="section-2.2">
        <h3 id="name-subgroups">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-subgroups" class="section-name selfRef">Subgroups</a>
        </h3>
<p id="section-2.2-1">A subgroup is a sequence of one or more objects from the same group
(<a href="#model-group" class="auto internal xref">Section 2.3</a>) in ascending order by Object ID. Objects in a subgroup
have a dependency and priority relationship consistent with sharing a
stream and are sent on a single stream whenever possible. A Group is delivered
using at least as many streams as there are Subgroups,
typically with a one-to-one mapping between Subgroups and streams.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">When a Track's forwarding preference (see <a href="#object-properties" class="auto internal xref">Section 9.2.1</a>) is
"Datagram", Objects are not sent in Subgroups and the
description in the remainder of this section does not apply.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">Streams offer in-order reliable delivery and the ability to cancel sending
and retransmission of data. Furthermore, many implementations offer the ability
to control the relative priority of streams, which allows control over the
scheduling of sending data on active streams.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">Every object within a Group belongs to exactly one Subgroup.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2-5">Objects from two subgroups cannot be sent on the same stream. Objects from the
same Subgroup <span class="bcp14">MUST NOT</span> be sent on different streams, unless one of the streams
was reset prematurely, or upstream conditions have forced objects from a Subgroup
to be sent out of Object ID order.<a href="#section-2.2-5" class="pilcrow">¶</a></p>
<p id="section-2.2-6">Original publishers assign each Subgroup a Subgroup ID, and do so as they see fit.  The
scope of a Subgroup ID is a Group, so Subgroups from different Groups <span class="bcp14">MAY</span> share a Subgroup
ID without implying any relationship between them. In general, publishers assign
objects to subgroups in order to leverage the features of streams as described
above.<a href="#section-2.2-6" class="pilcrow">¶</a></p>
<p id="section-2.2-7">An example strategy for using stream properties follows. If object B is
dependent on object A, then delivery of B can follow A, i.e. A and B can be
usefully delivered over a single stream. Furthermore, in this example:<a href="#section-2.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-8.1">
            <p id="section-2.2-8.1.1">If an object is dependent on all previous objects in a Subgroup, it is added to
that Subgroup.<a href="#section-2.2-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-8.2">
            <p id="section-2.2-8.2.1">If an object is not dependent on all of the objects in a Subgroup, it goes in
a different Subgroup.<a href="#section-2.2-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-8.3">
            <p id="section-2.2-8.3.1">There are often many ways to compose Subgroups that meet these criteria. Where
possible, choose the composition that results in the fewest Subgroups in a group
to minimize the number of streams used.<a href="#section-2.2-8.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="model-group">
<section id="section-2.3">
        <h3 id="name-groups">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-groups" class="section-name selfRef">Groups</a>
        </h3>
<p id="section-2.3-1">A group is a collection of Objects and is a sub-unit of a Track
(<a href="#model-track" class="auto internal xref">Section 2.4</a>).  Groups <span class="bcp14">SHOULD</span> be independently useful, so Objects within a
Group <span class="bcp14">SHOULD NOT</span> depend on Objects in other Groups. A Group provides a join
point for subscriptions, so a subscriber that does not want to receive the
entire Track can opt to receive only Groups starting from a given Group ID.
Groups can contain any number of Objects.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<div id="group-ordering">
<section id="section-2.3.1">
          <h4 id="name-group-ordering">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-group-ordering" class="section-name selfRef">Group Ordering</a>
          </h4>
<p id="section-2.3.1-1">Within a track, the original publisher <span class="bcp14">SHOULD</span> publish Group IDs which increase
with time (where "time" is defined according to the internal clock of the media
being sent). In some cases, Groups will be produced in increasing order, but sent
to subscribers in a different order, for example when the subscription's Group
Order is Descending.  Due to network reordering and the partial reliability
features of MOQT, Groups can always be received out of order.<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-2.3.1-2">As a result, subscribers cannot infer the existence of a Group until an object in
the Group is received. This can create gaps in a cache that can be filled
by doing a Fetch upstream, if necessary.<a href="#section-2.3.1-2" class="pilcrow">¶</a></p>
<p id="section-2.3.1-3">Applications that cannot produce Group IDs that increase with time are limited
to the subset of MOQT that does not compare group IDs. Subscribers to these
Tracks <span class="bcp14">SHOULD NOT</span> use range filters which span multiple Groups in FETCH or
SUBSCRIBE.  SUBSCRIBE and FETCH delivery use Group Order, so a FETCH cannot
deliver Groups out of order and a subscription could have unexpected delivery
order if Group IDs do not increase with time.<a href="#section-2.3.1-3" class="pilcrow">¶</a></p>
<p id="section-2.3.1-4">Note that the increase in time between two groups is not defined by the protocol.<a href="#section-2.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="model-track">
<section id="section-2.4">
        <h3 id="name-track">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-track" class="section-name selfRef">Track</a>
        </h3>
<p id="section-2.4-1">A track is a sequence of groups (<a href="#model-group" class="auto internal xref">Section 2.3</a>). It is the entity
against which a subscriber issues a subscription request.  A subscriber
can request to receive individual tracks starting at a group boundary,
including any new objects pushed by the publisher while the track is
active.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<div id="track-name">
<section id="section-2.4.1">
          <h4 id="name-track-naming">
<a href="#section-2.4.1" class="section-number selfRef">2.4.1. </a><a href="#name-track-naming" class="section-name selfRef">Track Naming</a>
          </h4>
<p id="section-2.4.1-1">In MOQT, every track is identified by a Full Track Name, consisting of a Track
Namespace and a Track Name.<a href="#section-2.4.1-1" class="pilcrow">¶</a></p>
<p id="section-2.4.1-2">Track Namespace is an ordered N-tuple of bytes where N can be between 1 and 32.
The structured nature of Track Namespace allows relays and applications to
manipulate prefixes of a namespace. If an endpoint receives a Track Namespace
tuple with an N of 0 or more than 32, it <span class="bcp14">MUST</span> close the session with a Protocol
Violation.<a href="#section-2.4.1-2" class="pilcrow">¶</a></p>
<p id="section-2.4.1-3">Track Name is a sequence of bytes that identifies an individual track within the
namespace.<a href="#section-2.4.1-3" class="pilcrow">¶</a></p>
<p id="section-2.4.1-4">The maximum total length of a Full Track Name is 4,096 bytes, computed as the
sum of the lengths of each Track Namespace tuple field and the Track Name length
field.  If an endpoint receives a Full Track Name exceeding this length, it <span class="bcp14">MUST</span>
close the session with a Protocol Violation.<a href="#section-2.4.1-4" class="pilcrow">¶</a></p>
<p id="section-2.4.1-5">In this specification, both the Track Namespace tuple fields and the Track Name
are not constrained to a specific encoding. They carry a sequence of bytes and
comparison between two Track Namespace tuple fields or Track Names is done by
exact comparison of the bytes. Specifications that use MOQT may constrain the
information in these fields, for example by restricting them to UTF-8. Any
specification that does needs to specify the canonicalization into the bytes in
the Track Namespace or Track Name such that exact comparison works.<a href="#section-2.4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="malformed-tracks">
<section id="section-2.5">
        <h3 id="name-malformed-tracks">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-malformed-tracks" class="section-name selfRef">Malformed Tracks</a>
        </h3>
<p id="section-2.5-1">There are multiple ways a publisher can transmit a Track that does not conform
to MoQT constraints. Such a Track is considered malformed.  Some example
conditions that constitute a malformed track when detected by a receiver
include:<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.5-2">
<li id="section-2.5-2.1">
            <p id="section-2.5-2.1.1">An Object is received on a Subgroup stream whose Object ID is not strictly
larger than the previous Object received on the same Subgroup.<a href="#section-2.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.5-2.2">
            <p id="section-2.5-2.2.1">An Object is received in a FETCH response with the same Group as the
previous Object, but whose Object ID is not strictly larger than the previous
object.<a href="#section-2.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.5-2.3">
            <p id="section-2.5-2.3.1">An Object is received in an Ascending FETCH response whose Group ID is smaller
than the previous Object in the response.<a href="#section-2.5-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.5-2.4">
            <p id="section-2.5-2.4.1">An Object is received in a Descending FETCH response whose Group ID is larger
than the previous Object in the resopnse.<a href="#section-2.5-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.5-2.5">
            <p id="section-2.5-2.5.1">A Subgroup or FETCH response is terminated with a FIN in the middle of an
Object<a href="#section-2.5-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.5-2.6">
            <p id="section-2.5-2.6.1">An Object is received whose Object ID is larger than the final Object in the
Subgroup.  The final Object in a Subgroup is the last Object received on a
Subgroup stream before a FIN.<a href="#section-2.5-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.5-2.7">
            <p id="section-2.5-2.7.1">A Subgroup is received with two or more different final Objects.<a href="#section-2.5-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.5-2.8">
            <p id="section-2.5-2.8.1">An Object is received in a Group whose Object ID is larger than the final
Object in the Group.  The final Object in a Group is the Object with Status
END_OF_GROUP or the last Object sent in a FETCH that requested the entire
Group.<a href="#section-2.5-2.8.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.5-2.9">
            <p id="section-2.5-2.9.1">An Object is received on a Track whose Group and Object ID are larger than the
final Object in the Track.  The final Object in a Track is the Object with
Status END_OF_TRACK or the last Object sent in a FETCH whose response indicated
End of Track.<a href="#section-2.5-2.9.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.5-2.10">
            <p id="section-2.5-2.10.1">The same Object is received more than once with different Payload or
other immutable properties.<a href="#section-2.5-2.10.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.5-2.11">
            <p id="section-2.5-2.11.1">An Object is received with a different Forwarding Preference than previously
observed from the same Track.<a href="#section-2.5-2.11.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-2.5-3">The above list of conditions is not considered exhaustive.<a href="#section-2.5-3" class="pilcrow">¶</a></p>
<p id="section-2.5-4">When a subscriber detects a Malformed Track, it <span class="bcp14">MUST</span> UNSUBSCRIBE from the
Track and <span class="bcp14">SHOULD</span> deliver an error to the application.  If a relay detects a
Malformed Track, it <span class="bcp14">MUST</span> immediately terminate downstream subscriptions with
SUBSCRIBE_DONE with Status Code <code>Malformed Track</code>.<a href="#section-2.5-4" class="pilcrow">¶</a></p>
<div id="track-scope">
<section id="section-2.5.1">
          <h4 id="name-scope">
<a href="#section-2.5.1" class="section-number selfRef">2.5.1. </a><a href="#name-scope" class="section-name selfRef">Scope</a>
          </h4>
<p id="section-2.5.1-1">An MOQT scope is a set of servers (as identified by their connection
URIs) for which the tuple of Track Name and Track Namespace are
guaranteed to be unique and identify a specific track. It is up to
the application using MOQT to define how broad or narrow the scope is.
An application that deals with connections between devices
on a local network may limit the scope to a single connection; by
contrast, an application that uses multiple CDNs to serve media may
require the scope to include all of those CDNs.<a href="#section-2.5.1-1" class="pilcrow">¶</a></p>
<p id="section-2.5.1-2">Because the tuple of Track Namespace and Track Name are unique within an
MOQT scope, they can be used as a cache key for the track.
If, at a given moment in time, two tracks within the same scope contain
different data, they <span class="bcp14">MUST</span> have different names and/or namespaces.
MOQT provides subscribers with the ability to alter the specific manner in
which tracks are delivered via Subscribe Parameters, but the actual content of
the tracks does not depend on those parameters; this is in contrast to
protocols like HTTP, where request headers can alter the server response.<a href="#section-2.5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="session">
<section id="section-3">
      <h2 id="name-sessions">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-sessions" class="section-name selfRef">Sessions</a>
      </h2>
<div id="session-establishment">
<section id="section-3.1">
        <h3 id="name-session-establishment">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-session-establishment" class="section-name selfRef">Session establishment</a>
        </h3>
<p id="section-3.1-1">This document defines a protocol that can be used interchangeably both
over a QUIC connection directly <span>[<a href="#QUIC" class="cite xref">QUIC</a>]</span>, and over WebTransport
<span>[<a href="#WebTransport" class="cite xref">WebTransport</a>]</span>.  Both provide streams and datagrams with similar
semantics (see <span>[<a href="#I-D.ietf-webtrans-overview" class="cite xref">I-D.ietf-webtrans-overview</a>], <a href="https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-overview-10#section-4" class="relref">Section 4</a></span>); thus, the
main difference lies in how the servers are identified and how the
connection is established. The [QUIC-DATAGRAM] extension
<span class="bcp14">MUST</span> be supported and negotiated in the QUIC connection used for MOQT,
which is already a requirement for WebTransport over HTTP/3. The
RESET_STREAM_AT <span>[<a href="#I-D.draft-ietf-quic-reliable-stream-reset" class="cite xref">I-D.draft-ietf-quic-reliable-stream-reset</a>]</span>
extension to QUIC can be used by MOQT, but the protocol is also
designed to work correctly when the extension is not supported.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">There is no definition of the protocol over other transports,
such as TCP, and applications using MoQ might need to fallback to
another protocol when QUIC or WebTransport aren't available.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<div id="webtransport">
<section id="section-3.1.1">
          <h4 id="name-webtransport">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-webtransport" class="section-name selfRef">WebTransport</a>
          </h4>
<p id="section-3.1.1-1">An MOQT server that is accessible via WebTransport can be identified
using an HTTPS URI (<span>[<a href="#RFC9110" class="cite xref">RFC9110</a>], <a href="https://rfc-editor.org/rfc/rfc9110#section-4.2.2" class="relref">Section 4.2.2</a></span>).  An MOQT session can be
established by sending an extended CONNECT request to the host and the
path indicated by the URI, as described in
(<span>[<a href="#WebTransport" class="cite xref">WebTransport</a>], <a href="https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-http3-13#section-3" class="relref">Section 3</a></span>).<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="quic">
<section id="section-3.1.2">
          <h4 id="name-quic">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-quic" class="section-name selfRef">QUIC</a>
          </h4>
<p id="section-3.1.2-1">An MOQT server that is accessible via native QUIC can be identified by a
URI with a "moqt" scheme.  The "moqt" URI scheme is defined as follows,
using definitions from <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>:<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1.2-2">
<pre>
moqt-URI = "moqt" "://" authority path-abempty [ "?" query ]
</pre><a href="#section-3.1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1.2-3">The <code>authority</code> portion <span class="bcp14">MUST NOT</span> contain an empty <code>host</code> portion.
The <code>moqt</code> URI scheme supports the <code>/.well-known/</code> path prefix defined in
<span>[<a href="#RFC8615" class="cite xref">RFC8615</a>]</span>.<a href="#section-3.1.2-3" class="pilcrow">¶</a></p>
<p id="section-3.1.2-4">This protocol does not specify any semantics on the <code>path-abempty</code> and
<code>query</code> portions of the URI.  The contents of those are left up to the
application.<a href="#section-3.1.2-4" class="pilcrow">¶</a></p>
<p id="section-3.1.2-5">The client can establish a connection to a MoQ server identified by a
given URI by setting up a QUIC connection to the host and port
identified by the <code>authority</code> section of the URI. The 'authority' is also
transmitted to the server in the AUTHORITY parameter, (<a href="#authority" class="auto internal xref">Section 8.3.2.1</a>) which is
sent in the CLIENT_SETUP message at the start of the session.  The
<code>path-abempty</code> and <code>query</code> portions of the URI are similarly communicated to the
server using the PATH parameter (<a href="#path" class="auto internal xref">Section 8.3.2.2</a>).  The ALPN value <span>[<a href="#RFC7301" class="cite xref">RFC7301</a>]</span> used by
the protocol is <code>moq-00</code>.<a href="#section-3.1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="connection-url">
<section id="section-3.1.3">
          <h4 id="name-connection-url">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-connection-url" class="section-name selfRef">Connection URL</a>
          </h4>
<p id="section-3.1.3-1">Each track <span class="bcp14">MAY</span> have one or more associated connection URLs specifying
network hosts through which a track may be accessed. The syntax of the
Connection URL and the associated connection setup procedures are
specific to the underlying transport protocol usage (see <a href="#session" class="auto internal xref">Section 3</a>).<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="version-negotiation">
<section id="section-3.2">
        <h3 id="name-version-and-extension-negot">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-version-and-extension-negot" class="section-name selfRef">Version and Extension Negotiation</a>
        </h3>
<p id="section-3.2-1">Endpoints use the exchange of Setup messages to negotiate the MOQT version and
any extensions to use.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The client indicates the MOQT versions it supports in the CLIENT_SETUP message
(see <a href="#message-setup" class="auto internal xref">Section 8.3</a>). It also includes the union of all Setup Parameters
(see <a href="#setup-params" class="auto internal xref">Section 8.3.2</a>) required for a handshake by any of those versions.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">Within any MOQT version, clients request the use of extensions by adding Setup
parameters corresponding to that extension. No extensions are defined in this
document.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">The server replies with a SERVER_SETUP message that indicates the chosen
version, includes all parameters required for a handshake in that version, and
parameters for every extension requested by the client that it supports.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">New versions of MOQT <span class="bcp14">MUST</span> specify which existing extensions can be used with
that version. New extensions <span class="bcp14">MUST</span> specify the existing versions with which they
can be used.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">If a given parameter carries the same information in multiple versions,
but might have different optimal values in those versions, there <span class="bcp14">SHOULD</span> be
separate Setup parameters for that information in each version.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="session-init">
<section id="section-3.3">
        <h3 id="name-session-initialization">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-session-initialization" class="section-name selfRef">Session initialization</a>
        </h3>
<p id="section-3.3-1">The first stream opened is a client-initiated bidirectional control stream where
the endpoints exchange Setup messages (<a href="#message-setup" class="auto internal xref">Section 8.3</a>), followed by other
messages defined in <a href="#message" class="auto internal xref">Section 8</a>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">This draft only specifies a single use of bidirectional streams. Objects are
sent on unidirectional streams.  Because there are no other uses of
bidirectional streams, a peer <span class="bcp14">MAY</span> currently close the session as a
'Protocol Violation' if it receives a second bidirectional stream.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">The control stream <span class="bcp14">MUST NOT</span> be closed at the underlying transport layer while the
session is active.  Doing so results in the session being closed as a
'Protocol Violation'.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="session-termination">
<section id="section-3.4">
        <h3 id="name-termination">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-termination" class="section-name selfRef">Termination</a>
        </h3>
<p id="section-3.4-1">The Transport Session can be terminated at any point.  When native QUIC
is used, the session is closed using the CONNECTION_CLOSE frame
(<span>[<a href="#QUIC" class="cite xref">QUIC</a>], <a href="https://rfc-editor.org/rfc/rfc9000#section-19.19" class="relref">Section 19.19</a></span>).  When WebTransport is used, the session is
closed using the CLOSE_WEBTRANSPORT_SESSION capsule (<span>[<a href="#WebTransport" class="cite xref">WebTransport</a>], <a href="https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-http3-13#section-5" class="relref">Section 5</a></span>).<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">When terminating the Session, the application <span class="bcp14">MAY</span> use any error message
and <span class="bcp14">SHOULD</span> use a relevant code, as defined below:<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Code</th>
              <th class="text-left" rowspan="1" colspan="1">Reason</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">No Error</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x1</td>
              <td class="text-left" rowspan="1" colspan="1">Internal Error</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x2</td>
              <td class="text-left" rowspan="1" colspan="1">Unauthorized</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x3</td>
              <td class="text-left" rowspan="1" colspan="1">Protocol Violation</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x4</td>
              <td class="text-left" rowspan="1" colspan="1">Invalid Request ID</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x5</td>
              <td class="text-left" rowspan="1" colspan="1">Duplicate Track Alias</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x6</td>
              <td class="text-left" rowspan="1" colspan="1">Key-Value Formatting Error</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x7</td>
              <td class="text-left" rowspan="1" colspan="1">Too Many Requests</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x8</td>
              <td class="text-left" rowspan="1" colspan="1">Invalid Path</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x9</td>
              <td class="text-left" rowspan="1" colspan="1">Malformed Path</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x10</td>
              <td class="text-left" rowspan="1" colspan="1">GOAWAY Timeout</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x11</td>
              <td class="text-left" rowspan="1" colspan="1">Control Message Timeout</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x12</td>
              <td class="text-left" rowspan="1" colspan="1">Data Stream Timeout</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x13</td>
              <td class="text-left" rowspan="1" colspan="1">Auth Token Cache Overflow</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x14</td>
              <td class="text-left" rowspan="1" colspan="1">Duplicate Auth Token Alias</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x15</td>
              <td class="text-left" rowspan="1" colspan="1">Version Negotiation Failed</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x16</td>
              <td class="text-left" rowspan="1" colspan="1">Malformed Auth Token</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x17</td>
              <td class="text-left" rowspan="1" colspan="1">Unknown Auth Token Alias</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x18</td>
              <td class="text-left" rowspan="1" colspan="1">Expired Auth Token</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x19</td>
              <td class="text-left" rowspan="1" colspan="1">Invalid Authority</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x1A</td>
              <td class="text-left" rowspan="1" colspan="1">Malformed Authority</td>
            </tr>
          </tbody>
        </table>
<ul class="normal">
<li class="normal" id="section-3.4-4.1">
            <p id="section-3.4-4.1.1">No Error: The session is being terminated without an error.<a href="#section-3.4-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.2">
            <p id="section-3.4-4.2.1">Internal Error: An implementation specific error occurred.<a href="#section-3.4-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.3">
            <p id="section-3.4-4.3.1">Unauthorized: The client is not authorized to establish a session.<a href="#section-3.4-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.4">
            <p id="section-3.4-4.4.1">Protocol Violation: The remote endpoint performed an action that was
disallowed by the specification.<a href="#section-3.4-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.5">
            <p id="section-3.4-4.5.1">Invalid Request ID: The session was closed because the endpoint used a Request
ID that was smaller than or equal to a previously received request ID, or the
least-significant bit of the request ID was incorrect for the endpoint.<a href="#section-3.4-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.6">
            <p id="section-3.4-4.6.1">Duplicate Track Alias: The endpoint attempted to use a Track Alias
that was already in use.<a href="#section-3.4-4.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.7">
            <p id="section-3.4-4.7.1">Key-Value Formatting Error: the key-value pair has a formatting error.<a href="#section-3.4-4.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.8">
            <p id="section-3.4-4.8.1">Too Many Requests: The session was closed because the endpoint used a
Request ID equal to or larger than the current Maximum Request ID.<a href="#section-3.4-4.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.9">
            <p id="section-3.4-4.9.1">Invalid Path: The PATH parameter was used by a server, on a WebTransport
session, or the server does not support the path.<a href="#section-3.4-4.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.10">
            <p id="section-3.4-4.10.1">Malformed Path: The PATH parameter does not conform to the rules in <a href="#path" class="auto internal xref">Section 8.3.2.2</a>.<a href="#section-3.4-4.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.11">
            <p id="section-3.4-4.11.1">GOAWAY Timeout: The session was closed because the peer took too long to
close the session in response to a GOAWAY (<a href="#message-goaway" class="auto internal xref">Section 8.4</a>) message.
See session migration (<a href="#session-migration" class="auto internal xref">Section 3.5</a>).<a href="#section-3.4-4.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.12">
            <p id="section-3.4-4.12.1">Control Message Timeout: The session was closed because the peer took too
long to respond to a control message.<a href="#section-3.4-4.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.13">
            <p id="section-3.4-4.13.1">Data Stream Timeout: The session was closed because the peer took too long to
send data expected on an open Data Stream (see <a href="#data-streams" class="auto internal xref">Section 9</a>).  This
includes fields of a stream header or an object header within a data
stream. If an endpoint times out waiting for a new object header on an open
subgroup stream, it <span class="bcp14">MAY</span> send a STOP_SENDING on that stream or terminate the
subscription.<a href="#section-3.4-4.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.14">
            <p id="section-3.4-4.14.1">Auth Token Cache Overflow - the Session limit <a href="#max-auth-token-cache-size" class="auto internal xref">Section 8.3.2.4</a> of
the size of all registered Authorization tokens has been exceeded.<a href="#section-3.4-4.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.15">
            <p id="section-3.4-4.15.1">Duplicate Auth Token Alias - Authorization Token attempted to register an
Alias that was in use (see <a href="#authorization-token" class="auto internal xref">Section 8.2.1.1</a>).<a href="#section-3.4-4.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.16">
            <p id="section-3.4-4.16.1">Version Negotiation Failed: The client didn't offer a version supported
by the server.<a href="#section-3.4-4.16.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.17">
            <p id="section-3.4-4.17.1">Malformed Auth Token - Invalid Auth Token serialization during registration
(see <a href="#authorization-token" class="auto internal xref">Section 8.2.1.1</a>).<a href="#section-3.4-4.17.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.18">
            <p id="section-3.4-4.18.1">Unknown Auth Token Alias - No registered token found for the provided Alias
(see <a href="#authorization-token" class="auto internal xref">Section 8.2.1.1</a>).<a href="#section-3.4-4.18.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.19">
            <p id="section-3.4-4.19.1">Expired Auth Token - Authorization token has expired <a href="#authorization-token" class="auto internal xref">Section 8.2.1.1</a>).<a href="#section-3.4-4.19.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.20">
            <p id="section-3.4-4.20.1">Invalid Authority - The specified AUTHORITY does not correspond to this server
or cannot be used in this context.<a href="#section-3.4-4.20.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.21">
            <p id="section-3.4-4.21.1">Malformed Authority - The AUTHORITY value is syntactically invalid.<a href="#section-3.4-4.21.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-5">An endpoint <span class="bcp14">MAY</span> choose to treat a subscription or request specific error as a
session error under certain circumstances, closing the entire session in
response to a condition with a single subscription or message. Implementations
need to consider the impact on other outstanding subscriptions before making
this choice.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="session-migration">
<section id="section-3.5">
        <h3 id="name-migration">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-migration" class="section-name selfRef">Migration</a>
        </h3>
<p id="section-3.5-1">MOQT requires a long-lived and stateful session. However, a service
provider needs the ability to shutdown/restart a server without waiting for all
sessions to drain naturally, as that can take days for long-form media.
MOQT enables proactively draining sessions via the GOAWAY message (<a href="#message-goaway" class="auto internal xref">Section 8.4</a>).<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">The server sends a GOAWAY message, signaling the client to establish a new
session and migrate any active subscriptions. The GOAWAY message optionally
contains a new URI for the new session, otherwise the current URI is
reused. The server <span class="bcp14">SHOULD</span> terminate the session with 'GOAWAY Timeout' after a
sufficient timeout if there are still open subscriptions or fetches on a
connection.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">When the server is a subscriber, it <span class="bcp14">SHOULD</span> send a GOAWAY message to downstream
subscribers prior to any UNSUBSCRIBE messages to upstream publishers.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<p id="section-3.5-4">After the client receives a GOAWAY, it's <span class="bcp14">RECOMMENDED</span> that the client waits until
there are no more active subscriptions before closing the session with NO_ERROR.
Ideally this is transparent to the application using MOQT, which involves
establishing a new session in the background and migrating active subscriptions
and announcements. The client can choose to delay closing the session if it
expects more OBJECTs to be delivered. The server closes the session with a
'GOAWAY Timeout' if the client doesn't close the session quickly enough.<a href="#section-3.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="congestion-control">
<section id="section-3.6">
        <h3 id="name-congestion-control">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-congestion-control" class="section-name selfRef">Congestion Control</a>
        </h3>
<p id="section-3.6-1">MOQT does not specify a congestion controller, but there are important attributes
to consider when selecting a congestion controller for use with an application
built on top of MOQT.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<div id="bufferbloat">
<section id="section-3.6.1">
          <h4 id="name-bufferbloat">
<a href="#section-3.6.1" class="section-number selfRef">3.6.1. </a><a href="#name-bufferbloat" class="section-name selfRef">Bufferbloat</a>
          </h4>
<p id="section-3.6.1-1">Traditional AIMD congestion controllers (ex. CUBIC <span>[<a href="#RFC9438" class="cite xref">RFC9438</a>]</span> and Reno <span>[<a href="#RFC6582" class="cite xref">RFC6582</a>]</span>)
are prone to Bufferbloat. Bufferbloat occurs when elements along the path build up
a substantial queue of packets, commonly more than doubling the round trip time.
These queued packets cause head-of-line blocking and latency, even when there is
no packet loss.<a href="#section-3.6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="application-limited">
<section id="section-3.6.2">
          <h4 id="name-application-limited">
<a href="#section-3.6.2" class="section-number selfRef">3.6.2. </a><a href="#name-application-limited" class="section-name selfRef">Application-Limited</a>
          </h4>
<p id="section-3.6.2-1">The average bitrate for latency sensitive content needs to be less than the available
bandwidth, otherwise data will be queued and/or dropped. As such,
many MOQT applications will typically be limited by the available data to send, and
not the congestion controller. Many congestion control algorithms
only increase the congestion window or bandwidth estimate if fully utilized. This
combination can lead to underestimating the available network bandwidth. As a result,
applications might need to periodically ensure the congestion controller is not
app-limited for at least a full round trip to ensure the available bandwidth can be
measured.<a href="#section-3.6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="consistent-throughput">
<section id="section-3.6.3">
          <h4 id="name-consistent-throughput">
<a href="#section-3.6.3" class="section-number selfRef">3.6.3. </a><a href="#name-consistent-throughput" class="section-name selfRef">Consistent Throughput</a>
          </h4>
<p id="section-3.6.3-1">Congestion control algorithms are commonly optimized for throughput, not consistency.
For example, BBR's PROBE_RTT state halves the sending rate for more than a round trip
in order to obtain an accurate minimum RTT. Similarly, Reno halves it's congestion
window upon detecting loss.  In both cases, the large reduction in sending rate might
cause issues with latency sensitive applications.<a href="#section-3.6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="publishing-and-retrieving-tracks">
<section id="section-4">
      <h2 id="name-publishing-and-retrieving-t">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-publishing-and-retrieving-t" class="section-name selfRef">Publishing and Retrieving Tracks</a>
      </h2>
<div id="subscriptions">
<section id="section-4.1">
        <h3 id="name-subscriptions">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-subscriptions" class="section-name selfRef">Subscriptions</a>
        </h3>
<p id="section-4.1-1">A subscription can be initiated by either a publisher or a subscriber.  A
publisher initiates a subscription to a track by sending the PUBLISH message.
The subscriber either accepts or rejects the subscription using PUBLISH_OK or
PUBLISH_ERROR.  A subscriber initiates a subscription to a track by sending the
SUBSCRIBE message.  The publisher either accepts or rejects the subscription
using SUBSCRIBE_OK or SUBSCRIBE_ERROR.  Once either of these sequences is
successful, the subscription can be updated by the subscriber using
SUBSCRIBE_UPDATE, terminated by the subscriber using UNSUBSCRIBE, or terminated
by the publisher using SUBSCRIBE_DONE.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">All subscriptions have a Forward State which is either 0 or 1.  If the Forward
State is 0, the publisher does not send objects for the subscription.  If the
Forward State is 1, the publisher sends objects.  The initiator of the
subscription sets the initial Forward State in either PUBLISH or SUBSCRIBE.  The
sender of PUBLISH_OK can update the Forward State based on its preference.  Once
the subscription is established, the subscriber can update the Forward State by
sending SUBSCRIBE_UPDATE.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">Either endpoint can initiate a subscription to a track without exchanging any
prior messages other than SETUP.  Relays <span class="bcp14">MUST NOT</span> send any PUBLISH messages
without knowing the client is interested in and authorized to receive the
content. The communication of intent and authorization can be accomplished by
the client sending SUBSCRIBE_NAMESPACE, or conveyed in other mechanisms out of
band.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">A publisher <span class="bcp14">MUST</span> send exactly one SUBSCRIBE_OK or SUBSCRIBE_ERROR in response to
a SUBSCRIBE. It <span class="bcp14">MUST</span> send exactly one FETCH_OK or FETCH_ERROR in response to a
FETCH. A subscriber <span class="bcp14">MUST</span> send exactly one PUBLISH_OK or PUBLISH_ERROR in
response to a PUBLISH. The peer <span class="bcp14">SHOULD</span> close the session with a protocol error
if it receives more than one.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">A subscriber keeps subscription state until it sends UNSUBSCRIBE, or after
receipt of a SUBSCRIBE_DONE or SUBSCRIBE_ERROR. Note that SUBSCRIBE_DONE does
not usually indicate that state can immediately be destroyed, see
<a href="#message-subscribe-done" class="auto internal xref">Section 8.12</a>.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">A subscriber keeps FETCH state until it sends FETCH_CANCEL, receives
FETCH_ERROR, or receives a FIN or RESET_STREAM for the FETCH data stream. If the
data stream is already open, it <span class="bcp14">MAY</span> send STOP_SENDING for the data stream along
with FETCH_CANCEL, but <span class="bcp14">MUST</span> send FETCH_CANCEL.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">The Publisher can destroy subscription or fetch state as soon as it has received
UNSUBSCRIBE or FETCH_CANCEL, respectively. It <span class="bcp14">MUST</span> reset any open streams
associated with the SUBSCRIBE or FETCH. It can also destroy state after closing
the FETCH data stream.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">The publisher can immediately delete subscription state after sending
SUBSCRIBE_DONE, but <span class="bcp14">MUST NOT</span> send it until it has closed all related streams. It
can destroy all FETCH state after closing the data stream.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1-9">A SUBSCRIBE_ERROR indicates no objects will be delivered, and both endpoints can
immediately destroy relevant state. Objects <span class="bcp14">MUST NOT</span> be sent for requests that
end with an error.<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1-10">A FETCH_ERROR indicates that both endpoints can immediately destroy state.
Since a relay can start delivering FETCH Objects from cache before determining
the result of the request, some Objects could be received even if the FETCH
results in error.<a href="#section-4.1-10" class="pilcrow">¶</a></p>
<p id="section-4.1-11">The Parameters in SUBSCRIBE, PUBLISH_OK and FETCH <span class="bcp14">MUST NOT</span> cause the publisher
to alter the payload of the objects it sends, as that would violate the track
uniqueness guarantee described in <a href="#track-scope" class="auto internal xref">Section 2.5.1</a>.<a href="#section-4.1-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="track-discovery">
<section id="section-5">
      <h2 id="name-namespace-discovery">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-namespace-discovery" class="section-name selfRef">Namespace Discovery</a>
      </h2>
<p id="section-5-1">Discovery of MOQT servers is always done out-of-band. Namespace discovery can be
done in the context of an established MOQT session.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">Given sufficient out of band information, it is valid for a subscriber to send a
SUBSCRIBE or FETCH message to a publisher (including a relay) without any
previous MoQT messages besides SETUP. However, SUBSCRIBE_NAMESPACE, PUBLISH and
ANNOUNCE messages provide an in-band means of discovery of publishers for a
namespace.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">The syntax of these messages is described in <a href="#message" class="auto internal xref">Section 8</a>.<a href="#section-5-3" class="pilcrow">¶</a></p>
<div id="subscribing-to-namespaces">
<section id="section-5.1">
        <h3 id="name-subscribing-to-namespaces">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-subscribing-to-namespaces" class="section-name selfRef">Subscribing to Namespaces</a>
        </h3>
<p id="section-5.1-1">If the subscriber is aware of a namespace of interest, it can send
SUBSCRIBE_NAMESPACE to publishers/relays it has established a session with. The
recipient of this message will send any relevant ANNOUNCE, UNANNOUNCE or PUBLISH
messages for that namespace, or more specific part of that namespace.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">A publisher <span class="bcp14">MUST</span> send exactly one SUBSCRIBE_NAMESPACE_OK or
SUBSCRIBE_NAMESPACE_ERROR in response to a SUBSCRIBE_NAMESPACE. The subscriber
<span class="bcp14">SHOULD</span> close the session with a protocol error if it detects receiving more than
one.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">The receiver of a SUBSCRIBE_NAMESPACE_OK or SUBSCRIBE_NAMESPACE_ERROR ought to
forward the result to the application, so the application can decide which other
publishers to contact, if any.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">An UNSUBSCRIBE_NAMESPACE withdraws a previous SUBSCRIBE_NAMESPACE. It does not
prohibit original publishers from sending further ANNOUNCE or PUBLISH messages,
but relays <span class="bcp14">MUST NOT</span> send any further PUBLISH messages to a client without
knowing the client is interested in and authorized to receive the content.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="announcements">
<section id="section-5.2">
        <h3 id="name-announcements">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-announcements" class="section-name selfRef">Announcements</a>
        </h3>
<p id="section-5.2-1">A publisher <span class="bcp14">MAY</span> send ANNOUNCE messages to any subscriber. An ANNOUNCE indicates
to the subscriber that the publisher has tracks available in that namespace. A
subscriber <span class="bcp14">MAY</span> send SUBSCRIBE or FETCH for tracks in a namespace without having
received an ANNOUNCE for it.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">If a publisher is authoritative for a given namespace, or is a relay that has
received an authorized ANNOUNCE for that namespace from an upstream publisher,
it <span class="bcp14">MUST</span> send an ANNOUNCE to any subscriber that has subscribed to ANNOUNCE for
that namespace, or a more generic set including that namespace. A publisher <span class="bcp14">MAY</span>
send the ANNOUNCE to any other subscriber.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">An endpoint <span class="bcp14">SHOULD NOT</span>, however, send an ANNOUNCE advertising a namespace that
exactly matches a namespace for which the peer sent an earlier ANNOUNCE
(i.e. an ANNOUNCE ought not to be echoed back to its sender).<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">The receiver of an ANNOUNCE_OK or ANNOUNCE_ERROR <span class="bcp14">SHOULD</span> report this to the
application to inform the search for additional subscribers for a namespace,
or abandoning the attempt to publish under this namespace. This might be
especially useful in upload or chat applications. A subscriber <span class="bcp14">MUST</span> send exactly
one ANNOUNCE_OK or ANNOUNCE_ERROR in response to an ANNOUNCE. The publisher
<span class="bcp14">SHOULD</span> close the session with a protocol error if it receives more than one.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">An UNANNOUNCE message withdraws a previous ANNOUNCE, although it is not a
protocol error for the subscriber to send a SUBSCRIBE or FETCH message for a
track in a namespace after receiving an UNANNOUNCE.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2-6">A subscriber can send ANNOUNCE_CANCEL to revoke acceptance of an ANNOUNCE, for
example due to expiration of authorization credentials. The message enables the
publisher to ANNOUNCE again with refreshed authorization, or discard associated
state. After receiving an ANNOUNCE_CANCEL, the publisher does not send
UNANNOUNCE.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2-7">While ANNOUNCE indicates to relays how to connect publishers and subscribers, it
is not a full-fledged routing protocol and does not protect against loops and
other phenomena. In particular, ANNOUNCE <span class="bcp14">SHOULD NOT</span> be used to find paths
through richly connected networks of relays.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<p id="section-5.2-8">A subscriber <span class="bcp14">MAY</span> send a SUBSCRIBE or FETCH for a track to any publisher. If it
has accepted an ANNOUNCE with a namespace that exactly matches the namespace for
that track, it <span class="bcp14">SHOULD</span> only request it from the senders of those ANNOUNCE
messages.<a href="#section-5.2-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="priorities">
<section id="section-6">
      <h2 id="name-priorities">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-priorities" class="section-name selfRef">Priorities</a>
      </h2>
<p id="section-6-1">MoQ priorities allow a subscriber and original publisher to influence
the transmission order of Objects within a session in the presence of
congestion.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="definitions">
<section id="section-6.1">
        <h3 id="name-definitions">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
        </h3>
<p id="section-6.1-1">MOQT maintains priorities between different <em>schedulable objects</em>.
A schedulable object in MOQT is either:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1-2">
<li id="section-6.1-2.1">
            <p id="section-6.1-2.1.1">The first or next Object in a Subgroup that is in response to a subscription.<a href="#section-6.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.1-2.2">
            <p id="section-6.1-2.2.1">An Object in response to a subscription that belongs to a Track with
delivery preference Datagram.<a href="#section-6.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.1-2.3">
            <p id="section-6.1-2.3.1">An Object in response to a FETCH where that Object is the next
Object in the response.<a href="#section-6.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-6.1-3">An Object is not schedulable if it is known that no part of it can be written
due to underlying transport flow control limits.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">A single subgroup or datagram has a single publisher priority. Within a
response to SUBSCRIBE, it can be useful to conceptualize this process as
scheduling subgroups or datagrams instead of individual objects on them.
FETCH responses however can contain objects with different publisher
priorities.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">A <em>priority number</em> is an unsigned integer with a value between 0 and 255.
A lower priority number indicates higher priority; the highest priority is 0.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6"><em>Subscriber Priority</em> is a priority number associated with an individual
request.  It is specified in the SUBSCRIBE or FETCH message, and can be
updated via SUBSCRIBE_UPDATE message.  The subscriber priority of an individual
schedulable object is the subscriber priority of the request that caused that
object to be sent. When subscriber priority is changed, a best effort <span class="bcp14">SHOULD</span> be
made to apply the change to all objects that have not been sent, but it is
implementation dependent what happens to objects that have already been
received and possibly scheduled.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1-7"><em>Publisher Priority</em> is a priority number associated with an individual
schedulable object.  It is specified in the header of the respective subgroup or
datagram, or in each object in a FETCH response.<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<p id="section-6.1-8"><em>Group Order</em> is a property of an individual subscription.  It can be either
'Ascending' (groups with lower group ID are sent first), or 'Descending'
(groups with higher group ID are sent first).  The subscriber optionally
communicates its group order preference in the SUBSCRIBE message; the
publisher's preference is used if the subscriber did not express one (by
setting Group Order field to value 0x0).  The group order of an existing
subscription cannot be changed.<a href="#section-6.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scheduling-algorithm">
<section id="section-6.2">
        <h3 id="name-scheduling-algorithm">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-scheduling-algorithm" class="section-name selfRef">Scheduling Algorithm</a>
        </h3>
<p id="section-6.2-1">When an MOQT publisher has multiple schedulable objects it can choose between,
the objects <span class="bcp14">SHOULD</span> be selected as follows:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-2">
<li id="section-6.2-2.1">
            <p id="section-6.2-2.1.1">If two objects have different subscriber priorities associated with them,
the one with <strong>the highest subscriber priority</strong> is sent first.<a href="#section-6.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-2.2">
            <p id="section-6.2-2.2.1">If two objects have the same subscriber priority, but different publisher
priorities, the one with <strong>the highest publisher priority</strong> is sent first.<a href="#section-6.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-2.3">
            <p id="section-6.2-2.3.1">If two objects in response to the same request have the same subscriber
and publisher priority, but belong to two different groups of the same track,
<strong>the group order</strong> of the associated subscription is used to
decide the one that is sent first.<a href="#section-6.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-2.4">
            <p id="section-6.2-2.4.1">If two objects in response to the same request belong to the same group of
the same track, the one with <strong>the lowest Subgroup ID</strong> (for tracks
with delivery preference Subgroup), or <strong>the lowest Object ID</strong> (for tracks
with delivery preference Datagram) is sent first.<a href="#section-6.2-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-6.2-3">The definition of "sent first" in the algorithm is implementation dependent and
is constrained by the prioritization interface of the underlying transport.
For some implementations, it could mean that the object is serialized and
passed to the underlying transport first.  In other implementations, it can
control the order packets are initially transmitted.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">This algorithm does not provide a well-defined ordering for objects that belong
to different subscriptions or FETCH responses, but have the same subscriber and
publisher priority.  The ordering in those cases is implementation-defined,
though the expectation is that all subscriptions will be able to send some data.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">Given the critical nature of control messages and their relatively
small size, the control stream <span class="bcp14">SHOULD</span> be prioritized higher than all
subscribed Objects.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="considerations-for-setting-priorities">
<section id="section-6.3">
        <h3 id="name-considerations-for-setting-">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-considerations-for-setting-" class="section-name selfRef">Considerations for Setting Priorities</a>
        </h3>
<p id="section-6.3-1">For downstream subscriptions, relays <span class="bcp14">SHOULD</span> respect the subscriber and original
publisher's priorities.  Relays can receive subscriptions with conflicting
subscriber priorities or Group Order preferences.  Relays <span class="bcp14">SHOULD NOT</span> directly
use Subscriber Priority or Group Order from incoming subscriptions for upstream
subscriptions. Relays' use of these fields for upstream subscriptions can be
based on factors specific to it, such as the popularity of the content or
policy, or relays can specify the same value for all upstream subscriptions.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">MoQ Sessions can span multiple namespaces, and priorities might not
be coordinated across namespaces.  The subscriber's priority is
considered first, so there is a mechanism for a subscriber to fix
incompatibilities between different namespaces prioritization schemes.
Additionally, it is anticipated that when multiple namespaces
are present within a session, the namespaces could be coordinating,
possibly part of the same application.  In cases when pooling among
namespaces is expected to cause issues, multiple MoQ sessions, either
within a single connection or on multiple connections can be used.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">Implementations that have a default priority <span class="bcp14">SHOULD</span> set it to a value in
the middle of the range (eg: 128) to allow non-default priorities to be
set either higher or lower.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="relays-moq">
<section id="section-7">
      <h2 id="name-relays-2">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-relays-2" class="section-name selfRef">Relays</a>
      </h2>
<p id="section-7-1">Relays are leveraged to enable distribution scale in the MoQ
architecture. Relays can be used to form an overlay delivery network,
similar in functionality to Content Delivery Networks
(CDNs). Additionally, relays serve as policy enforcement points by
validating subscribe and publish requests at the edge of a network.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Relays are endpoints, which means they terminate Transport Sessions in order to
have visibility of MoQ Object metadata.<a href="#section-7-2" class="pilcrow">¶</a></p>
<div id="caching-relays">
<section id="section-7.1">
        <h3 id="name-caching-relays">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-caching-relays" class="section-name selfRef">Caching Relays</a>
        </h3>
<p id="section-7.1-1">Relays <span class="bcp14">MAY</span> cache Objects, but are not required to.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">A caching relay saves Objects to its cache identified by the Object's Full Track
Name, Group ID and Object ID. If multiple objects are received with the same
Full Track Name, Group ID and Object ID, Relays <span class="bcp14">MAY</span> ignore subsequently received
Objects or <span class="bcp14">MAY</span> use them to update certain cached fields. Implementations that
update the cache need to protect against cache poisoning.  The only Object
fields that can be updated are the following:<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.1-3">
<li id="section-7.1-3.1">
            <p id="section-7.1-3.1.1">Object Status can transition from any status to Object Does Not Exist in
cases where the object is no longer available.  Transitions between Normal,
End of Group and End of Track are invalid.<a href="#section-7.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-3.2">
            <p id="section-7.1-3.2.1">Object Header Extensions can be added, removed or updated, subject
to the constraints of the specific header extension.<a href="#section-7.1-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-7.1-4">An endpoint that receives a duplicate Object with an invalid Object Status
change, or a Forwarding Preference, Subgroup ID, Priority or Payload that
differ from a previous version <span class="bcp14">MUST</span> treat the track as Malformed.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1-5">Note that due to reordering, an implementation can receive a duplicate Object
with a status of Normal, End of Group or End of Track after receiving a
previous status of Object Not Exists.  The endpoint <span class="bcp14">SHOULD NOT</span> cache or
forward the duplicate object in this case.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">A cache <span class="bcp14">MUST</span> store all properties of an Object defined in
<a href="#object-properties" class="auto internal xref">Section 9.2.1</a>, with the exception of any extensions
(<a href="#object-extensions" class="auto internal xref">Section 9.2.1.2</a>) that specify otherwise.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subscriber-interactions">
<section id="section-7.2">
        <h3 id="name-subscriber-interactions">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-subscriber-interactions" class="section-name selfRef">Subscriber Interactions</a>
        </h3>
<p id="section-7.2-1">Subscribers subscribe to tracks by sending a SUBSCRIBE
(<a href="#message-subscribe-req" class="auto internal xref">Section 8.7</a>) control message for each track of
interest. Relays <span class="bcp14">MUST</span> ensure subscribers are authorized to access the
content associated with the track. The authorization
information can be part of subscription request itself or part of the
encompassing session. The specifics of how a relay authorizes a user are outside
the scope of this specification.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">The relay <span class="bcp14">MUST</span> have an established upstream subscription before sending
SUBSCRIBE_OK in response to a downstream SUBSCRIBE.  If a relay does not have
sufficient information to send a FETCH_OK immediately in response to a FETCH, it
<span class="bcp14">MUST</span> withhold sending FETCH_OK until it does.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">For successful subscriptions, the publisher maintains a list of
subscribers for each track. Each new Object belonging to the
track within the subscription range is forwarded to each active
subscriber, dependent on the congestion response.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">Relays <span class="bcp14">MUST</span> be able to process objects for the same Full Track Name from
multiple publishers and forward objects to active matching subscriptions.  The
same object <span class="bcp14">SHOULD NOT</span> be forwarded more than once on the same subscription.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<p id="section-7.2-5">A relay <span class="bcp14">MUST NOT</span> reorder or drop objects received on a multi-object stream when
forwarding to subscribers, unless it has application specific information.<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<p id="section-7.2-6">Relays <span class="bcp14">MAY</span> aggregate authorized subscriptions for a given track when
multiple subscribers request the same track. Subscription aggregation
allows relays to make only a single upstream subscription for the
track. The published content received from the upstream subscription
request is cached and shared among the pending subscribers.
Because SUBSCRIBE_UPDATE only allows narrowing a subscription, relays that
aggregate upstream subscriptions can subscribe using the Largest Object
filter to avoid churn as downstream subscribers with disparate filters
subscribe and unsubscribe from a track.<a href="#section-7.2-6" class="pilcrow">¶</a></p>
<div id="graceful-subscriber-relay-switchover">
<section id="section-7.2.1">
          <h4 id="name-graceful-subscriber-relay-s">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-graceful-subscriber-relay-s" class="section-name selfRef">Graceful Subscriber Relay Switchover</a>
          </h4>
<p id="section-7.2.1-1">This section describes behavior a subscriber <span class="bcp14">MAY</span> implement
to allow for a better user experience when a relay sends a GOAWAY.<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.2.1-2">When a subscriber receives the GOAWAY message, it starts the process
of connecting to a new relay and sending the SUBSCRIBE requests for
all active subscriptions to the new relay. The new relay will send a
response to the subscribes and if they are successful, the subscriptions
to the old relay can be stopped with an UNSUBSCRIBE.<a href="#section-7.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="publisher-interactions">
<section id="section-7.3">
        <h3 id="name-publisher-interactions">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-publisher-interactions" class="section-name selfRef">Publisher Interactions</a>
        </h3>
<p id="section-7.3-1">There are two ways to publish through a relay:<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.3-2">
<li id="section-7.3-2.1">
            <p id="section-7.3-2.1.1">Send a PUBLISH message for a specific Track to the relay. The relay <span class="bcp14">MAY</span>
respond with PUBLISH_OK in Forward State=0 until there are known subscribers for
new tracks.<a href="#section-7.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.3-2.2">
            <p id="section-7.3-2.2.1">Send an ANNOUNCE message for a Track Namespace to the relay. This enables the
relay to send SUBSCRIBE messages to publishers for Tracks in this Namespace in
response to received SUBSCRIBE messages.<a href="#section-7.3-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-7.3-3">Relays <span class="bcp14">MUST</span> verify that publishers are authorized to publish the set of tracks
whose Track Namespace matches the namespace in
an ANNOUNCE, or the Full Track Name in PUBLISH. The authorization and
identification of the publisher depends on the way the relay is managed
and is application specific.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">A Relay can receive announcements for the same Track Namespace or PUBLISH
messages for the same Track from multiple publishers and is expected to treat
them uniformly.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<p id="section-7.3-5">When a publisher wants to stop new subscriptions for an announced namespace it
sends an UNANNOUNCE. A subscriber indicates it will no longer subcribe to tracks
in a namespace it previously responded ANNOUNCE_OK to by sending an
ANNOUNCE_CANCEL.<a href="#section-7.3-5" class="pilcrow">¶</a></p>
<p id="section-7.3-6">A relay manages sessions from multiple publishers and subscribers, connecting
them based on the Track Namespace or Full Track Name.  Prefix matching is used
to determine which publishers receive a SUBSCRIBE or which subscribers receive a
PUBLISH. For example, a SUBSCRIBE namespace=(foo,bar), track=x message will be
forwarded to the sessions that sent ANNOUNCE namespace=(foo) and ANNOUNCE
namespace=(foo, bar) respectively, but not one that sent ANNOUNCE
namespace=(foobar).  Relays <span class="bcp14">MUST</span> forward SUBSCRIBE messages to all publishers
and ANNOUNCE and PUBLISH messages to all subscribers that have a namespace
prefix match.<a href="#section-7.3-6" class="pilcrow">¶</a></p>
<p id="section-7.3-7">When a relay receives an incoming SUBSCRIBE that triggers an upstream
subscription, it <span class="bcp14">SHOULD</span> send a SUBSCRIBE request to each publisher that has
announced the subscription's namespace or prefix thereof, unless it already has
an active subscription for the Objects requested by the incoming SUBSCRIBE
request from all available publishers.  If it already has a matching upstream
subscription in Forward State=0, it <span class="bcp14">SHOULD</span> send a SUBSCRIBE_UDPATE with
Forward=1 to all publishers.<a href="#section-7.3-7" class="pilcrow">¶</a></p>
<p id="section-7.3-8">When a relay receives an incoming PUBLISH message, it <span class="bcp14">MUST</span> send a PUBLISH
request to each subscriber that has subscribed (via SUBSCRIBE_NAMESPACE)
to the track's namespace or prefix thereof.<a href="#section-7.3-8" class="pilcrow">¶</a></p>
<p id="section-7.3-9">When a relay receives an incoming ANNOUNCE for a given namespace, for
each active upstream subscription that matches that namespace, it <span class="bcp14">SHOULD</span> send a
SUBSCRIBE to the publisher that sent the ANNOUNCE.  When it receives an incoming
PUBLISH message for a track that has active subscribers, it <span class="bcp14">SHOULD</span> respond
with PUBLISH_OK with Forward State=1.<a href="#section-7.3-9" class="pilcrow">¶</a></p>
<p id="section-7.3-10">Relays use the Track Alias (<a href="#track-alias" class="auto internal xref">Section 9.1</a>) of an incoming Object to identify
its track and find the active subscribers. Relays <span class="bcp14">MUST</span> forward Objects to
matching subscribers in accordance to each subscription's priority, group order,
and delivery timeout.<a href="#section-7.3-10" class="pilcrow">¶</a></p>
<p id="section-7.3-11">If an upstream session is closed due to an unknown or invalid control message
or Object, the relay <span class="bcp14">MUST NOT</span> continue to propagate that message or Object
downstream, because it would enable a single session to close unrelated
sessions.<a href="#section-7.3-11" class="pilcrow">¶</a></p>
<div id="graceful-publisher-network-switchover">
<section id="section-7.3.1">
          <h4 id="name-graceful-publisher-network-">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-graceful-publisher-network-" class="section-name selfRef">Graceful Publisher Network Switchover</a>
          </h4>
<p id="section-7.3.1-1">This section describes a behavior that a publisher <span class="bcp14">MAY</span>
choose to implement to allow for a better user experience when
switching between networks, such as WiFi to Cellular or vice versa.<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
<p id="section-7.3.1-2">If the original publisher detects it is likely to need to switch networks, for
example because the WiFi signal is getting weaker, and it does not have QUIC
connection migration available, it establishes a new session over the new
interface and sends ANNOUNCE and/or PUBLISH messages. The relay will establish
subscriptions and the publisher publishes objects on both sessions.  Once the
subscriptions have migrated over to session on the new network, the publisher
can stop publishing objects on the old network. The relay will drop duplicate
objects received on both subscriptions.  Ideally, the subscriptions downstream
from the relay do no observe this change, and keep receiving the objects on the
same subscription.<a href="#section-7.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="graceful-publisher-relay-switchover">
<section id="section-7.3.2">
          <h4 id="name-graceful-publisher-relay-sw">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-graceful-publisher-relay-sw" class="section-name selfRef">Graceful Publisher Relay Switchover</a>
          </h4>
<p id="section-7.3.2-1">This section describes a behavior that a publisher <span class="bcp14">MAY</span> choose to implement
to allow for a better user experience when a relay sends them a GOAWAY.<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
<p id="section-7.3.2-2">When a publisher receives a GOAWAY, it starts the process of connecting to a new
relay and sends ANNOUNCE and/or PUBLISH messages, but it does not immediately
stop publishing objects to the old relay. The new relay will establish
subscriptions and the publisher can start sending new objects to the new relay
instead of the old relay. Once objects are going to the new relay, the
announcements and subscriptions to the old relay can be withdrawn or terminated.<a href="#section-7.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="relay-object-handling">
<section id="section-7.4">
        <h3 id="name-relay-object-handling">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-relay-object-handling" class="section-name selfRef">Relay Object Handling</a>
        </h3>
<p id="section-7.4-1">MOQT encodes the delivery information via Object headers
(<a href="#message-object" class="auto internal xref">Section 9.2</a>).  A relay <span class="bcp14">MUST NOT</span> modify Object properties when
forwarding, except for Object Extension Headers as specified in
<a href="#object-extensions" class="auto internal xref">Section 9.2.1.2</a>.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">A relay <span class="bcp14">MUST</span> treat the object payload as opaque.  A relay <span class="bcp14">MUST NOT</span>
combine, split, or otherwise modify object payloads.  A relay <span class="bcp14">SHOULD</span>
prioritize sending Objects based on <a href="#priorities" class="auto internal xref">Section 6</a>.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<p id="section-7.4-3">A publisher <span class="bcp14">SHOULD</span> begin sending incomplete objects when available to
avoid incurring additional latency.<a href="#section-7.4-3" class="pilcrow">¶</a></p>
<p id="section-7.4-4">A relay that reads from one stream and writes to another in order can
introduce head-of-line blocking.  Packet loss will cause stream data to
be buffered in the library, awaiting in-order delivery, which could
increase latency over additional hops.  To mitigate this, a relay <span class="bcp14">MAY</span>
read and write stream data out of order subject to flow control
limits.  See section 2.2 in <span>[<a href="#QUIC" class="cite xref">QUIC</a>]</span>.<a href="#section-7.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="message">
<section id="section-8">
      <h2 id="name-control-messages">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-control-messages" class="section-name selfRef">Control Messages</a>
      </h2>
<p id="section-8-1">MOQT uses a single bidirectional stream to exchange control messages, as
defined in <a href="#session-init" class="auto internal xref">Section 3.3</a>.  Every single message on the control stream is
formatted as follows:<a href="#section-8-1" class="pilcrow">¶</a></p>
<span id="name-moqt-message"></span><div id="moq-transport-message-format">
<figure id="figure-3">
        <div class="alignLeft art-text artwork" id="section-8-2.1">
<pre>
MOQT Control Message {
  Message Type (i),
  Message Length (16),
  Message Payload (..),
}
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-moqt-message" class="selfRef">MOQT Message</a>
        </figcaption></figure>
</div>
<p id="section-8-3">The following Message Types are defined:<a href="#section-8-3" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
        <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
          <tr>
            <th class="text-right" rowspan="1" colspan="1">ID</th>
            <th class="text-left" rowspan="1" colspan="1">Messages</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x01</td>
            <td class="text-left" rowspan="1" colspan="1">RESERVED (SETUP for version 00)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x40</td>
            <td class="text-left" rowspan="1" colspan="1">RESERVED (CLIENT_SETUP for versions &lt;= 10)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x41</td>
            <td class="text-left" rowspan="1" colspan="1">RESERVED (SERVER_SETUP for versions &lt;= 10)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x20</td>
            <td class="text-left" rowspan="1" colspan="1">CLIENT_SETUP (<a href="#message-setup" class="auto internal xref">Section 8.3</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x21</td>
            <td class="text-left" rowspan="1" colspan="1">SERVER_SETUP (<a href="#message-setup" class="auto internal xref">Section 8.3</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x10</td>
            <td class="text-left" rowspan="1" colspan="1">GOAWAY (<a href="#message-goaway" class="auto internal xref">Section 8.4</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x15</td>
            <td class="text-left" rowspan="1" colspan="1">MAX_REQUEST_ID (<a href="#message-max-request-id" class="auto internal xref">Section 8.5</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x1A</td>
            <td class="text-left" rowspan="1" colspan="1">REQUESTS_BLOCKED (<a href="#message-requests-blocked" class="auto internal xref">Section 8.6</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x3</td>
            <td class="text-left" rowspan="1" colspan="1">SUBSCRIBE (<a href="#message-subscribe-req" class="auto internal xref">Section 8.7</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x4</td>
            <td class="text-left" rowspan="1" colspan="1">SUBSCRIBE_OK (<a href="#message-subscribe-ok" class="auto internal xref">Section 8.8</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x5</td>
            <td class="text-left" rowspan="1" colspan="1">SUBSCRIBE_ERROR (<a href="#message-subscribe-error" class="auto internal xref">Section 8.9</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x2</td>
            <td class="text-left" rowspan="1" colspan="1">SUBSCRIBE_UPDATE (<a href="#message-subscribe-update" class="auto internal xref">Section 8.10</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0xA</td>
            <td class="text-left" rowspan="1" colspan="1">UNSUBSCRIBE (<a href="#message-unsubscribe" class="auto internal xref">Section 8.11</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0xB</td>
            <td class="text-left" rowspan="1" colspan="1">SUBSCRIBE_DONE (<a href="#message-subscribe-done" class="auto internal xref">Section 8.12</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x1D</td>
            <td class="text-left" rowspan="1" colspan="1">PUBLISH  (<a href="#message-publish" class="auto internal xref">Section 8.13</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x1E</td>
            <td class="text-left" rowspan="1" colspan="1">PUBLISH_OK (<a href="#message-publish-ok" class="auto internal xref">Section 8.14</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x1F</td>
            <td class="text-left" rowspan="1" colspan="1">PUBLISH_ERROR (<a href="#message-publish-error" class="auto internal xref">Section 8.15</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x16</td>
            <td class="text-left" rowspan="1" colspan="1">FETCH (<a href="#message-fetch" class="auto internal xref">Section 8.16</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x18</td>
            <td class="text-left" rowspan="1" colspan="1">FETCH_OK (<a href="#message-fetch-ok" class="auto internal xref">Section 8.17</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x19</td>
            <td class="text-left" rowspan="1" colspan="1">FETCH_ERROR (<a href="#message-fetch-error" class="auto internal xref">Section 8.18</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x17</td>
            <td class="text-left" rowspan="1" colspan="1">FETCH_CANCEL (<a href="#message-fetch-cancel" class="auto internal xref">Section 8.19</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0xD</td>
            <td class="text-left" rowspan="1" colspan="1">TRACK_STATUS (<a href="#message-track-status" class="auto internal xref">Section 8.20</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0xE</td>
            <td class="text-left" rowspan="1" colspan="1">TRACK_STATUS_OK (<a href="#message-track-status-ok" class="auto internal xref">Section 8.21</a>
</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0xF</td>
            <td class="text-left" rowspan="1" colspan="1">TRACK_STATUS_ERROR (<a href="#message-track-status-error" class="auto internal xref">Section 8.22</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x6</td>
            <td class="text-left" rowspan="1" colspan="1">ANNOUNCE  (<a href="#message-announce" class="auto internal xref">Section 8.23</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x7</td>
            <td class="text-left" rowspan="1" colspan="1">ANNOUNCE_OK (<a href="#message-announce-ok" class="auto internal xref">Section 8.24</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x8</td>
            <td class="text-left" rowspan="1" colspan="1">ANNOUNCE_ERROR (<a href="#message-announce-error" class="auto internal xref">Section 8.25</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x9</td>
            <td class="text-left" rowspan="1" colspan="1">UNANNOUNCE  (<a href="#message-unannounce" class="auto internal xref">Section 8.26</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0xC</td>
            <td class="text-left" rowspan="1" colspan="1">ANNOUNCE_CANCEL (<a href="#message-announce-cancel" class="auto internal xref">Section 8.27</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x11</td>
            <td class="text-left" rowspan="1" colspan="1">SUBSCRIBE_NAMESPACE (<a href="#message-subscribe-ns" class="auto internal xref">Section 8.28</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x12</td>
            <td class="text-left" rowspan="1" colspan="1">SUBSCRIBE_NAMESPACE_OK (<a href="#message-sub-ns-ok" class="auto internal xref">Section 8.29</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x13</td>
            <td class="text-left" rowspan="1" colspan="1">SUBSCRIBE_NAMESPACE_ERROR (<a href="#message-sub-ns-error" class="auto internal xref">Section 8.30</a>
</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x14</td>
            <td class="text-left" rowspan="1" colspan="1">UNSUBSCRIBE_NAMESPACE (<a href="#message-unsub-ns" class="auto internal xref">Section 8.31</a>)</td>
          </tr>
        </tbody>
      </table>
<p id="section-8-5">An endpoint that receives an unknown message type <span class="bcp14">MUST</span> close the session.
Control messages have a length to make parsing easier, but no control messages
are intended to be ignored. The length is set to the number of bytes in Message
Payload, which is defined by each message type.  If the length does not match
the length of the Message Payload, the receiver <span class="bcp14">MUST</span> close the session with
Protocol Violation.<a href="#section-8-5" class="pilcrow">¶</a></p>
<div id="request-id">
<section id="section-8.1">
        <h3 id="name-request-id">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-request-id" class="section-name selfRef">Request ID</a>
        </h3>
<p id="section-8.1-1">Most MOQT control messages contain a session specific Request ID.  The Request
ID correlates requests and responses, allows endpoints to update or terminate
ongoing requests, and supports the endpoint's ability to limit the concurrency
and frequency of requests.  There are independent Request IDs for each endpoint.
The client's Request ID starts at 0 and are even and the server's Request ID
starts at 1 and are odd.  The Request ID increments by 2 with ANNOUNCE, FETCH,
SUBSCRIBE, SUBSCRIBE_NAMESPACE or TRACK_STATUS request.  If an endpoint receives
a Request ID that is not valid for the peer, or a new request with a Request ID
that is not expected, it <span class="bcp14">MUST</span> close the session with <code>Invalid Request ID</code>.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="params">
<section id="section-8.2">
        <h3 id="name-parameters">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-parameters" class="section-name selfRef">Parameters</a>
        </h3>
<p id="section-8.2-1">Some messages include a Parameters field that encodes optional message
elements.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">Senders <span class="bcp14">MUST NOT</span> repeat the same parameter type in a message unless the
parameter definition explicitly allows multiple instances of that type to
be sent in a single message. Receivers <span class="bcp14">SHOULD</span> check that there are no
unauthorized duplicate parameters and close the session as a
'Protocol Violation' if found.  Receivers <span class="bcp14">MUST</span> allow duplicates of unknown
parameters.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">Receivers ignore unrecognized parameters.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">The number of parameters in a message is not specifically limited, but the
total length of a control message is limited to 2^16-1 bytes.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2-5">Parameters are serialized as Key-Value-Pairs <a href="#moq-key-value-pair" class="auto internal xref">Figure 2</a>.<a href="#section-8.2-5" class="pilcrow">¶</a></p>
<p id="section-8.2-6">Setup message parameters use a namespace that is constant across all MoQ
Transport versions. All other messages use a version-specific namespace.
For example, the integer '1' can refer to different parameters for Setup
messages and for all other message types. SETUP message parameter types
are defined in <a href="#setup-params" class="auto internal xref">Section 8.3.2</a>. Version-specific parameter types are defined
in <a href="#version-specific-params" class="auto internal xref">Section 8.2.1</a>.<a href="#section-8.2-6" class="pilcrow">¶</a></p>
<div id="version-specific-params">
<section id="section-8.2.1">
          <h4 id="name-version-specific-parameters">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-version-specific-parameters" class="section-name selfRef">Version Specific Parameters</a>
          </h4>
<p id="section-8.2.1-1">Each version-specific parameter definition indicates the message types in which
it can appear. If it appears in some other type of message, it <span class="bcp14">MUST</span> be ignored.
Note that since Setup parameters use a separate namespace, it is impossible for
these parameters to appear in Setup messages.<a href="#section-8.2.1-1" class="pilcrow">¶</a></p>
<div id="authorization-token">
<section id="section-8.2.1.1">
            <h5 id="name-authorization-token">
<a href="#section-8.2.1.1" class="section-number selfRef">8.2.1.1. </a><a href="#name-authorization-token" class="section-name selfRef">AUTHORIZATION TOKEN</a>
            </h5>
<p id="section-8.2.1.1-1">The AUTHORIZATION TOKEN parameter (Parameter Type 0x03) <span class="bcp14">MAY</span> appear in a
CLIENT_SETUP, SERVER_SETUP, SUBSCRIBE, SUBSCRIBE_NAMESPACE, ANNOUNCE,
TRACK_STATUS or FETCH message. This parameter conveys information to authorize
the sender to perform the operation carrying the parameter.<a href="#section-8.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-8.2.1.1-2">The AUTHORIZATION TOKEN parameter <span class="bcp14">MAY</span> be repeated within a message.<a href="#section-8.2.1.1-2" class="pilcrow">¶</a></p>
<p id="section-8.2.1.1-3">The parameter value is a Token structure containing an optional Session-specific
Alias. The Alias allows the sender to reference a previously transmitted Token
Type and Token Value in future messages. The Token structure is serialized as
follows:<a href="#section-8.2.1.1-3" class="pilcrow">¶</a></p>
<span id="name-token-structure"></span><div id="moq-token">
<figure id="figure-4">
              <div class="alignLeft art-text artwork" id="section-8.2.1.1-4.1">
<pre>
Token {
  Alias Type (i),
  [Token Alias (i),]
  [Token Type (i),]
  [Token Value (..)]
}
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-token-structure" class="selfRef">Token structure</a>
              </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.2.1.1-5.1">
                <p id="section-8.2.1.1-5.1.1">Alias Type - an integer defining both the serialization and the processing
behavior of the receiver. This Alias type has the following code points:<a href="#section-8.2.1.1-5.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<table class="center" id="table-3">
              <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
                <tr>
                  <th class="text-right" rowspan="1" colspan="1">Code</th>
                  <th class="text-left" rowspan="1" colspan="1">Name</th>
                  <th class="text-left" rowspan="1" colspan="1">Serialization and behavior</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">0x0</td>
                  <td class="text-left" rowspan="1" colspan="1">DELETE</td>
                  <td class="text-left" rowspan="1" colspan="1">There is an Alias but no Type or Value. This Alias</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1">and the Token Value it was previously associated with</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be retired. Retiring removes them from the pool</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1">of actively registered tokens.</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">0x1</td>
                  <td class="text-left" rowspan="1" colspan="1">REGISTER</td>
                  <td class="text-left" rowspan="1" colspan="1">There is an Alias, a Type and a Value. This Alias</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be associated with the Token Value for the</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1">duration of the Session or it is deleted. This action</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1">is termed "registering" the Token.</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">0x2</td>
                  <td class="text-left" rowspan="1" colspan="1">USE_ALIAS</td>
                  <td class="text-left" rowspan="1" colspan="1">There is an Alias but no Type or Value. Use the Token</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1">Type and Value previously registered with this Alias.</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">0x3</td>
                  <td class="text-left" rowspan="1" colspan="1">USE_VALUE</td>
                  <td class="text-left" rowspan="1" colspan="1">There is no Alias and there is a Type and Value. Use</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1">the Token Value as provided. The Token Value may be</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1">discarded after processing.</td>
                </tr>
              </tbody>
            </table>
<ul class="normal">
<li class="normal" id="section-8.2.1.1-7.1">
                <p id="section-8.2.1.1-7.1.1">Token Alias - a Session-specific integer identifier that references a Token
Value. There are separate Alias spaces for the client and server (e.g.: they
can each register Alias=1). Once a Token Alias has been registered, it cannot
be re-registered by the same sender in the Session without first being
deleted. Use of the Token Alias is optional.<a href="#section-8.2.1.1-7.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2.1.1-7.2">
                <p id="section-8.2.1.1-7.2.1">Token Type - a numeric identifier for the type of Token payload being
transmitted. This type is defined by the IANA table "MOQT Auth Token Type" (see
<a href="#iana" class="auto internal xref">Section 12</a>). Type 0 is reserved to indicate that the type is not defined in the
table and is negotiated out-of-band between client and receiver.<a href="#section-8.2.1.1-7.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.2.1.1-7.3">
                <p id="section-8.2.1.1-7.3.1">Token Value - the payload of the Token. The contents and serialization of this
payload are defined by the Token Type.<a href="#section-8.2.1.1-7.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-8.2.1.1-8">If the Token structure cannot be decoded, the receiver <span class="bcp14">MUST</span> close the Session
with Key-Value Formatting error.  The receiver of a message attempting to
register an Alias which is already registered <span class="bcp14">MUST</span> close the Session with
<code>Duplicate Auth Token Alias</code>. The receiver of a message referencing an Alias
that is not currently registered <span class="bcp14">MUST</span> reject the message with <code>Unknown Auth
Token Alias</code>.<a href="#section-8.2.1.1-8" class="pilcrow">¶</a></p>
<p id="section-8.2.1.1-9">The receiver of a message containing a well-formed Token structure but otherwise
invalid AUTHORIZATION TOKEN parameter <span class="bcp14">MUST</span> reject that message with an
<code>Malformed Auth Token</code> error.<a href="#section-8.2.1.1-9" class="pilcrow">¶</a></p>
<p id="section-8.2.1.1-10">The receiver of a message carrying an AUTHORIZATION TOKEN with Alias Type
REGISTER that does not result in a Session error <span class="bcp14">MUST</span> register the Token Alias,
in the token cache, even if the message fails for other reasons, including
<code>Unauthorized</code>.  This allows senders to pipeline messages that refer to
previously registered tokens without potentially terminating the entire Session.
A receiver <span class="bcp14">MAY</span> store an error code (eg: Unauthorized or Malformed Auth Token) in
place of the Token Type and Token Alias if any future message referencing the
Token Alias will result in that error. The size of a registered cache entry
includes the length of the Token Value, regardless of whether it is stored.<a href="#section-8.2.1.1-10" class="pilcrow">¶</a></p>
<p id="section-8.2.1.1-11">If a receiver detects that an authorization token has expired, it <span class="bcp14">MUST</span> retain
the registered Alias until it is deleted by the sender, though it <span class="bcp14">MAY</span> discard
other state associated with the token that is no longer needed.  Expiration does
not affect the size occupied by a token in the token cache.  Any message that
references the token with Alias Type USE_ALIAS fails with <code>Expired Auth Token</code>.<a href="#section-8.2.1.1-11" class="pilcrow">¶</a></p>
<p id="section-8.2.1.1-12">Using an Alias to refer to a previously registered Token Type and Value is for
efficiency only and has the same effect as if the Token Type and Value was
included directly.  Retiring an Alias that was previously used to authorize a
message has no retroactive effect on the original authorization, nor does it
prevent that same Token Type and Value from being re-registered.<a href="#section-8.2.1.1-12" class="pilcrow">¶</a></p>
<p id="section-8.2.1.1-13">Senders of tokens <span class="bcp14">SHOULD</span> only register tokens which they intend to re-use during
the Session and <span class="bcp14">SHOULD</span> retire previously registered tokens once their utility
has passed.<a href="#section-8.2.1.1-13" class="pilcrow">¶</a></p>
<p id="section-8.2.1.1-14">By registering a Token, the sender is requiring the receiver to store the Token
Alias and Token Value until they are deleted, or the Session ends. The receiver
can protect its resources by sending a SETUP parameter defining the
MAX_AUTH_TOKEN_CACHE_SIZE limit (see <a href="#max-auth-token-cache-size" class="auto internal xref">Section 8.3.2.4</a>) it is
willing to accept. If a registration is attempted which would cause this limit
to be exceeded, the receiver <span class="bcp14">MUST</span> termiate the Session with a <code>Auth Token Cache
Overflow</code> error.<a href="#section-8.2.1.1-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="delivery-timeout">
<section id="section-8.2.1.2">
            <h5 id="name-delivery-timeout-parameter">
<a href="#section-8.2.1.2" class="section-number selfRef">8.2.1.2. </a><a href="#name-delivery-timeout-parameter" class="section-name selfRef">DELIVERY TIMEOUT Parameter</a>
            </h5>
<p id="section-8.2.1.2-1">The DELIVERY TIMEOUT parameter (Parameter Type 0x02) <span class="bcp14">MAY</span> appear in a
TRACK_STATUS, SUBSCRIBE, SUBSCRIBE_OK, or SUBSCRIBE_UDPATE message.
It is the duration in milliseconds the relay <span class="bcp14">SHOULD</span> continue to attempt
forwarding Objects after they have been received.  The start time for the
timeout is based on when the beginning of the Object is received, and does
not depend upon the forwarding preference. There is no explicit signal that
an Object was not sent because the delivery timeout was exceeded.<a href="#section-8.2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2.1.2-2">If both the subscriber and publisher specify the parameter, they use the min of
the two values for the subscription.  The publisher <span class="bcp14">SHOULD</span> always specify the
value received from an upstream subscription when there is one, and nothing
otherwise.  If an Object with a smaller ID arrives later than subsequent
Objects, relays can consider its receipt time as that of the Object with the
next larger Location, with the assumption that the Objects were reordered.<a href="#section-8.2.1.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2.1.2-3">Publishers can, at their discretion, discontinue forwarding Objects earlier than
the negotiated DELIVERY TIMEOUT, subject to stream closure and ordering
constraints described in <a href="#closing-subgroup-streams" class="auto internal xref">Section 9.4.3</a>.  However, if neither the
subscriber or publisher specify DELIVERY TIMEOUT, all Objects in the track
matching the subscription filter are delivered as indicated by their Group Order
and Priority.  If a subscriber fails to consume Objects at a sufficient rate,
causing the publisher to exceed its resource limits, the publisher <span class="bcp14">MAY</span> terminate
the subscription with error 'Too Far Behind'.<a href="#section-8.2.1.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2.1.2-4">If an object in a subgroup exceeds the delivery timeout, the publisher <span class="bcp14">MUST</span>
reset the underlying transport stream (see <a href="#closing-subgroup-streams" class="auto internal xref">Section 9.4.3</a>).<a href="#section-8.2.1.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2.1.2-5">When sent by a subscriber, this parameter is intended to be specific to a
subscription, so it <span class="bcp14">SHOULD NOT</span> be forwarded upstream by a relay that intends
to serve multiple subscriptions for the same track.<a href="#section-8.2.1.2-5" class="pilcrow">¶</a></p>
<p id="section-8.2.1.2-6">Publishers <span class="bcp14">SHOULD</span> consider whether the entire Object is likely to be delivered
before sending any data for that Object, taking into account priorities,
congestion control, and any other relevant information.<a href="#section-8.2.1.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="max-cache-duration">
<section id="section-8.2.1.3">
            <h5 id="name-max-cache-duration-paramete">
<a href="#section-8.2.1.3" class="section-number selfRef">8.2.1.3. </a><a href="#name-max-cache-duration-paramete" class="section-name selfRef">MAX CACHE DURATION Parameter</a>
            </h5>
<p id="section-8.2.1.3-1">The MAX_CACHE_DURATION parameter (Parameter Type 0x04) <span class="bcp14">MAY</span> appear in a
SUBSCRIBE_OK, FETCH_OK or TRACK_STATUS message.  It is an integer expressing
the number of milliseconds an object can be served from a cache. If present,
the relay <span class="bcp14">MUST NOT</span> start forwarding any individual Object received through
this subscription or fetch after the specified number of milliseconds has
elapsed since the beginning of the Object was received.  This means Objects
earlier in a multi-object stream will expire earlier than Objects later in the
stream. Once Objects have expired from cache, their state becomes unknown, and
a relay that handles a downstream request that includes those Objects
re-requests them.<a href="#section-8.2.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="message-setup">
<section id="section-8.3">
        <h3 id="name-client_setup-and-server_set">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-client_setup-and-server_set" class="section-name selfRef">CLIENT_SETUP and SERVER_SETUP</a>
        </h3>
<p id="section-8.3-1">The <code>CLIENT_SETUP</code> and <code>SERVER_SETUP</code> messages are the first messages exchanged
by the client and the server; they allow the endpoints to establish the mutually
supported version and agree on the initial configuration before any objects are
exchanged. It is a sequence of key-value pairs called Setup parameters; the
semantics and format of which can vary based on whether the client or server is
sending.  To ensure future extensibility of MOQT, endpoints <span class="bcp14">MUST</span> ignore unknown
setup parameters. TODO: describe GREASE for those.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">The wire format of the Setup messages are as follows:<a href="#section-8.3-2" class="pilcrow">¶</a></p>
<span id="name-moqt-setup-messages"></span><div id="moq-transport-setup-format">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-8.3-3.1">
<pre>
CLIENT_SETUP Message {
  Type (i) = 0x20,
  Length (16),
  Number of Supported Versions (i),
  Supported Versions (i) ...,
  Number of Parameters (i),
  Setup Parameters (..) ...,
}

SERVER_SETUP Message {
  Type (i) = 0x21,
  Length (16),
  Selected Version (i),
  Number of Parameters (i),
  Setup Parameters (..) ...,
}
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-moqt-setup-messages" class="selfRef">MOQT Setup Messages</a>
          </figcaption></figure>
</div>
<p id="section-8.3-4">The available versions and Setup parameters are detailed in the next sections.<a href="#section-8.3-4" class="pilcrow">¶</a></p>
<div id="setup-versions">
<section id="section-8.3.1">
          <h4 id="name-versions">
<a href="#section-8.3.1" class="section-number selfRef">8.3.1. </a><a href="#name-versions" class="section-name selfRef">Versions</a>
          </h4>
<p id="section-8.3.1-1">MOQT versions are a 32-bit unsigned integer, encoded as a varint.
This version of the specification is identified by the number 0x00000001.
Versions with the most significant 16 bits of the version number cleared are
reserved for use in future IETF consensus documents.<a href="#section-8.3.1-1" class="pilcrow">¶</a></p>
<p id="section-8.3.1-2">The client offers the list of the protocol versions it supports; the
server <span class="bcp14">MUST</span> reply with one of the versions offered by the client. If the
server does not support any of the versions offered by the client, or
the client receives a server version that it did not offer, the
corresponding peer <span class="bcp14">MUST</span> close the session with <code>Version Negotiation Failed</code>.<a href="#section-8.3.1-2" class="pilcrow">¶</a></p>
<p id="section-8.3.1-3">[[RFC editor: please remove the remainder of this section before
publication.]]<a href="#section-8.3.1-3" class="pilcrow">¶</a></p>
<p id="section-8.3.1-4">The version number for the final version of this specification (0x00000001), is
reserved for the version of the protocol that is published as an RFC.
Version numbers used to identify IETF drafts are created by adding the draft
number to 0xff000000. For example, draft-ietf-moq-transport-13 would be
identified as 0xff00000D.<a href="#section-8.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="setup-params">
<section id="section-8.3.2">
          <h4 id="name-setup-parameters">
<a href="#section-8.3.2" class="section-number selfRef">8.3.2. </a><a href="#name-setup-parameters" class="section-name selfRef">Setup Parameters</a>
          </h4>
<div id="authority">
<section id="section-8.3.2.1">
            <h5 id="name-authority">
<a href="#section-8.3.2.1" class="section-number selfRef">8.3.2.1. </a><a href="#name-authority" class="section-name selfRef">AUTHORITY</a>
            </h5>
<p id="section-8.3.2.1-1">The AUTHORITY parameter (Parameter Type 0x05) allows the client to specify the
authority component of the MoQ URI when using native QUIC (<span>[<a href="#QUIC" class="cite xref">QUIC</a>]</span>).  It <span class="bcp14">MUST NOT</span> be used by the server, or when WebTransport is used.  When an AUTHORITY
parameter is received from a server, or when an AUTHORITY parameter is received
while WebTransport is used, or when an AUTHORITY parameter is received by a
server but the server does not support the specified authority, the session <span class="bcp14">MUST</span>
be closed with Invalid Authority.<a href="#section-8.3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-8.3.2.1-2">The AUTHORITY parameter follows the URI formatting rules <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>.
When connecting to a server using a URI with the "moqt" scheme, the
client <span class="bcp14">MUST</span> set the AUTHORITY parameter to the <code>authority</code> portion of the
URI. If an AUTHORITY parameter does not conform to
these rules, the session <span class="bcp14">MUST</span> be closed with Malformed Authority.<a href="#section-8.3.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="path">
<section id="section-8.3.2.2">
            <h5 id="name-path">
<a href="#section-8.3.2.2" class="section-number selfRef">8.3.2.2. </a><a href="#name-path" class="section-name selfRef">PATH</a>
            </h5>
<p id="section-8.3.2.2-1">The PATH parameter (Parameter Type 0x01) allows the client to specify the path
of the MoQ URI when using native QUIC (<span>[<a href="#QUIC" class="cite xref">QUIC</a>]</span>).  It <span class="bcp14">MUST NOT</span> be used by
the server, or when WebTransport is used.  When a PATH parameter is received
from a server, or when a PATH parameter is received while WebTransport is used,
or when a PATH parameter is received by a server but the server does not
support the specified path, the session <span class="bcp14">MUST</span> be closed with Invalid Path.<a href="#section-8.3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-8.3.2.2-2">The PATH parameter follows the URI formatting rules <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>.
When connecting to a server using a URI with the "moqt" scheme, the
client <span class="bcp14">MUST</span> set the PATH parameter to the <code>path-abempty</code> portion of the
URI; if <code>query</code> is present, the client <span class="bcp14">MUST</span> concatenate <code>?</code>, followed by
the <code>query</code> portion of the URI to the parameter. If a PATH does not conform to
these rules, the session <span class="bcp14">MUST</span> be closed with Malformed Path.<a href="#section-8.3.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="max-request-id">
<section id="section-8.3.2.3">
            <h5 id="name-max_request_id">
<a href="#section-8.3.2.3" class="section-number selfRef">8.3.2.3. </a><a href="#name-max_request_id" class="section-name selfRef">MAX_REQUEST_ID</a>
            </h5>
<p id="section-8.3.2.3-1">The MAX_REQUEST_ID parameter (Parameter Type 0x02) communicates an initial
value for the Maximum Request ID to the receiving endpoint. The default
value is 0, so if not specified, the peer <span class="bcp14">MUST NOT</span> send requests.<a href="#section-8.3.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="max-auth-token-cache-size">
<section id="section-8.3.2.4">
            <h5 id="name-max_auth_token_cache_size">
<a href="#section-8.3.2.4" class="section-number selfRef">8.3.2.4. </a><a href="#name-max_auth_token_cache_size" class="section-name selfRef">MAX_AUTH_TOKEN_CACHE_SIZE</a>
            </h5>
<p id="section-8.3.2.4-1">The MAX_AUTH_TOKEN_CACHE_SIZE parameter (Parameter Type 0x04) communicates the
maximum size in bytes of all actively registered Authorization tokens that the
server is willing to store per Session. This parameter is optional. The default
value is 0 which prohibits the use of token Aliases.<a href="#section-8.3.2.4-1" class="pilcrow">¶</a></p>
<p id="section-8.3.2.4-2">The token size is calculated as 16 bytes + the size of the Token Value field
(see <a href="#moq-token" class="auto internal xref">Figure 4</a>). The total size as restricted by the
MAX_AUTH_TOKEN_CACHE_SIZE parameter is calculated as the sum of the token sizes
for all registered tokens (Alias Type value of 0x01) minus the sum of the token
sizes for all deregistered tokens (Alias Type value of 0x00), since Session
initiation.<a href="#section-8.3.2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="setup-auth-token">
<section id="section-8.3.2.5">
            <h5 id="name-authorization-token-2">
<a href="#section-8.3.2.5" class="section-number selfRef">8.3.2.5. </a><a href="#name-authorization-token-2" class="section-name selfRef">AUTHORIZATION TOKEN</a>
            </h5>
<p id="section-8.3.2.5-1">See <a href="#authorization-token" class="auto internal xref">Section 8.2.1.1</a>.  The endpoint can specify one or more tokens in
CLIENT_SETUP or SERVER_SETUP that the peer can use to authorize MOQT session
establishment.<a href="#section-8.3.2.5-1" class="pilcrow">¶</a></p>
<p id="section-8.3.2.5-2">If a server receives an AUTHORIZATION TOKEN parameter in CLIENT_SETUP with Alias
Type REGISTER_TOKEN that exceeds its MAX_AUTH_TOKEN_CACHE_SIZE, it <span class="bcp14">MUST NOT</span> fail
the session with <code>Auth Token Cache Overflow</code>.  Instead, it <span class="bcp14">MUST</span> treat the
parameter as Alias Type USE_VALUE.  A client <span class="bcp14">MUST</span> handle registration failures
of this kind by purging any Token Aliases that failed to register based on the
MAX_AUTH_TOKEN_CACHE_SIZE parameter in SERVER_SETUP (or the default value of 0).<a href="#section-8.3.2.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="message-goaway">
<section id="section-8.4">
        <h3 id="name-goaway">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-goaway" class="section-name selfRef">GOAWAY</a>
        </h3>
<p id="section-8.4-1">An endpoint sends a <code>GOAWAY</code> message to inform the peer it intends to close
the session soon.  Servers can use GOAWAY to initiate session migration
(<a href="#session-migration" class="auto internal xref">Section 3.5</a>) with an optional URI.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">The GOAWAY message does not impact subscription state. A subscriber
<span class="bcp14">SHOULD</span> individually UNSUBSCRIBE for each existing subscription, while a
publisher <span class="bcp14">MAY</span> reject new requests while in the draining state.<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<p id="section-8.4-3">Upon receiving a GOAWAY, an endpoint <span class="bcp14">SHOULD NOT</span> initiate new requests to
the peer including SUBSCRIBE, PUBLISH, FETCH, ANNOUNCE and SUBSCRIBE_NAMESPACE.<a href="#section-8.4-3" class="pilcrow">¶</a></p>
<p id="section-8.4-4">The endpoint <span class="bcp14">MUST</span> terminate the session with a Protocol Violation
(<a href="#session-termination" class="auto internal xref">Section 3.4</a>) if it receives multiple GOAWAY messages.<a href="#section-8.4-4" class="pilcrow">¶</a></p>
<span id="name-moqt-goaway-message"></span><div id="moq-transport-goaway-format">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-8.4-5.1">
<pre>
GOAWAY Message {
  Type (i) = 0x10,
  Length (16),
  New Session URI Length (i),
  New Session URI (..),
}
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-moqt-goaway-message" class="selfRef">MOQT GOAWAY Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.4-6.1">
            <p id="section-8.4-6.1.1">New Session URI: When received by a client, indicates where the client can
connect to continue this session.  The client <span class="bcp14">MUST</span> use this URI for the new
session if provided. If the URI is zero bytes long, the current URI is reused
instead. The new session URI <span class="bcp14">SHOULD</span> use the same scheme
as the current URL to ensure compatibility.  The maxmimum length of the New
Session URI is 8,192 bytes.  If an endpoint receives a length exceeding the
maximum, it <span class="bcp14">MUST</span> close the session with a Protocol Violation.<a href="#section-8.4-6.1.1" class="pilcrow">¶</a></p>
<p id="section-8.4-6.1.2">
If a server receives a GOAWAY with a non-zero New Session URI Length it <span class="bcp14">MUST</span>
terminate the session with a Protocol Violation.<a href="#section-8.4-6.1.2" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-max-request-id">
<section id="section-8.5">
        <h3 id="name-max_request_id-2">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-max_request_id-2" class="section-name selfRef">MAX_REQUEST_ID</a>
        </h3>
<p id="section-8.5-1">An endpoint sends a MAX_REQUEST_ID message to increase the number of requests
the peer can send within a session.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<p id="section-8.5-2">The Maximum Request ID <span class="bcp14">MUST</span> only increase within a session, and
receipt of a MAX_REQUEST_ID message with an equal or smaller Request ID
value is a 'Protocol Violation'.<a href="#section-8.5-2" class="pilcrow">¶</a></p>
<span id="name-moqt-max_request_id-message"></span><div id="moq-transport-max-request-id">
<figure id="figure-7">
          <div class="alignLeft art-text artwork" id="section-8.5-3.1">
<pre>
MAX_REQUEST_ID Message {
  Type (i) = 0x15,
  Length (16),
  Request ID (i),
}
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-moqt-max_request_id-message" class="selfRef">MOQT MAX_REQUEST_ID Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.5-4.1">
            <p id="section-8.5-4.1.1">Request ID: The new Maximum Request ID for the session plus one. If a Request
ID equal or larger than this is received by the endpoint that sent the
MAX_REQUEST_ID in any request message (ANNOUNCE, FETCH, SUBSCRIBE,
SUBSCRIBE_NAMESPACE or TRACK_STATUS), the endpoint <span class="bcp14">MUST</span> close the session with
an error of 'Too Many Requests'.<a href="#section-8.5-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.5-5">MAX_REQUEST_ID is similar to MAX_STREAMS in (<span>[<a href="#RFC9000" class="cite xref">RFC9000</a>], <a href="https://rfc-editor.org/rfc/rfc9000#section-4.6" class="relref">Section 4.6</a></span>), and
similar considerations apply when deciding how often to send MAX_REQUEST_ID.
For example, implementations might choose to increase MAX_REQUEST_ID as
subscriptions close to keep the number of subscriptions available roughly
consistent.<a href="#section-8.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-requests-blocked">
<section id="section-8.6">
        <h3 id="name-requests_blocked">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-requests_blocked" class="section-name selfRef">REQUESTS_BLOCKED</a>
        </h3>
<p id="section-8.6-1">The REQUESTS_BLOCKED message is sent when an endpoint would like to send a new
request, but cannot because the Request ID would exceed the Maximum Request ID
value sent by the peer.  The endpoint <span class="bcp14">SHOULD</span> send only one REQUESTS_BLOCKED for
a given Maximum Request ID.<a href="#section-8.6-1" class="pilcrow">¶</a></p>
<p id="section-8.6-2">An endpoint <span class="bcp14">MAY</span> send a MAX_REQUEST_ID upon receipt of REQUESTS_BLOCKED, but it
<span class="bcp14">MUST NOT</span> rely on REQUESTS_BLOCKED to trigger sending a MAX_REQUEST_ID, because
sending REQUESTS_BLOCKED is not required.<a href="#section-8.6-2" class="pilcrow">¶</a></p>
<span id="name-moqt-requests_blocked-messa"></span><div id="moq-transport-requests-blocked">
<figure id="figure-8">
          <div class="alignLeft art-text artwork" id="section-8.6-3.1">
<pre>
REQUESTS_BLOCKED Message {
  Type (i) = 0x1A,
  Length (16),
  Maximum Request ID (i),
}
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-moqt-requests_blocked-messa" class="selfRef">MOQT REQUESTS_BLOCKED Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.6-4.1">
            <p id="section-8.6-4.1.1">Maximum Request ID: The Maximum Request ID for the session on which the
endpoint is blocked. More on Request ID in <a href="#message-subscribe-req" class="auto internal xref">Section 8.7</a>.<a href="#section-8.6-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-subscribe-req">
<section id="section-8.7">
        <h3 id="name-subscribe">
<a href="#section-8.7" class="section-number selfRef">8.7. </a><a href="#name-subscribe" class="section-name selfRef">SUBSCRIBE</a>
        </h3>
<p id="section-8.7-1">A subscription causes the publisher to send newly published objects for a track.
A subscriber <span class="bcp14">MUST NOT</span> make multiple active subscriptions for a track within a
single session and publishers <span class="bcp14">SHOULD</span> treat this as a protocol violation.<a href="#section-8.7-1" class="pilcrow">¶</a></p>
<p id="section-8.7-2"><strong>Filter Types</strong><a href="#section-8.7-2" class="pilcrow">¶</a></p>
<p id="section-8.7-3">The subscriber specifies a filter on the subscription to allow
the publisher to identify which objects need to be delivered.<a href="#section-8.7-3" class="pilcrow">¶</a></p>
<p id="section-8.7-4">All filters have a Start Location and an optional End Group.  Only objects
published or received via a subscription having Locations greater than or
equal to Start and strictly less than or equal to the End Group (when
present) pass the filter.<a href="#section-8.7-4" class="pilcrow">¶</a></p>
<p id="section-8.7-5">The <code>Largest Object</code> is defined to be the object with the largest Location
(<a href="#location-structure" class="auto internal xref">Section 1.3.1</a>) in the track from the perspective of the endpoint
processing the SUBSCRIBE message. Largest Object updates when the first byte of
an Object with a larger Location than the previous value is published or
received through a subscription.<a href="#section-8.7-5" class="pilcrow">¶</a></p>
<p id="section-8.7-6">There are 4 types of filters:<a href="#section-8.7-6" class="pilcrow">¶</a></p>
<p id="section-8.7-7">Largest Object (0x2): The filter Start Location is <code>{Largest Object.Group,
Largest Object.Object + 1}</code> and <code>Largest Object</code> is communicated in
SUBSCRIBE_OK. If no content has been delivered yet, the filter Start Location is
{0, 0}. There is no End Group - the subscription is open ended.  Note that due
to network reordering or prioritization, relays can receive Objects with
Locations smaller than  <code>Largest Object</code> after the SUBSCRIBE is processed, but
these Objects do not pass the Largest Object filter.<a href="#section-8.7-7" class="pilcrow">¶</a></p>
<p id="section-8.7-8">Next Group Start (0x1): The filter start Location is <code>{Largest Object.Group + 1,
0}</code> and <code>Largest Object</code> is communicated in SUBSCRIBE_OK. If no content has been
delivered yet, the filter Start Location is {0, 0}.  There is no End Group -
the subscription is open ended. For scenarios where the subscriber intends to
start more than one group in the future, it can use an AbsoluteStart filter
instead.<a href="#section-8.7-8" class="pilcrow">¶</a></p>
<p id="section-8.7-9">AbsoluteStart (0x3):  The filter Start Location is specified explicitly in the
SUBSCRIBE message. The <code>Start</code> specified in the SUBSCRIBE message <span class="bcp14">MAY</span> be less
than the <code>Largest Object</code> observed at the publisher. There is no End Group - the
subscription is open ended.  To receive all Objects that are published or are
received after this subscription is processed, a subscriber can use an
AbsoluteStart filter with <code>Start</code> = {0, 0}.<a href="#section-8.7-9" class="pilcrow">¶</a></p>
<p id="section-8.7-10">AbsoluteRange (0x4):  The filer Start Location and End Group are specified
explicitly in the SUBSCRIBE message. The <code>Start</code> specified in the SUBSCRIBE
message <span class="bcp14">MAY</span> be less than the <code>Largest Object</code> observed at the publisher. If the
specified <code>End Group</code> is the same group specified in <code>Start</code>, the remainder of
that Group passes the filter. <code>End Group</code> <span class="bcp14">MUST</span> specify the same or a larger Group
than specified in <code>Start</code>.<a href="#section-8.7-10" class="pilcrow">¶</a></p>
<p id="section-8.7-11">A filter type other than the above <span class="bcp14">MUST</span> be treated as error.<a href="#section-8.7-11" class="pilcrow">¶</a></p>
<p id="section-8.7-12">Subscribe only delivers newly published or received Objects.  Objects from the
past are retrieved using FETCH (<a href="#message-fetch" class="auto internal xref">Section 8.16</a>).<a href="#section-8.7-12" class="pilcrow">¶</a></p>
<p id="section-8.7-13">A Subscription can also request a publisher to not forward Objects for a given
track by setting the <code>Forward</code> field to 0. This allows the publisher or relay to
prepare to serve the subscription in advance, reducing the time to receive
objects in the future. Relays <span class="bcp14">SHOULD</span> set the <code>Forward</code> flag to 1 if a new
subscription needs to be sent upstream, regardless of the value of the <code>Forward</code>
field from the downstream subscription. Subscriptions that are not forwarded
consume resources from the publisher, so a publisher might deprioritize, reject,
or close those subscriptions to ensure other subscriptions can be delivered.
Control messages, such as SUBCRIBE_DONE (<a href="#message-subscribe-done" class="auto internal xref">Section 8.12</a>) are still
sent.<a href="#section-8.7-13" class="pilcrow">¶</a></p>
<p id="section-8.7-14">The format of SUBSCRIBE is as follows:<a href="#section-8.7-14" class="pilcrow">¶</a></p>
<span id="name-moqt-subscribe-message"></span><div id="moq-transport-subscribe-format">
<figure id="figure-9">
          <div class="alignLeft art-text artwork" id="section-8.7-15.1">
<pre>
SUBSCRIBE Message {
  Type (i) = 0x3,
  Length (16),
  Request ID (i),
  Track Namespace (tuple),
  Track Name Length (i),
  Track Name (..),
  Subscriber Priority (8),
  Group Order (8),
  Forward (8),
  Filter Type (i),
  [Start Location (Location)],
  [End Group (i)],
  Number of Parameters (i),
  Subscribe Parameters (..) ...
}
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-moqt-subscribe-message" class="selfRef">MOQT SUBSCRIBE Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.7-16.1">
            <p id="section-8.7-16.1.1">Request ID: See <a href="#request-id" class="auto internal xref">Section 8.1</a>.<a href="#section-8.7-16.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.7-16.2">
            <p id="section-8.7-16.2.1">Track Namespace: Identifies the namespace of the track as defined in
(<a href="#track-name" class="auto internal xref">Section 2.4.1</a>).<a href="#section-8.7-16.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.7-16.3">
            <p id="section-8.7-16.3.1">Track Name: Identifies the track name as defined in (<a href="#track-name" class="auto internal xref">Section 2.4.1</a>).<a href="#section-8.7-16.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.7-16.4">
            <p id="section-8.7-16.4.1">Subscriber Priority: Specifies the priority of a subscription relative to
other subscriptions in the same session. Lower numbers get higher priority.
See <a href="#priorities" class="auto internal xref">Section 6</a>.<a href="#section-8.7-16.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.7-16.5">
            <p id="section-8.7-16.5.1">Group Order: Allows the subscriber to request Objects be delivered in
Ascending (0x1) or Descending (0x2) order by group. See <a href="#priorities" class="auto internal xref">Section 6</a>.
A value of 0x0 indicates the original publisher's Group Order <span class="bcp14">SHOULD</span> be
used. Values larger than 0x2 are a protocol error.<a href="#section-8.7-16.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.7-16.6">
            <p id="section-8.7-16.6.1">Forward: If 1, Objects matching the subscription are forwarded
to the subscriber. If 0, Objects are not forwarded to the subscriber.
Any other value is a protocol error and <span class="bcp14">MUST</span> terminate the
session with a Protocol Violation (<a href="#session-termination" class="auto internal xref">Section 3.4</a>).<a href="#section-8.7-16.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.7-16.7">
            <p id="section-8.7-16.7.1">Filter Type: Identifies the type of filter, which also indicates whether
the Start and End Group fields will be present.<a href="#section-8.7-16.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.7-16.8">
            <p id="section-8.7-16.8.1">Start Location: The starting location for this subscriptions. Only present for
"AbsoluteStart" and "AbsoluteRange" filter types.<a href="#section-8.7-16.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.7-16.9">
            <p id="section-8.7-16.9.1">End Group: The end Group ID, inclusive. Only present for the "AbsoluteRange"
filter type.<a href="#section-8.7-16.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.7-16.10">
            <p id="section-8.7-16.10.1">Subscribe Parameters: The parameters are defined in <a href="#version-specific-params" class="auto internal xref">Section 8.2.1</a>.<a href="#section-8.7-16.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.7-17">On successful subscription, the publisher <span class="bcp14">MUST</span> reply with a SUBSCRIBE_OK,
allowing the subscriber to determine the start group/object when not explicitly
specified and the publisher <span class="bcp14">SHOULD</span> start delivering objects.<a href="#section-8.7-17" class="pilcrow">¶</a></p>
<p id="section-8.7-18">If a publisher cannot satisfy the requested start or end or if the end has
already been published it <span class="bcp14">SHOULD</span> send a SUBSCRIBE_ERROR with code 'Invalid Range'.
A publisher <span class="bcp14">MUST NOT</span> send objects from outside the requested start and end.<a href="#section-8.7-18" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-subscribe-ok">
<section id="section-8.8">
        <h3 id="name-subscribe_ok">
<a href="#section-8.8" class="section-number selfRef">8.8. </a><a href="#name-subscribe_ok" class="section-name selfRef">SUBSCRIBE_OK</a>
        </h3>
<p id="section-8.8-1">A publisher sends a SUBSCRIBE_OK control message for successful
subscriptions.<a href="#section-8.8-1" class="pilcrow">¶</a></p>
<span id="name-moqt-subscribe_ok-message"></span><div id="moq-transport-subscribe-ok">
<figure id="figure-10">
          <div class="alignLeft art-text artwork" id="section-8.8-2.1">
<pre>
SUBSCRIBE_OK Message {
  Type (i) = 0x4,
  Length (16),
  Request ID (i),
  Track Alias (i),
  Expires (i),
  Group Order (8),
  Content Exists (8),
  [Largest Location (Location)],
  Number of Parameters (i),
  Subscribe Parameters (..) ...
}
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-moqt-subscribe_ok-message" class="selfRef">MOQT SUBSCRIBE_OK Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.8-3.1">
            <p id="section-8.8-3.1.1">Request ID: The Request ID of the SUBSCRIBE this message is replying to
<a href="#message-subscribe-req" class="auto internal xref">Section 8.7</a>.<a href="#section-8.8-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.8-3.2">
            <p id="section-8.8-3.2.1">Track Alias: The identifer used for this track in Subgroups or Datagrams (see
<a href="#track-alias" class="auto internal xref">Section 9.1</a>). The same Track Alias <span class="bcp14">MUST NOT</span> be used to refer to two
different Tracks simultaneously. If a subscriber receives a SUBSCRIBE_OK that
uses the same Track Alias as a different track with an active subscription, it
<span class="bcp14">MUST</span> close the session with error 'Duplicate Track Alias'.<a href="#section-8.8-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.8-3.3">
            <p id="section-8.8-3.3.1">Expires: Time in milliseconds after which the subscription is no
longer valid. A value of 0 indicates that the subscription does not expire
or expires at an unknown time.  Expires is advisory and a subscription can
end prior to the expiry time or last longer.<a href="#section-8.8-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.8-3.4">
            <p id="section-8.8-3.4.1">Group Order: Indicates the subscription will be delivered in
Ascending (0x1) or Descending (0x2) order by group. See <a href="#priorities" class="auto internal xref">Section 6</a>.
Values of 0x0 and those larger than 0x2 are a protocol error.<a href="#section-8.8-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.8-3.5">
            <p id="section-8.8-3.5.1">Content Exists: 1 if an object has been published on this track, 0 if not.
If 0, then the Largest Group ID and Largest Object ID fields will not be
present. Any other value is a protocol error and <span class="bcp14">MUST</span> terminate the
session with a Protocol Violation (<a href="#session-termination" class="auto internal xref">Section 3.4</a>).<a href="#section-8.8-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.8-3.6">
            <p id="section-8.8-3.6.1">Largest Location: The location of the largest object available for this track. This
field is only present if Content Exists has a value of 1.<a href="#section-8.8-3.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.8-3.7">
            <p id="section-8.8-3.7.1">Subscribe Parameters: The parameters are defined in <a href="#version-specific-params" class="auto internal xref">Section 8.2.1</a>.<a href="#section-8.8-3.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-subscribe-error">
<section id="section-8.9">
        <h3 id="name-subscribe_error">
<a href="#section-8.9" class="section-number selfRef">8.9. </a><a href="#name-subscribe_error" class="section-name selfRef">SUBSCRIBE_ERROR</a>
        </h3>
<p id="section-8.9-1">A publisher sends a SUBSCRIBE_ERROR control message in response to a
failed SUBSCRIBE.<a href="#section-8.9-1" class="pilcrow">¶</a></p>
<span id="name-moqt-subscribe_error-messag"></span><div id="moq-transport-subscribe-error">
<figure id="figure-11">
          <div class="alignLeft art-text artwork" id="section-8.9-2.1">
<pre>
SUBSCRIBE_ERROR Message {
  Type (i) = 0x5,
  Length (16),
  Request ID (i),
  Error Code (i),
  Error Reason (Reason Phrase),
}
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-moqt-subscribe_error-messag" class="selfRef">MOQT SUBSCRIBE_ERROR Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.9-3.1">
            <p id="section-8.9-3.1.1">Request ID: The Request ID of the SUBSCRIBE this message is replying to
<a href="#message-subscribe-req" class="auto internal xref">Section 8.7</a>.<a href="#section-8.9-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.9-3.2">
            <p id="section-8.9-3.2.1">Error Code: Identifies an integer error code for subscription failure.<a href="#section-8.9-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.9-3.3">
            <p id="section-8.9-3.3.1">Error Reason: Provides the reason for subscription error. See <a href="#reason-phrase" class="auto internal xref">Section 1.3.3</a>.<a href="#section-8.9-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.9-4">The application <span class="bcp14">SHOULD</span> use a relevant error code in SUBSCRIBE_ERROR,
as defined below:<a href="#section-8.9-4" class="pilcrow">¶</a></p>
<table class="center" id="table-4">
          <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Code</th>
              <th class="text-left" rowspan="1" colspan="1">Reason</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">Internal Error</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x1</td>
              <td class="text-left" rowspan="1" colspan="1">Unauthorized</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x2</td>
              <td class="text-left" rowspan="1" colspan="1">Timeout</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x3</td>
              <td class="text-left" rowspan="1" colspan="1">Not Supported</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x4</td>
              <td class="text-left" rowspan="1" colspan="1">Track Does Not Exist</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x5</td>
              <td class="text-left" rowspan="1" colspan="1">Invalid Range</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x10</td>
              <td class="text-left" rowspan="1" colspan="1">Malformed Auth Token</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x12</td>
              <td class="text-left" rowspan="1" colspan="1">Expired Auth Token</td>
            </tr>
          </tbody>
        </table>
<ul class="normal">
<li class="normal" id="section-8.9-6.1">
            <p id="section-8.9-6.1.1">Internal Error - An implementation specific or generic error occurred.<a href="#section-8.9-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.9-6.2">
            <p id="section-8.9-6.2.1">Unauthorized - The subscriber is not authorized to subscribe to the given
track.<a href="#section-8.9-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.9-6.3">
            <p id="section-8.9-6.3.1">Timeout - The subscription could not be completed before an implementation
specific timeout.  For example, a relay could not establish an upstream
subscription within the timeout.<a href="#section-8.9-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.9-6.4">
            <p id="section-8.9-6.4.1">Not Supported - The endpoint does not support the SUBSCRIBE method.<a href="#section-8.9-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.9-6.5">
            <p id="section-8.9-6.5.1">Track Does Not Exist - The requested track is not available at the publisher.<a href="#section-8.9-6.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.9-6.6">
            <p id="section-8.9-6.6.1">Invalid Range - The end of the SUBSCRIBE range is earlier than the beginning,
or the end of the range has already been published.<a href="#section-8.9-6.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.9-6.7">
            <p id="section-8.9-6.7.1">Malformed Auth Token - Invalid Auth Token serialization during registration
(see <a href="#authorization-token" class="auto internal xref">Section 8.2.1.1</a>).<a href="#section-8.9-6.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.9-6.8">
            <p id="section-8.9-6.8.1">Expired Auth Token - Authorization token has expired <a href="#authorization-token" class="auto internal xref">Section 8.2.1.1</a>).<a href="#section-8.9-6.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-subscribe-update">
<section id="section-8.10">
        <h3 id="name-subscribe_update">
<a href="#section-8.10" class="section-number selfRef">8.10. </a><a href="#name-subscribe_update" class="section-name selfRef">SUBSCRIBE_UPDATE</a>
        </h3>
<p id="section-8.10-1">A subscriber sends a SUBSCRIBE_UPDATE to a publisher to modify an existing
subscription. Subscriptions can only be narrowed, not widened, as an attempt to
widen could fail. If Objects with Locations smaller than the current
subscription's Start Location are required, FETCH can be used to retrieve
them. The Start Location <span class="bcp14">MUST NOT</span> decrease, and if it increases, there is no
guarantee that the publisher has not already sent Objects with Locations smaller
than the new Start Location. Similarly, the End Group <span class="bcp14">MUST NOT</span> increase, and if
it decreases, there is no guarantee that the publisher has not already sent
Objects with Locations larger than the new End Location.  A publisher <span class="bcp14">MUST</span>
terminate the session with a 'Protocol Violation' if the SUBSCRIBE_UPDATE
violates these rules or if the subscriber specifies a request ID that has not
existed within the Session.<a href="#section-8.10-1" class="pilcrow">¶</a></p>
<p id="section-8.10-2">There is no control message in response to a SUBSCRIBE_UPDATE, because it is
expected that it will always succeed and the worst outcome is that it is not
processed promptly and some extra objects from the existing subscription are
delivered.<a href="#section-8.10-2" class="pilcrow">¶</a></p>
<p id="section-8.10-3">Unlike a new subscription, SUBSCRIBE_UPDATE can not cause an Object to be
delivered multiple times.  Like SUBSCRIBE, End Group <span class="bcp14">MUST</span> be greater than or
equal to the Group specified in <code>Start</code>.<a href="#section-8.10-3" class="pilcrow">¶</a></p>
<p id="section-8.10-4">If a parameter included in <code>SUBSCRIBE</code> is not present in
<code>SUBSCRIBE_UPDATE</code>, its value remains unchanged.  There is no mechanism to
remove a parameter from a subscription.<a href="#section-8.10-4" class="pilcrow">¶</a></p>
<p id="section-8.10-5">The format of SUBSCRIBE_UPDATE is as follows:<a href="#section-8.10-5" class="pilcrow">¶</a></p>
<span id="name-moqt-subscribe_update-messa"></span><div id="moq-transport-subscribe-update-format">
<figure id="figure-12">
          <div class="alignLeft art-text artwork" id="section-8.10-6.1">
<pre>
SUBSCRIBE_UPDATE Message {
  Type (i) = 0x2,
  Length (16),
  Request ID (i),
  Start Location (Location),
  End Group (i),
  Subscriber Priority (8),
  Forward (8),
  Number of Parameters (i),
  Subscribe Parameters (..) ...
}
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-moqt-subscribe_update-messa" class="selfRef">MOQT SUBSCRIBE_UPDATE Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.10-7.1">
            <p id="section-8.10-7.1.1">Request ID: The Request ID of the SUBSCRIBE (<a href="#message-subscribe-req" class="auto internal xref">Section 8.7</a>) this
message is updating.  This <span class="bcp14">MUST</span> match an existing Request ID.<a href="#section-8.10-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.10-7.2">
            <p id="section-8.10-7.2.1">Start Location : The starting location.<a href="#section-8.10-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.10-7.3">
            <p id="section-8.10-7.3.1">End Group: The end Group ID, plus 1. A value of 0 means the subscription is
open-ended.<a href="#section-8.10-7.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.10-7.4">
            <p id="section-8.10-7.4.1">Subscriber Priority: Specifies the priority of a subscription relative to
other subscriptions in the same session. Lower numbers get higher priority.
See <a href="#priorities" class="auto internal xref">Section 6</a>.<a href="#section-8.10-7.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.10-7.5">
            <p id="section-8.10-7.5.1">Forward: If 1, Objects matching the subscription are forwarded
to the subscriber. If 0, Objects are not forwarded to the subscriber.
Any other value is a protocol error and <span class="bcp14">MUST</span> terminate the
session with a Protocol Violation (<a href="#session-termination" class="auto internal xref">Section 3.4</a>).<a href="#section-8.10-7.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.10-7.6">
            <p id="section-8.10-7.6.1">Subscribe Parameters: The parameters are defined in <a href="#version-specific-params" class="auto internal xref">Section 8.2.1</a>.<a href="#section-8.10-7.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-unsubscribe">
<section id="section-8.11">
        <h3 id="name-unsubscribe">
<a href="#section-8.11" class="section-number selfRef">8.11. </a><a href="#name-unsubscribe" class="section-name selfRef">UNSUBSCRIBE</a>
        </h3>
<p id="section-8.11-1">A subscriber issues a <code>UNSUBSCRIBE</code> message to a publisher indicating it is no
longer interested in receiving media for the specified track and requesting that
the publisher stop sending Objects as soon as possible.<a href="#section-8.11-1" class="pilcrow">¶</a></p>
<p id="section-8.11-2">The format of <code>UNSUBSCRIBE</code> is as follows:<a href="#section-8.11-2" class="pilcrow">¶</a></p>
<span id="name-moqt-unsubscribe-message"></span><div id="moq-transport-unsubscribe-format">
<figure id="figure-13">
          <div class="alignLeft art-text artwork" id="section-8.11-3.1">
<pre>
UNSUBSCRIBE Message {
  Type (i) = 0xA,
  Length (16),
  Request ID (i)
}
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-moqt-unsubscribe-message" class="selfRef">MOQT UNSUBSCRIBE Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.11-4.1">
            <p id="section-8.11-4.1.1">Request ID: The Request ID of the subscription that is being terminated. See
<a href="#message-subscribe-req" class="auto internal xref">Section 8.7</a>.<a href="#section-8.11-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-subscribe-done">
<section id="section-8.12">
        <h3 id="name-subscribe_done">
<a href="#section-8.12" class="section-number selfRef">8.12. </a><a href="#name-subscribe_done" class="section-name selfRef">SUBSCRIBE_DONE</a>
        </h3>
<p id="section-8.12-1">A publisher sends a <code>SUBSCRIBE_DONE</code> message to indicate it is done publishing
Objects for that subscription.  The Status Code indicates why the subscription
ended, and whether it was an error. Because SUBSCRIBE_DONE is sent on the
control stream, it is likely to arrive at the receiver before late-arriving
objects, and often even late-opening streams. However, the receiver uses it
as an indication that it should receive any late-opening streams in a relatively
short time.<a href="#section-8.12-1" class="pilcrow">¶</a></p>
<p id="section-8.12-2">Note that some objects in the subscribed track might never be delivered,
because a stream was reset, or never opened in the first place, due to the
delivery timeout.<a href="#section-8.12-2" class="pilcrow">¶</a></p>
<p id="section-8.12-3">A sender <span class="bcp14">MUST NOT</span> send SUBSCRIBE_DONE until it has closed all streams it will
ever open, and has no further datagrams to send, for a subscription. After
sending SUBSCRIBE_DONE, the sender can immediately destroy subscription state,
although stream state can persist until delivery completes. The sender might
persist subscription state to enforce the delivery timeout by resetting streams
on which it has already sent FIN, only deleting it when all such streams have
received ACK of the FIN.<a href="#section-8.12-3" class="pilcrow">¶</a></p>
<p id="section-8.12-4">A sender <span class="bcp14">MUST NOT</span> destroy subscription state until it sends SUBSCRIBE_DONE,
though it can choose to stop sending objects (and thus send SUBSCRIBE_DONE) for
any reason.<a href="#section-8.12-4" class="pilcrow">¶</a></p>
<p id="section-8.12-5">A subscriber that receives SUBSCRIBE_DONE <span class="bcp14">SHOULD</span> set a timer of at least its
delivery timeout in case some objects are still inbound due to prioritization
or packet loss. The subscriber <span class="bcp14">MAY</span> dispense with a timer if it sent UNSUBSCRIBE
or is otherwise no longer interested in objects from the track. Once the timer
has expired, the receiver destroys subscription state once all open streams for
the subscription have closed. A subscriber <span class="bcp14">MAY</span> discard subscription state
earlier, at the cost of potentially not delivering some late objects to the
application. The subscriber <span class="bcp14">SHOULD</span> send STOP_SENDING on all streams related to
the subscription when it deletes subscription state.<a href="#section-8.12-5" class="pilcrow">¶</a></p>
<p id="section-8.12-6">The format of <code>SUBSCRIBE_DONE</code> is as follows:<a href="#section-8.12-6" class="pilcrow">¶</a></p>
<span id="name-moqt-subscribe_done-message"></span><div id="moq-transport-subscribe-fin-format">
<figure id="figure-14">
          <div class="alignLeft art-text artwork" id="section-8.12-7.1">
<pre>
SUBSCRIBE_DONE Message {
  Type (i) = 0xB,
  Length (16),
  Request ID (i),
  Status Code (i),
  Stream Count (i),
  Error Reason (Reason Phrase)
}
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-moqt-subscribe_done-message" class="selfRef">MOQT SUBSCRIBE_DONE Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.12-8.1">
            <p id="section-8.12-8.1.1">Request ID: The Request ID of the subscription that is being terminated. See
<a href="#message-subscribe-req" class="auto internal xref">Section 8.7</a>.<a href="#section-8.12-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.12-8.2">
            <p id="section-8.12-8.2.1">Status Code: An integer status code indicating why the subscription ended.<a href="#section-8.12-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.12-8.3">
            <p id="section-8.12-8.3.1">Stream Count: An integer indicating the number of data streams the publisher
opened for this subscription.  This helps the subscriber know if it has received
all of the data published in this subscription by comparing the number of
streams received.  The subscriber can immediately remove all subscription state
once the same number of streams have been processed.  If the track had
Forwarding Preference = Datagram, the publisher <span class="bcp14">MUST</span> set Stream Count to 0.  If
the publisher is unable to set Stream Count to the exact number of streams
opened for the subscription, it <span class="bcp14">MUST</span> set Stream Count to 2^62 - 1. Subscribers
<span class="bcp14">SHOULD</span> use a timeout or other mechanism to remove subscription state in case
the publisher set an incorrect value, reset a stream before the SUBGROUP_HEADER,
or set the maximum value.  If a subscriber receives more streams for a
subscription than specified in Stream Count, it <span class="bcp14">MAY</span> close the session with a
Protocol Violation.<a href="#section-8.12-8.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.12-8.4">
            <p id="section-8.12-8.4.1">Error Reason: Provides the reason for subscription error. See <a href="#reason-phrase" class="auto internal xref">Section 1.3.3</a>.<a href="#section-8.12-8.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.12-9">The application <span class="bcp14">SHOULD</span> use a relevant status code in
SUBSCRIBE_DONE, as defined below:<a href="#section-8.12-9" class="pilcrow">¶</a></p>
<table class="center" id="table-5">
          <caption><a href="#table-5" class="selfRef">Table 5</a></caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Code</th>
              <th class="text-left" rowspan="1" colspan="1">Reason</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">Internal Error</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x1</td>
              <td class="text-left" rowspan="1" colspan="1">Unauthorized</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x2</td>
              <td class="text-left" rowspan="1" colspan="1">Track Ended</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x3</td>
              <td class="text-left" rowspan="1" colspan="1">Subscription Ended</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x4</td>
              <td class="text-left" rowspan="1" colspan="1">Going Away</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x5</td>
              <td class="text-left" rowspan="1" colspan="1">Expired</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x6</td>
              <td class="text-left" rowspan="1" colspan="1">Too Far Behind</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x7</td>
              <td class="text-left" rowspan="1" colspan="1">Malformed Track</td>
            </tr>
          </tbody>
        </table>
<ul class="normal">
<li class="normal" id="section-8.12-11.1">
            <p id="section-8.12-11.1.1">Internal Error - An implementation specific or generic error occurred.<a href="#section-8.12-11.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.12-11.2">
            <p id="section-8.12-11.2.1">Unauthorized - The subscriber is no longer authorized to subscribe to the
given track.<a href="#section-8.12-11.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.12-11.3">
            <p id="section-8.12-11.3.1">Track Ended - The track is no longer being published.<a href="#section-8.12-11.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.12-11.4">
            <p id="section-8.12-11.4.1">Subscription Ended - The publisher reached the end of an associated
Subscribe filter.<a href="#section-8.12-11.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.12-11.5">
            <p id="section-8.12-11.5.1">Going Away - The subscriber or publisher issued a GOAWAY message.<a href="#section-8.12-11.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.12-11.6">
            <p id="section-8.12-11.6.1">Expired - The publisher reached the timeout specified in SUBSCRIBE_OK.<a href="#section-8.12-11.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.12-11.7">
            <p id="section-8.12-11.7.1">Too Far Behind - The publisher's queue of objects to be sent to the given
subscriber exceeds its implementation defined limit.<a href="#section-8.12-11.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.12-11.8">
            <p id="section-8.12-11.8.1">Malformed Track - A relay publisher detected the track was malformed (see
<a href="#malformed-tracks" class="auto internal xref">Section 2.5</a>).<a href="#section-8.12-11.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-publish">
<section id="section-8.13">
        <h3 id="name-publish">
<a href="#section-8.13" class="section-number selfRef">8.13. </a><a href="#name-publish" class="section-name selfRef">PUBLISH</a>
        </h3>
<p id="section-8.13-1">The publisher sends the PUBLISH control message to initiate a subscription to a
track. The receiver verifies the publisher is authorized to publish this track.<a href="#section-8.13-1" class="pilcrow">¶</a></p>
<span id="name-moqt-publish-message"></span><div id="moq-transport-publish-format">
<figure id="figure-15">
          <div class="alignLeft art-text artwork" id="section-8.13-2.1">
<pre>
PUBLISH Message {
  Type (i) = 0x1D,
  Length (i),
  Request ID (i),
  Track Namespace (tuple),
  Track Name Length (i),
  Track Name (..),
  Track Alias (i),
  Group Order (8),
  ContentExists (8),
  [Largest Location (Location),]
  Forward (8),
  Number of Parameters (i),
  Parameters (..) ...,
}
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-moqt-publish-message" class="selfRef">MOQT PUBLISH Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.13-3.1">
            <p id="section-8.13-3.1.1">Request ID: See <a href="#request-id" class="auto internal xref">Section 8.1</a>.<a href="#section-8.13-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.13-3.2">
            <p id="section-8.13-3.2.1">Track Namespace: Identifies a track's namespace as defined in (<a href="#track-name" class="auto internal xref">Section 2.4.1</a>)<a href="#section-8.13-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.13-3.3">
            <p id="section-8.13-3.3.1">Track Name: Identifies the track name as defined in (<a href="#track-name" class="auto internal xref">Section 2.4.1</a>).<a href="#section-8.13-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.13-3.4">
            <p id="section-8.13-3.4.1">Track Alias: The identifer used for this track in Subgroups or Datagrams (see
<a href="#track-alias" class="auto internal xref">Section 9.1</a>). The same Track Alias <span class="bcp14">MUST NOT</span> be used to refer to two
different Tracks simultaneously. If a subscriber receives a PUBLISH that
uses the same Track Alias as a different track with an active subscription, it
<span class="bcp14">MUST</span> close the session with error 'Duplicate Track Alias'.<a href="#section-8.13-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.13-3.5">
            <p id="section-8.13-3.5.1">Group Order: Indicates the subscription will be delivered in
Ascending (0x1) or Descending (0x2) order by group. See <a href="#priorities" class="auto internal xref">Section 6</a>.
Values of 0x0 and those larger than 0x2 are a protocol error.<a href="#section-8.13-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.13-3.6">
            <p id="section-8.13-3.6.1">ContentExists: 1 if an object has been published on this track, 0 if not.
If 0, then the Largest Group ID and Largest Object ID fields will not be
present. Any other value is a protocol error and <span class="bcp14">MUST</span> terminate the
session with a Protocol Violation (<a href="#session-termination" class="auto internal xref">Section 3.4</a>).<a href="#section-8.13-3.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.13-3.7">
            <p id="section-8.13-3.7.1">Largest Location: The location of the largest object available for this track.<a href="#section-8.13-3.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.13-3.8">
            <p id="section-8.13-3.8.1">Forward: The forward mode for this subscription.  Any value other than 0 or 1
is a Protocol Violation.  0 indicates the publisher will not transmit any
objects until the subscriber sets the Forward State to 1. 1 indicates the
publisher will start transmitting objects immediately, even before PUBLISH_OK.<a href="#section-8.13-3.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.13-3.9">
            <p id="section-8.13-3.9.1">Parameters: The parameters are defined in <a href="#version-specific-params" class="auto internal xref">Section 8.2.1</a>.<a href="#section-8.13-3.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-publish-ok">
<section id="section-8.14">
        <h3 id="name-publish_ok">
<a href="#section-8.14" class="section-number selfRef">8.14. </a><a href="#name-publish_ok" class="section-name selfRef">PUBLISH_OK</a>
        </h3>
<p id="section-8.14-1">The subscriber sends an PUBLISH_OK control message to acknowledge the successful
authorization and acceptance of a PUBLISH message, and establish a subscription.<a href="#section-8.14-1" class="pilcrow">¶</a></p>
<span id="name-moqt-publish_ok-message"></span><div id="moq-transport-publish-ok">
<figure id="figure-16">
          <div class="alignLeft art-text artwork" id="section-8.14-2.1">
<pre>
PUBLISH_OK Message {
  Type (i) = 0x1E,
  Length (i),
  Request ID (i),
  Forward (8),
  Subscriber Priority (8),
  Group Order (8),
  Filter Type (i),
  [Start Location (Location)],
  [End Group (i)],
  Number of Parameters (i),
  Parameters (..) ...,
}
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-moqt-publish_ok-message" class="selfRef">MOQT PUBLISH_OK Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.14-3.1">
            <p id="section-8.14-3.1.1">Request ID: The Request ID of the PUBLISH this message is replying to
<a href="#message-publish" class="auto internal xref">Section 8.13</a>.<a href="#section-8.14-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.14-3.2">
            <p id="section-8.14-3.2.1">Forward: The Forward State for this subscription, either 0 (don't
forward) or 1 (forward).<a href="#section-8.14-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.14-3.3">
            <p id="section-8.14-3.3.1">Subscriber Priority: The Subscriber Priority for this subscription.<a href="#section-8.14-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.14-3.4">
            <p id="section-8.14-3.4.1">Group Order: Indicates the subscription will be delivered in
Ascending (0x1) or Descending (0x2) order by group. See <a href="#priorities" class="auto internal xref">Section 6</a>.
Values of 0x0 and those larger than 0x2 are a protocol error. This
overwrites the GroupOrder specified PUBLISH.<a href="#section-8.14-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.14-3.5">
            <p id="section-8.14-3.5.1">Filter Type, Start Location, End Group: See <a href="#message-subscribe-req" class="auto internal xref">Section 8.7</a>.<a href="#section-8.14-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.14-3.6">
            <p id="section-8.14-3.6.1">Parameters: Parameters associated with this message.<a href="#section-8.14-3.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-publish-error">
<section id="section-8.15">
        <h3 id="name-publish_error">
<a href="#section-8.15" class="section-number selfRef">8.15. </a><a href="#name-publish_error" class="section-name selfRef">PUBLISH_ERROR</a>
        </h3>
<p id="section-8.15-1">The subscriber sends an PUBLISH_ERROR control message to reject
a subscription initiated by PUBLISH.<a href="#section-8.15-1" class="pilcrow">¶</a></p>
<span id="name-moqt-publish_error-message"></span><div id="moq-transport-publish-error">
<figure id="figure-17">
          <div class="alignLeft art-text artwork" id="section-8.15-2.1">
<pre>
PUBLISH_ERROR Message {
  Type (i) = 0x1F,
  Length (i),
  Request ID (i),
  Error Code (i),
  Error Reason (Reason Phrase),
}
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-moqt-publish_error-message" class="selfRef">MOQT PUBLISH_ERROR Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.15-3.1">
            <p id="section-8.15-3.1.1">Request ID: The Request ID of the PUBLISH this message is replying to
<a href="#message-publish" class="auto internal xref">Section 8.13</a>.<a href="#section-8.15-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.15-3.2">
            <p id="section-8.15-3.2.1">Error Code: Identifies an integer error code for failure.<a href="#section-8.15-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.15-3.3">
            <p id="section-8.15-3.3.1">Error Reason: Provides the reason for subscription error. See <a href="#reason-phrase" class="auto internal xref">Section 1.3.3</a>.<a href="#section-8.15-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.15-4">The application <span class="bcp14">SHOULD</span> use a relevant error code in PUBLISH_ERROR, as defined
below:<a href="#section-8.15-4" class="pilcrow">¶</a></p>
<table class="center" id="table-6">
          <caption><a href="#table-6" class="selfRef">Table 6</a></caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Code</th>
              <th class="text-left" rowspan="1" colspan="1">Reason</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">Internal Error</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x1</td>
              <td class="text-left" rowspan="1" colspan="1">Unauthorized</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x2</td>
              <td class="text-left" rowspan="1" colspan="1">Timeout</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x3</td>
              <td class="text-left" rowspan="1" colspan="1">Not Supported</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x4</td>
              <td class="text-left" rowspan="1" colspan="1">Uninterested</td>
            </tr>
          </tbody>
        </table>
<ul class="normal">
<li class="normal" id="section-8.15-6.1">
            <p id="section-8.15-6.1.1">Internal Error - An implementation specific or generic error occurred.<a href="#section-8.15-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.15-6.2">
            <p id="section-8.15-6.2.1">Unauthorized - The publisher is not authorized to publish the given
namespace or track.<a href="#section-8.15-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.15-6.3">
            <p id="section-8.15-6.3.1">Timeout - The subscription could not be established before an
implementation specific timeout.<a href="#section-8.15-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.15-6.4">
            <p id="section-8.15-6.4.1">Not Supported - The endpoint does not support the PUBLISH method.<a href="#section-8.15-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.15-6.5">
            <p id="section-8.15-6.5.1">Uninterested - The namespace or track is not of interest to the
endpoint.<a href="#section-8.15-6.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-fetch">
<section id="section-8.16">
        <h3 id="name-fetch">
<a href="#section-8.16" class="section-number selfRef">8.16. </a><a href="#name-fetch" class="section-name selfRef">FETCH</a>
        </h3>
<p id="section-8.16-1">A subscriber issues a FETCH to a publisher to request a range of already
published objects within a track. The publisher responding to a FETCH is
responsible for delivering all available Objects in the requested range in the
requested order. The Objects in the response are delivered on a single
unidirectional stream. Any gaps in the Group and Object IDs in the response
stream indicate objects that do not exist (eg: they implicitly have status
<code>Object Does Not Exist</code>).  For Ascending Group Order this includes ranges
between the first requested object and the first object in the stream; between
objects in the stream; and between the last object in the stream and the Largest
Group/Object indicated in FETCH_OK, so long as the fetch stream is terminated by
a FIN.  If no Objects exist in the requested range, the publisher returns
FETCH_ERROR with code <code>No Objects</code>.<a href="#section-8.16-1" class="pilcrow">¶</a></p>
<p id="section-8.16-2">If an Original Publisher receives a FETCH with a range that includes an object with
unknown status, it <span class="bcp14">MUST</span> return FETCH_ERROR with code Unknown Status in Range.<a href="#section-8.16-2" class="pilcrow">¶</a></p>
<p id="section-8.16-3"><strong>Fetch Types</strong><a href="#section-8.16-3" class="pilcrow">¶</a></p>
<p id="section-8.16-4">There are three types of Fetch messages:<a href="#section-8.16-4" class="pilcrow">¶</a></p>
<p id="section-8.16-5">Standalone Fetch (0x1) : A Fetch of Objects performed independently of any Subscribe.<a href="#section-8.16-5" class="pilcrow">¶</a></p>
<p id="section-8.16-6">Relative Joining Fetch (0x2) : A Fetch joined together with a Subscribe by
specifying the Request ID of an active subscription and a relative starting
offset. A publisher receiving a Joining Fetch uses properties of the associated
Subscribe to determine the Track Namespace, Track, Start Location,
and End Location such that it is contiguous with the associated
Subscribe. The Joining Fetch begins the Preceding Group Offset prior to the
associated subscription.<a href="#section-8.16-6" class="pilcrow">¶</a></p>
<p id="section-8.16-7">Absolute Joining Fetch (0x3) : Identical to a Relative Joining Fetch except that the
Start Group is determined by an absolute Group value rather than a relative offset to
the subscription.<a href="#section-8.16-7" class="pilcrow">¶</a></p>
<p id="section-8.16-8">A Subscriber can use a Joining Fetch to, for example, fill a playback buffer with a
certain number of groups prior to the live edge of a track.<a href="#section-8.16-8" class="pilcrow">¶</a></p>
<p id="section-8.16-9">A Joining Fetch is only permitted when the associated Subscribe has the Filter
Type Largest Object.<a href="#section-8.16-9" class="pilcrow">¶</a></p>
<p id="section-8.16-10">A Fetch Type other than 0x1, 0x2 or 0x3 <span class="bcp14">MUST</span> be treated as an error.<a href="#section-8.16-10" class="pilcrow">¶</a></p>
<p id="section-8.16-11">A publisher responds to a FETCH request with either a FETCH_OK or a FETCH_ERROR
message.  The publisher creates a new unidirectional stream that is used to send the
Objects.  The FETCH_OK or FETCH_ERROR can come at any time relative to object
delivery.<a href="#section-8.16-11" class="pilcrow">¶</a></p>
<p id="section-8.16-12">A relay that has cached objects from the beginning of the range <span class="bcp14">MAY</span> start
sending objects immediately in response to a FETCH.  If it encounters an object
in the requested range that is not cached and has unknown status, the relay <span class="bcp14">MUST</span>
pause subsequent delivery until it has confirmed the object's status upstream.
If the upstream FETCH fails, the relay sends a FETCH_ERROR and can reset the
unidirectional stream.  It can choose to do so immediately or wait until the
cached objects have been delivered before resetting the stream.<a href="#section-8.16-12" class="pilcrow">¶</a></p>
<p id="section-8.16-13">The Object Forwarding Preference does not apply to fetches.<a href="#section-8.16-13" class="pilcrow">¶</a></p>
<p id="section-8.16-14">Fetch specifies an inclusive range of Objects starting at Start Location and
ending at End Location. End Location <span class="bcp14">MUST</span> specify the same or a larger Location
than Start Location.<a href="#section-8.16-14" class="pilcrow">¶</a></p>
<p id="section-8.16-15">The format of FETCH is as follows:<a href="#section-8.16-15" class="pilcrow">¶</a></p>
<span id="name-moqt-fetch-message"></span><div id="moq-transport-fetch-format">
<figure id="figure-18">
          <div class="alignLeft art-text artwork" id="section-8.16-16.1">
<pre>
FETCH Message {
  Type (i) = 0x16,
  Length (16),
  Request ID (i),
  Subscriber Priority (8),
  Group Order (8),
  Fetch Type (i),
  [Track Namespace (tuple),
   Track Name Length (i),
   Track Name (..),
   Start Location (Location),
   End Location (Location),]
  [Joining Request ID (i),
   Joining Start (i),]
  Number of Parameters (i),
  Parameters (..) ...
}
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-moqt-fetch-message" class="selfRef">MOQT FETCH Message</a>
          </figcaption></figure>
</div>
<p id="section-8.16-17">Fields common to all Fetch Types:<a href="#section-8.16-17" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.16-18.1">
            <p id="section-8.16-18.1.1">Request ID: See <a href="#request-id" class="auto internal xref">Section 8.1</a>.<a href="#section-8.16-18.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.16-18.2">
            <p id="section-8.16-18.2.1">Subscriber Priority: Specifies the priority of a fetch request relative to
other subscriptions or fetches in the same session. Lower numbers get higher
priority. See <a href="#priorities" class="auto internal xref">Section 6</a>.<a href="#section-8.16-18.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.16-18.3">
            <p id="section-8.16-18.3.1">Group Order: Allows the subscriber to request Objects be delivered in
Ascending (0x1) or Descending (0x2) order by group. See <a href="#priorities" class="auto internal xref">Section 6</a>.
A value of 0x0 indicates the original publisher's Group Order <span class="bcp14">SHOULD</span> be
used. Values larger than 0x2 are a protocol error.<a href="#section-8.16-18.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.16-18.4">
            <p id="section-8.16-18.4.1">Fetch Type: Identifies the type of Fetch, whether Standalone, Relative
Joining or Absolute Joining.<a href="#section-8.16-18.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.16-18.5">
            <p id="section-8.16-18.5.1">Parameters: The parameters are defined in <a href="#version-specific-params" class="auto internal xref">Section 8.2.1</a>.<a href="#section-8.16-18.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.16-19">Fields present only for Standalone Fetch (0x1):<a href="#section-8.16-19" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.16-20.1">
            <p id="section-8.16-20.1.1">Track Namespace: Identifies the namespace of the track as defined in
(<a href="#track-name" class="auto internal xref">Section 2.4.1</a>).<a href="#section-8.16-20.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.16-20.2">
            <p id="section-8.16-20.2.1">Track Name: Identifies the track name as defined in (<a href="#track-name" class="auto internal xref">Section 2.4.1</a>).<a href="#section-8.16-20.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.16-20.3">
            <p id="section-8.16-20.3.1">Start Location: The start Location.<a href="#section-8.16-20.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.16-20.4">
            <p id="section-8.16-20.4.1">End Location: The end Location, plus 1 Object ID. An Object ID value of 0
means the entire group is requested.<a href="#section-8.16-20.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.16-21">Fields present only for Relative Fetch (0x2) and Absolute Fetch (0x3):<a href="#section-8.16-21" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.16-22.1">
            <p id="section-8.16-22.1.1">Joining Request ID: The Request ID of the existing subscription to be
joined. If a publisher receives a Joining Fetch with a Request ID that does
not correspond to an existing Subscribe in the same session, it <span class="bcp14">MUST</span> respond
with a Fetch Error with code Invalid Joining Request ID.<a href="#section-8.16-22.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.16-22.2">
            <p id="section-8.16-22.2.1">Joining Start : for a Relative Joining Fetch (0x2), this value represents the
group offset for the Fetch prior and relative to the Current Group of the
corresponding Subscribe. A value of 0 indicates the Fetch starts at the beginning
of the Current Group. For an Absolute Joining Fetch (0x3), this value represents
the Starting Group ID.<a href="#section-8.16-22.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.16-23">Objects that are not yet published will not be retrieved by a FETCH.  The
Largest available Object in the requested range is indicated in the FETCH_OK,
and is the last Object a fetch will return if the End Location have not yet been
published.<a href="#section-8.16-23" class="pilcrow">¶</a></p>
<p id="section-8.16-24">A publisher <span class="bcp14">MUST</span> send fetched groups in the determined group order, either
ascending or descending. Within each group, objects are sent in Object ID order;
subgroup ID is not used for ordering.<a href="#section-8.16-24" class="pilcrow">¶</a></p>
<p id="section-8.16-25">If Start Location is greater than the <code>Largest Object</code>
(<a href="#message-subscribe-req" class="auto internal xref">Section 8.7</a>) the publisher <span class="bcp14">MUST</span> return FETCH_ERROR with error
code 'Invalid Range'.<a href="#section-8.16-25" class="pilcrow">¶</a></p>
<div id="calculating-the-range-of-a-relative-joining-fetch">
<section id="section-8.16.1">
          <h4 id="name-calculating-the-range-of-a-">
<a href="#section-8.16.1" class="section-number selfRef">8.16.1. </a><a href="#name-calculating-the-range-of-a-" class="section-name selfRef">Calculating the Range of a Relative Joining Fetch</a>
          </h4>
<p id="section-8.16.1-1">A publisher that receives a Fetch of type Type 0x2 treats it
as a Fetch with a range dynamically determined by the Preceding Group Offset
and field values derived from the corresponding subscription.<a href="#section-8.16.1-1" class="pilcrow">¶</a></p>
<p id="section-8.16.1-2">The Largest Location value from the corresponding
subscription is used to calculate the end of a Relative Joining Fetch so the
Objects retrieved by the FETCH and SUBSCRIBE are contiguous and non-overlapping.
If no Objects have been published for the track, and the SUBSCRIBE_OK has a
Content Exists value of 0, the publisher <span class="bcp14">MUST</span> respond with a FETCH_ERROR with
error code 'Invalid Range'.<a href="#section-8.16.1-2" class="pilcrow">¶</a></p>
<p id="section-8.16.1-3">The publisher receiving a Relative Joining Fetch computes the range as follows:<a href="#section-8.16.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.16.1-4.1">
              <p id="section-8.16.1-4.1.1">Fetch Start Location: {Subscribe Largest Location.Group - Joining Start, 0}<a href="#section-8.16.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.16.1-4.2">
              <p id="section-8.16.1-4.2.1">Fetch End Location: Subscribe Largest Location<a href="#section-8.16.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-8.16.1-5">A Fetch End Location.Object of 0 requests the entire group, but Fetch will not
retrieve Objects that have not yet been published, so 1 is subtracted from
the Fetch End Location.Group if Fetch End Location.Object is 0.<a href="#section-8.16.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="calculating-the-range-of-an-absolute-joining-fetch">
<section id="section-8.16.2">
          <h4 id="name-calculating-the-range-of-an">
<a href="#section-8.16.2" class="section-number selfRef">8.16.2. </a><a href="#name-calculating-the-range-of-an" class="section-name selfRef">Calculating the Range of an Absolute Joining Fetch</a>
          </h4>
<p id="section-8.16.2-1">Identical to the Relative Joining fetch except that Fetch Start Location.Group
is the Joining Start value.<a href="#section-8.16.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="message-fetch-ok">
<section id="section-8.17">
        <h3 id="name-fetch_ok">
<a href="#section-8.17" class="section-number selfRef">8.17. </a><a href="#name-fetch_ok" class="section-name selfRef">FETCH_OK</a>
        </h3>
<p id="section-8.17-1">A publisher sends a FETCH_OK control message in response to successful fetches.
A publisher <span class="bcp14">MAY</span> send Objects in response to a FETCH before the FETCH_OK message is sent,
but the FETCH_OK <span class="bcp14">MUST NOT</span> be sent until the End Location is known.<a href="#section-8.17-1" class="pilcrow">¶</a></p>
<span id="name-moqt-fetch_ok-message"></span><div id="moq-transport-fetch-ok">
<figure id="figure-19">
          <div class="alignLeft art-text artwork" id="section-8.17-2.1">
<pre>
FETCH_OK Message {
  Type (i) = 0x18,
  Length (16),
  Request ID (i),
  Group Order (8),
  End Of Track (8),
  End Location (Location),
  Number of Parameters (i),
  Subscribe Parameters (..) ...
}
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-moqt-fetch_ok-message" class="selfRef">MOQT FETCH_OK Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.17-3.1">
            <p id="section-8.17-3.1.1">Request ID: The Request ID of the FETCH this message is replying to
<a href="#message-subscribe-req" class="auto internal xref">Section 8.7</a>.<a href="#section-8.17-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.17-3.2">
            <p id="section-8.17-3.2.1">Group Order: Indicates the fetch will be delivered in
Ascending (0x1) or Descending (0x2) order by group. See <a href="#priorities" class="auto internal xref">Section 6</a>.
Values of 0x0 and those larger than 0x2 are a protocol error.<a href="#section-8.17-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.17-3.3">
            <p id="section-8.17-3.3.1">End Of Track: 1 if all Objects have been published on this Track, and
the End Location is the final Object in the Track, 0 if not.<a href="#section-8.17-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.17-3.4">
            <p id="section-8.17-3.4.1">End Location: The largest object covered by the FETCH response.
The End Location is determined as follows:<a href="#section-8.17-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.17-3.4.2.1">
                <p id="section-8.17-3.4.2.1.1">If the requested FETCH End Location was beyond the Largest known (possibly
final) Object, End Location is {Largest.Group, Largest.Object + 1}<a href="#section-8.17-3.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.17-3.4.2.2">
                <p id="section-8.17-3.4.2.2.1">If End Location.Object in the FETCH request was 0 and the response covers
the last Object in the Group, End Location is {Fetch.End Location.Group, 0}<a href="#section-8.17-3.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.17-3.4.2.3">
                <p id="section-8.17-3.4.2.3.1">Otherwise, End Location is Fetch.End Location<a href="#section-8.17-3.4.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-8.17-3.4.3">
If the relay is subscribed to the track, it uses its knowledge of the largest
{Group, Object} to set End Location.  If if is not subscribed and the
requested End Location exceeds its cached data, the relay makes an upstream
request to complete the FETCH, and uses the upstream response to set End
Location.<a href="#section-8.17-3.4.3" class="pilcrow">¶</a></p>
<p id="section-8.17-3.4.4">
If End is smaller than the Start Location in the corresponding FETCH the
receiver <span class="bcp14">MUST</span> close the session with <code>Protocol Violation</code><a href="#section-8.17-3.4.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.17-3.5">
            <p id="section-8.17-3.5.1">Subscribe Parameters: The parameters are defined in <a href="#version-specific-params" class="auto internal xref">Section 8.2.1</a>.<a href="#section-8.17-3.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-fetch-error">
<section id="section-8.18">
        <h3 id="name-fetch_error">
<a href="#section-8.18" class="section-number selfRef">8.18. </a><a href="#name-fetch_error" class="section-name selfRef">FETCH_ERROR</a>
        </h3>
<p id="section-8.18-1">A publisher sends a FETCH_ERROR control message in response to a
failed FETCH.<a href="#section-8.18-1" class="pilcrow">¶</a></p>
<span id="name-moqt-fetch_error-message"></span><div id="moq-transport-fetch-error">
<figure id="figure-20">
          <div class="alignLeft art-text artwork" id="section-8.18-2.1">
<pre>
FETCH_ERROR Message {
  Type (i) = 0x19,
  Length (16),
  Request ID (i),
  Error Code (i),
  Error Reason (Reason Phrase)
}
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-moqt-fetch_error-message" class="selfRef">MOQT FETCH_ERROR Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.18-3.1">
            <p id="section-8.18-3.1.1">Request ID: The Request ID of the FETCH this message is replying to
<a href="#message-subscribe-req" class="auto internal xref">Section 8.7</a>.<a href="#section-8.18-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.18-3.2">
            <p id="section-8.18-3.2.1">Error Code: Identifies an integer error code for fetch failure.<a href="#section-8.18-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.18-3.3">
            <p id="section-8.18-3.3.1">Error Reason: Provides the reason for fetch error. See <a href="#reason-phrase" class="auto internal xref">Section 1.3.3</a>.<a href="#section-8.18-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.18-4">The application <span class="bcp14">SHOULD</span> use a relevant error code in FETCH_ERROR,
as defined below:<a href="#section-8.18-4" class="pilcrow">¶</a></p>
<table class="center" id="table-7">
          <caption><a href="#table-7" class="selfRef">Table 7</a></caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Code</th>
              <th class="text-left" rowspan="1" colspan="1">Reason</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">Internal Error</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x1</td>
              <td class="text-left" rowspan="1" colspan="1">Unauthorized</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x2</td>
              <td class="text-left" rowspan="1" colspan="1">Timeout</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x3</td>
              <td class="text-left" rowspan="1" colspan="1">Not Supported</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x4</td>
              <td class="text-left" rowspan="1" colspan="1">Track Does Not Exist</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x5</td>
              <td class="text-left" rowspan="1" colspan="1">Invalid Range</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x6</td>
              <td class="text-left" rowspan="1" colspan="1">No Objects</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x7</td>
              <td class="text-left" rowspan="1" colspan="1">Invalid Joining Request ID</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x8</td>
              <td class="text-left" rowspan="1" colspan="1">Unknown Status in Range</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x9</td>
              <td class="text-left" rowspan="1" colspan="1">Malformed Track</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x10</td>
              <td class="text-left" rowspan="1" colspan="1">Malformed Auth Token</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x12</td>
              <td class="text-left" rowspan="1" colspan="1">Expired Auth Token</td>
            </tr>
          </tbody>
        </table>
<ul class="normal">
<li class="normal" id="section-8.18-6.1">
            <p id="section-8.18-6.1.1">Internal Error - An implementation specific or generic error occurred.<a href="#section-8.18-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.18-6.2">
            <p id="section-8.18-6.2.1">Unauthorized - The subscriber is not authorized to fetch from the given
track.<a href="#section-8.18-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.18-6.3">
            <p id="section-8.18-6.3.1">Timeout - The fetch could not be completed before an implementation
specific timeout.  For example, a relay could not FETCH missing objects
within the timeout.<a href="#section-8.18-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.18-6.4">
            <p id="section-8.18-6.4.1">Not supported - The endpoint does not support the FETCH method.<a href="#section-8.18-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.18-6.5">
            <p id="section-8.18-6.5.1">Track Does Not Exist - The requested track is not available at the publisher.<a href="#section-8.18-6.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.18-6.6">
            <p id="section-8.18-6.6.1">Invalid Range - The end of the requested range is earlier than the beginning,
the start of the requested range is beyond the Largest Location, or the track
has not published any Objects yet.<a href="#section-8.18-6.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.18-6.7">
            <p id="section-8.18-6.7.1">No Objects - No Objects exist between the requested Start and End Locations.<a href="#section-8.18-6.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.18-6.8">
            <p id="section-8.18-6.8.1">Invalid Joining Request ID - The joining Fetch referenced a Request ID that
did not belong to an active Subscription.<a href="#section-8.18-6.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.18-6.9">
            <p id="section-8.18-6.9.1">Unknown Status in Range - The requested range contains objects with unknown
status.<a href="#section-8.18-6.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.18-6.10">
            <p id="section-8.18-6.10.1">Malformed Track - A relay publisher detected the track was malformed (see
<a href="#malformed-tracks" class="auto internal xref">Section 2.5</a>).<a href="#section-8.18-6.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.18-6.11">
            <p id="section-8.18-6.11.1">Malformed Auth Token - Invalid Auth Token serialization during registration
(see <a href="#authorization-token" class="auto internal xref">Section 8.2.1.1</a>).<a href="#section-8.18-6.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.18-6.12">
            <p id="section-8.18-6.12.1">Expired Auth Token - Authorization token has expired <a href="#authorization-token" class="auto internal xref">Section 8.2.1.1</a>).<a href="#section-8.18-6.12.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-fetch-cancel">
<section id="section-8.19">
        <h3 id="name-fetch_cancel">
<a href="#section-8.19" class="section-number selfRef">8.19. </a><a href="#name-fetch_cancel" class="section-name selfRef">FETCH_CANCEL</a>
        </h3>
<p id="section-8.19-1">A subscriber sends a FETCH_CANCEL message to a publisher to indicate it is no
longer interested in receiving objects for the fetch identified by the 'Request
ID'. The publisher <span class="bcp14">SHOULD</span> promptly close the unidirectional stream, even if it
is in the middle of delivering an object.<a href="#section-8.19-1" class="pilcrow">¶</a></p>
<p id="section-8.19-2">The format of <code>FETCH_CANCEL</code> is as follows:<a href="#section-8.19-2" class="pilcrow">¶</a></p>
<span id="name-moqt-fetch_cancel-message"></span><div id="moq-transport-fetch-cancel">
<figure id="figure-21">
          <div class="alignLeft art-text artwork" id="section-8.19-3.1">
<pre>
FETCH_CANCEL Message {
  Type (i) = 0x17,
  Length (16),
  Request ID (i)
}
</pre>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a>:
<a href="#name-moqt-fetch_cancel-message" class="selfRef">MOQT FETCH_CANCEL Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.19-4.1">
            <p id="section-8.19-4.1.1">Request ID: The Request ID of the FETCH (<a href="#message-fetch" class="auto internal xref">Section 8.16</a>) this message is
cancelling.<a href="#section-8.19-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-track-status">
<section id="section-8.20">
        <h3 id="name-track_status">
<a href="#section-8.20" class="section-number selfRef">8.20. </a><a href="#name-track_status" class="section-name selfRef">TRACK_STATUS</a>
        </h3>
<p id="section-8.20-1">A potential subscriber sends a 'TRACK_STATUS' message on the control
stream to obtain information about the current status of a given track.<a href="#section-8.20-1" class="pilcrow">¶</a></p>
<p id="section-8.20-2">The TRACK_STATUS message format is identical to the SUBSCRIBE message
(<a href="#message-subscribe-req" class="auto internal xref">Section 8.7</a>).<a href="#section-8.20-2" class="pilcrow">¶</a></p>
<p id="section-8.20-3">The receiver of a TRACK_STATUS message treats it identically as if it had
received a SUBSCRIBE message, except it does not create downstream subscription
state or send any Objects.  Relays without an active subscription <span class="bcp14">MAY</span> forward
TRACK_STATUS to one or more publishers, or <span class="bcp14">MAY</span> initiate a subscription (subject
to authorization) as described in <a href="#publisher-interactions" class="auto internal xref">Section 7.3</a> to determine the
response. The publisher does not send SUBSCRIBE_DONE for this request, and the
subscriber cannot send SUBSCRIBE_UPDATE or UNSUBSCRIBE.<a href="#section-8.20-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-track-status-ok">
<section id="section-8.21">
        <h3 id="name-track_status_ok">
<a href="#section-8.21" class="section-number selfRef">8.21. </a><a href="#name-track_status_ok" class="section-name selfRef">TRACK_STATUS_OK</a>
        </h3>
<p id="section-8.21-1">The publisher sends a TRACK_STATUS_OK control message in response
to a successful TRACK_STATUS message.<a href="#section-8.21-1" class="pilcrow">¶</a></p>
<p id="section-8.21-2">The TRACK_STATUS_OK message format is identical to the SUBSCRIBE_OK message
(<a href="#message-subscribe-ok" class="auto internal xref">Section 8.8</a>).<a href="#section-8.21-2" class="pilcrow">¶</a></p>
<p id="section-8.21-3">The publisher populates the fields of TRACK_STATUS_OK exactly as it would have
populated a SUBSCRIBE_OK, setting Track Alias to 0. It is not considered an error
if Track Alias 0 is already in use by an active subscription.<a href="#section-8.21-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-track-status-error">
<section id="section-8.22">
        <h3 id="name-track_status_error">
<a href="#section-8.22" class="section-number selfRef">8.22. </a><a href="#name-track_status_error" class="section-name selfRef">TRACK_STATUS_ERROR</a>
        </h3>
<p id="section-8.22-1">The publisher sends a TRACK_STATUS_ERROR control message in response
to a failed TRACK_STATUS message.<a href="#section-8.22-1" class="pilcrow">¶</a></p>
<p id="section-8.22-2">The TRACK_STATUS_ERROR message format is identical to the SUBSCRIBE_ERROR
message (<a href="#message-subscribe-error" class="auto internal xref">Section 8.9</a>).<a href="#section-8.22-2" class="pilcrow">¶</a></p>
<p id="section-8.22-3">The publisher populates the fields of TRACK_STATUS_ERROR exactly as it would
have populated a SUBSCRIBE_ERROR.<a href="#section-8.22-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-announce">
<section id="section-8.23">
        <h3 id="name-announce">
<a href="#section-8.23" class="section-number selfRef">8.23. </a><a href="#name-announce" class="section-name selfRef">ANNOUNCE</a>
        </h3>
<p id="section-8.23-1">The publisher sends the ANNOUNCE control message to advertise that it has
tracks available within the announced Track Namespace. The receiver verifies the
publisher is authorized to publish tracks under this namespace.<a href="#section-8.23-1" class="pilcrow">¶</a></p>
<span id="name-moqt-announce-message"></span><div id="moq-transport-announce-format">
<figure id="figure-22">
          <div class="alignLeft art-text artwork" id="section-8.23-2.1">
<pre>
ANNOUNCE Message {
  Type (i) = 0x6,
  Length (16),
  Request ID (i),
  Track Namespace (tuple),
  Number of Parameters (i),
  Parameters (..) ...,
}
</pre>
</div>
<figcaption><a href="#figure-22" class="selfRef">Figure 22</a>:
<a href="#name-moqt-announce-message" class="selfRef">MOQT ANNOUNCE Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.23-3.1">
            <p id="section-8.23-3.1.1">Request ID: See <a href="#request-id" class="auto internal xref">Section 8.1</a>.<a href="#section-8.23-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.23-3.2">
            <p id="section-8.23-3.2.1">Track Namespace: Identifies a track's namespace as defined in
(<a href="#track-name" class="auto internal xref">Section 2.4.1</a>)<a href="#section-8.23-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.23-3.3">
            <p id="section-8.23-3.3.1">Parameters: The parameters are defined in <a href="#version-specific-params" class="auto internal xref">Section 8.2.1</a>.<a href="#section-8.23-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-announce-ok">
<section id="section-8.24">
        <h3 id="name-announce_ok">
<a href="#section-8.24" class="section-number selfRef">8.24. </a><a href="#name-announce_ok" class="section-name selfRef">ANNOUNCE_OK</a>
        </h3>
<p id="section-8.24-1">The subscriber sends an ANNOUNCE_OK control message to acknowledge the
successful authorization and acceptance of an ANNOUNCE message.<a href="#section-8.24-1" class="pilcrow">¶</a></p>
<span id="name-moqt-announce_ok-message"></span><div id="moq-transport-announce-ok">
<figure id="figure-23">
          <div class="alignLeft art-text artwork" id="section-8.24-2.1">
<pre>
ANNOUNCE_OK Message {
  Type (i) = 0x7,
  Length (16),
  Request ID (i)
}
</pre>
</div>
<figcaption><a href="#figure-23" class="selfRef">Figure 23</a>:
<a href="#name-moqt-announce_ok-message" class="selfRef">MOQT ANNOUNCE_OK Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.24-3.1">
            <p id="section-8.24-3.1.1">Request ID: The Request ID of the ANNOUNCE this message is replying to
<a href="#message-announce" class="auto internal xref">Section 8.23</a>.<a href="#section-8.24-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-announce-error">
<section id="section-8.25">
        <h3 id="name-announce_error">
<a href="#section-8.25" class="section-number selfRef">8.25. </a><a href="#name-announce_error" class="section-name selfRef">ANNOUNCE_ERROR</a>
        </h3>
<p id="section-8.25-1">The subscriber sends an ANNOUNCE_ERROR control message for tracks that
failed authorization.<a href="#section-8.25-1" class="pilcrow">¶</a></p>
<span id="name-moqt-announce_error-message"></span><div id="moq-transport-announce-error">
<figure id="figure-24">
          <div class="alignLeft art-text artwork" id="section-8.25-2.1">
<pre>
ANNOUNCE_ERROR Message {
  Type (i) = 0x8,
  Length (16),
  Request ID (i),
  Error Code (i),
  Error Reason (Reason Phrase)
}
</pre>
</div>
<figcaption><a href="#figure-24" class="selfRef">Figure 24</a>:
<a href="#name-moqt-announce_error-message" class="selfRef">MOQT ANNOUNCE_ERROR Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.25-3.1">
            <p id="section-8.25-3.1.1">Request ID: The Request ID of the ANNOUNCE this message is replying to
<a href="#message-announce" class="auto internal xref">Section 8.23</a>.<a href="#section-8.25-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.25-3.2">
            <p id="section-8.25-3.2.1">Error Code: Identifies an integer error code for announcement failure.<a href="#section-8.25-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.25-3.3">
            <p id="section-8.25-3.3.1">Error Reason: Provides the reason for announcement error. See <a href="#reason-phrase" class="auto internal xref">Section 1.3.3</a>.<a href="#section-8.25-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.25-4">The application <span class="bcp14">SHOULD</span> use a relevant error code in ANNOUNCE_ERROR, as defined
below:<a href="#section-8.25-4" class="pilcrow">¶</a></p>
<table class="center" id="table-8">
          <caption><a href="#table-8" class="selfRef">Table 8</a></caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Code</th>
              <th class="text-left" rowspan="1" colspan="1">Reason</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">Internal Error</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x1</td>
              <td class="text-left" rowspan="1" colspan="1">Unauthorized</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x2</td>
              <td class="text-left" rowspan="1" colspan="1">Timeout</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x3</td>
              <td class="text-left" rowspan="1" colspan="1">Not Supported</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x4</td>
              <td class="text-left" rowspan="1" colspan="1">Uninterested</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x10</td>
              <td class="text-left" rowspan="1" colspan="1">Malformed Auth Token</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x12</td>
              <td class="text-left" rowspan="1" colspan="1">Expired Auth Token</td>
            </tr>
          </tbody>
        </table>
<ul class="normal">
<li class="normal" id="section-8.25-6.1">
            <p id="section-8.25-6.1.1">Internal Error - An implementation specific or generic error occurred.<a href="#section-8.25-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.25-6.2">
            <p id="section-8.25-6.2.1">Unauthorized - The subscriber is not authorized to announce the given
namespace.<a href="#section-8.25-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.25-6.3">
            <p id="section-8.25-6.3.1">Timeout - The announce could not be completed before an implementation
specific timeout.<a href="#section-8.25-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.25-6.4">
            <p id="section-8.25-6.4.1">Not Supported - The endpoint does not support the ANNOUNCE method.<a href="#section-8.25-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.25-6.5">
            <p id="section-8.25-6.5.1">Uninterested - The namespace is not of interest to the endpoint.<a href="#section-8.25-6.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.25-6.6">
            <p id="section-8.25-6.6.1">Malformed Auth Token - Invalid Auth Token serialization during registration
(see <a href="#authorization-token" class="auto internal xref">Section 8.2.1.1</a>).<a href="#section-8.25-6.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.25-6.7">
            <p id="section-8.25-6.7.1">Expired Auth Token - Authorization token has expired <a href="#authorization-token" class="auto internal xref">Section 8.2.1.1</a>).<a href="#section-8.25-6.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-unannounce">
<section id="section-8.26">
        <h3 id="name-unannounce">
<a href="#section-8.26" class="section-number selfRef">8.26. </a><a href="#name-unannounce" class="section-name selfRef">UNANNOUNCE</a>
        </h3>
<p id="section-8.26-1">The publisher sends the <code>UNANNOUNCE</code> control message to indicate
its intent to stop serving new subscriptions for tracks
within the provided Track Namespace.<a href="#section-8.26-1" class="pilcrow">¶</a></p>
<span id="name-moqt-unannounce-message"></span><div id="moq-transport-unannounce-format">
<figure id="figure-25">
          <div class="alignLeft art-text artwork" id="section-8.26-2.1">
<pre>
UNANNOUNCE Message {
  Type (i) = 0x9,
  Length (16),
  Track Namespace (tuple),
}
</pre>
</div>
<figcaption><a href="#figure-25" class="selfRef">Figure 25</a>:
<a href="#name-moqt-unannounce-message" class="selfRef">MOQT UNANNOUNCE Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.26-3.1">
            <p id="section-8.26-3.1.1">Track Namespace: Identifies a track's namespace as defined in
(<a href="#track-name" class="auto internal xref">Section 2.4.1</a>).<a href="#section-8.26-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-announce-cancel">
<section id="section-8.27">
        <h3 id="name-announce_cancel">
<a href="#section-8.27" class="section-number selfRef">8.27. </a><a href="#name-announce_cancel" class="section-name selfRef">ANNOUNCE_CANCEL</a>
        </h3>
<p id="section-8.27-1">The subscriber sends an <code>ANNOUNCE_CANCEL</code> control message to
indicate it will stop sending new subscriptions for tracks
within the provided Track Namespace.<a href="#section-8.27-1" class="pilcrow">¶</a></p>
<span id="name-moqt-announce_cancel-messag"></span><div id="moq-transport-announce-cancel-format">
<figure id="figure-26">
          <div class="alignLeft art-text artwork" id="section-8.27-2.1">
<pre>
ANNOUNCE_CANCEL Message {
  Type (i) = 0xC,
  Length (16),
  Track Namespace (tuple),
  Error Code (i),
  Error Reason (Reason Phrase),
}
</pre>
</div>
<figcaption><a href="#figure-26" class="selfRef">Figure 26</a>:
<a href="#name-moqt-announce_cancel-messag" class="selfRef">MOQT ANNOUNCE_CANCEL Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.27-3.1">
            <p id="section-8.27-3.1.1">Track Namespace: Identifies a track's namespace as defined in
(<a href="#track-name" class="auto internal xref">Section 2.4.1</a>).<a href="#section-8.27-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.27-3.2">
            <p id="section-8.27-3.2.1">Error Code: Identifies an integer error code for canceling the announcement.
ANNOUNCE_CANCEL uses the same error codes as ANNOUNCE_ERROR
(<a href="#message-announce-error" class="auto internal xref">Section 8.25</a>).<a href="#section-8.27-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.27-3.3">
            <p id="section-8.27-3.3.1">Error Reason: Provides the reason for announcement cancelation. See <a href="#reason-phrase" class="auto internal xref">Section 1.3.3</a>.<a href="#section-8.27-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-subscribe-ns">
<section id="section-8.28">
        <h3 id="name-subscribe_namespace">
<a href="#section-8.28" class="section-number selfRef">8.28. </a><a href="#name-subscribe_namespace" class="section-name selfRef">SUBSCRIBE_NAMESPACE</a>
        </h3>
<p id="section-8.28-1">The subscriber sends the SUBSCRIBE_NAMESPACE control message to a publisher to
request the current set of matching announcements and established subscriptions,
as well as future updates to the set.<a href="#section-8.28-1" class="pilcrow">¶</a></p>
<span id="name-moqt-subscribe_namespace-me"></span><div id="moq-transport-subscribe-ns-format">
<figure id="figure-27">
          <div class="alignLeft art-text artwork" id="section-8.28-2.1">
<pre>
SUBSCRIBE_NAMESPACE Message {
  Type (i) = 0x11,
  Length (16),
  Request ID (i),
  Track Namespace Prefix (tuple),
  Number of Parameters (i),
  Parameters (..) ...,
}
</pre>
</div>
<figcaption><a href="#figure-27" class="selfRef">Figure 27</a>:
<a href="#name-moqt-subscribe_namespace-me" class="selfRef">MOQT SUBSCRIBE_NAMESPACE Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.28-3.1">
            <p id="section-8.28-3.1.1">Request ID: See <a href="#request-id" class="auto internal xref">Section 8.1</a>.<a href="#section-8.28-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.28-3.2">
            <p id="section-8.28-3.2.1">Track Namespace Prefix: An ordered N-Tuple of byte fields which are matched
against track namespaces known to the publisher.  For example, if the publisher
is a relay that has received ANNOUNCE messages for namespaces ("example.com",
"meeting=123", "participant=100") and ("example.com", "meeting=123",
"participant=200"), a SUBSCRIBE_NAMESPACE for ("example.com", "meeting=123")
would match both.  If an endpoint receives a Track Namespace Prefix tuple with
an N of 0 or more than 32, it <span class="bcp14">MUST</span> close the session with a Protocol
Violation.<a href="#section-8.28-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.28-3.3">
            <p id="section-8.28-3.3.1">Parameters: The parameters are defined in <a href="#version-specific-params" class="auto internal xref">Section 8.2.1</a>.<a href="#section-8.28-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.28-4">The publisher will respond with SUBSCRIBE_NAMESPACE_OK or
SUBSCRIBE_NAMESPACE_ERROR.  If the SUBSCRIBE_NAMESPACE is successful, the
publisher will immediately forward existing ANNOUNCE and PUBLISH messages that
match the Track Namespace Prefix that have not already been sent to this
subscriber.  If the set of matching ANNOUNCE messages changes, the publisher
sends the corresponding ANNOUNCE or UNANNOUNCE message.<a href="#section-8.28-4" class="pilcrow">¶</a></p>
<p id="section-8.28-5">A subscriber cannot make overlapping namespace subscriptions on a single
session.  Within a session, if a publisher receives a SUBSCRIBE_NAMESPACE with a
Track Namespace Prefix that is a prefix of, suffix of, or equal to an active
SUBSCRIBE_NAMESPACE, it <span class="bcp14">MUST</span> respond with SUBSCRIBE_NAMESPACE_ERROR, with error
code Namespace Prefix Overlap.<a href="#section-8.28-5" class="pilcrow">¶</a></p>
<p id="section-8.28-6">The publisher <span class="bcp14">MUST</span> ensure the subscriber is authorized to perform this
namespace subscription.<a href="#section-8.28-6" class="pilcrow">¶</a></p>
<p id="section-8.28-7">SUBSCRIBE_NAMESPACE is not required for a publisher to send ANNOUNCE, UNANNOUNCE
or PUBLISH messages to a subscriber.  It is useful in applications or relays
where subscribers are only interested in or authorized to access a subset of
available announcements and tracks.<a href="#section-8.28-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-sub-ns-ok">
<section id="section-8.29">
        <h3 id="name-subscribe_namespace_ok">
<a href="#section-8.29" class="section-number selfRef">8.29. </a><a href="#name-subscribe_namespace_ok" class="section-name selfRef">SUBSCRIBE_NAMESPACE_OK</a>
        </h3>
<p id="section-8.29-1">A publisher sends a SUBSCRIBE_NAMESPACE_OK control message for successful
namespace subscriptions.<a href="#section-8.29-1" class="pilcrow">¶</a></p>
<span id="name-moqt-subscribe_namespace_ok"></span><div id="moq-transport-sub-ann-ok">
<figure id="figure-28">
          <div class="alignLeft art-text artwork" id="section-8.29-2.1">
<pre>
SUBSCRIBE_NAMESPACE_OK Message {
  Type (i) = 0x12,
  Length (16),
  Request ID (i),
}
</pre>
</div>
<figcaption><a href="#figure-28" class="selfRef">Figure 28</a>:
<a href="#name-moqt-subscribe_namespace_ok" class="selfRef">MOQT SUBSCRIBE_NAMESPACE_OK Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.29-3.1">
            <p id="section-8.29-3.1.1">Request ID: The Request ID of the SUBSCRIBE_NAMESPACE this message is replying
to <a href="#message-subscribe-ns" class="auto internal xref">Section 8.28</a>.<a href="#section-8.29-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-sub-ns-error">
<section id="section-8.30">
        <h3 id="name-subscribe_namespace_error">
<a href="#section-8.30" class="section-number selfRef">8.30. </a><a href="#name-subscribe_namespace_error" class="section-name selfRef">SUBSCRIBE_NAMESPACE_ERROR</a>
        </h3>
<p id="section-8.30-1">A publisher sends a SUBSCRIBE_NAMESPACE_ERROR control message in response to
a failed SUBSCRIBE_NAMESPACE.<a href="#section-8.30-1" class="pilcrow">¶</a></p>
<span id="name-moqt-subscribe_namespace_er"></span><div id="moq-transport-sub-ann-error">
<figure id="figure-29">
          <div class="alignLeft art-text artwork" id="section-8.30-2.1">
<pre>
SUBSCRIBE_NAMESPACE_ERROR Message {
  Type (i) = 0x13,
  Length (16),
  Request ID (i),
  Error Code (i),
  Error Reason (Reason Phrase)
}
</pre>
</div>
<figcaption><a href="#figure-29" class="selfRef">Figure 29</a>:
<a href="#name-moqt-subscribe_namespace_er" class="selfRef">MOQT SUBSCRIBE_NAMESPACE_ERROR Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.30-3.1">
            <p id="section-8.30-3.1.1">Request ID: The Request ID of the SUBSCRIBE_NAMESPACE this message is replying
to <a href="#message-subscribe-ns" class="auto internal xref">Section 8.28</a>.<a href="#section-8.30-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.30-3.2">
            <p id="section-8.30-3.2.1">Error Code: Identifies an integer error code for the namespace subscription
failure.<a href="#section-8.30-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.30-3.3">
            <p id="section-8.30-3.3.1">Error Reason: Provides the reason for the namespace subscription error.
See <a href="#reason-phrase" class="auto internal xref">Section 1.3.3</a>.<a href="#section-8.30-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.30-4">The application <span class="bcp14">SHOULD</span> use a relevant error code in SUBSCRIBE_NAMESPACE_ERROR,
as defined below:<a href="#section-8.30-4" class="pilcrow">¶</a></p>
<table class="center" id="table-9">
          <caption><a href="#table-9" class="selfRef">Table 9</a></caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Code</th>
              <th class="text-left" rowspan="1" colspan="1">Reason</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">Internal Error</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x1</td>
              <td class="text-left" rowspan="1" colspan="1">Unauthorized</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x2</td>
              <td class="text-left" rowspan="1" colspan="1">Timeout</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x3</td>
              <td class="text-left" rowspan="1" colspan="1">Not Supported</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x4</td>
              <td class="text-left" rowspan="1" colspan="1">Namespace Prefix Unknown</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x5</td>
              <td class="text-left" rowspan="1" colspan="1">Namespace Prefix Overlap</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x10</td>
              <td class="text-left" rowspan="1" colspan="1">Malformed Auth Token</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x12</td>
              <td class="text-left" rowspan="1" colspan="1">Expired Auth Token</td>
            </tr>
          </tbody>
        </table>
<ul class="normal">
<li class="normal" id="section-8.30-6.1">
            <p id="section-8.30-6.1.1">Internal Error - An implementation specific or generic error occurred.<a href="#section-8.30-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.30-6.2">
            <p id="section-8.30-6.2.1">Unauthorized - The subscriber is not authorized to subscribe to the given
namespace prefix.<a href="#section-8.30-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.30-6.3">
            <p id="section-8.30-6.3.1">Timeout - The operation could not be completed before an implementation
specific timeout.<a href="#section-8.30-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.30-6.4">
            <p id="section-8.30-6.4.1">Not Supported - The endpoint does not support the SUBSCRIBE_NAMESPACE method.<a href="#section-8.30-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.30-6.5">
            <p id="section-8.30-6.5.1">Namespace Prefix Unknown - The namespace prefix is not available for
subscription.<a href="#section-8.30-6.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.30-6.6">
            <p id="section-8.30-6.6.1">Namespace Prefix Overlap - The namespace prefix overlaps with another
SUBSCRIBE_NAMESPACE in the same session.<a href="#section-8.30-6.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.30-6.7">
            <p id="section-8.30-6.7.1">Malformed Auth Token - Invalid Auth Token serialization during registration
(see <a href="#authorization-token" class="auto internal xref">Section 8.2.1.1</a>).<a href="#section-8.30-6.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.30-6.8">
            <p id="section-8.30-6.8.1">Expired Auth Token - Authorization token has expired <a href="#authorization-token" class="auto internal xref">Section 8.2.1.1</a>).<a href="#section-8.30-6.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-unsub-ns">
<section id="section-8.31">
        <h3 id="name-unsubscribe_namespace">
<a href="#section-8.31" class="section-number selfRef">8.31. </a><a href="#name-unsubscribe_namespace" class="section-name selfRef">UNSUBSCRIBE_NAMESPACE</a>
        </h3>
<p id="section-8.31-1">A subscriber issues a <code>UNSUBSCRIBE_NAMESPACE</code> message to a publisher indicating
it is no longer interested in ANNOUNCE, UNANNOUNCE and PUBLISH messages for the
specified track namespace prefix.<a href="#section-8.31-1" class="pilcrow">¶</a></p>
<p id="section-8.31-2">The format of <code>UNSUBSCRIBE_NAMESPACE</code> is as follows:<a href="#section-8.31-2" class="pilcrow">¶</a></p>
<span id="name-moqt-unsubscribe_namespace-"></span><div id="moq-transport-unsub-ann-format">
<figure id="figure-30">
          <div class="alignLeft art-text artwork" id="section-8.31-3.1">
<pre>
UNSUBSCRIBE_NAMESPACE Message {
  Type (i) = 0x14,
  Length (16),
  Track Namespace Prefix (tuple)
}
</pre>
</div>
<figcaption><a href="#figure-30" class="selfRef">Figure 30</a>:
<a href="#name-moqt-unsubscribe_namespace-" class="selfRef">MOQT UNSUBSCRIBE_NAMESPACE Message</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-8.31-4.1">
            <p id="section-8.31-4.1.1">Track Namespace Prefix: As defined in <a href="#message-subscribe-ns" class="auto internal xref">Section 8.28</a>.<a href="#section-8.31-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="data-streams">
<section id="section-9">
      <h2 id="name-data-streams-and-datagrams">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-data-streams-and-datagrams" class="section-name selfRef">Data Streams and Datagrams</a>
      </h2>
<p id="section-9-1">A publisher sends Objects matching a subscription on Data Streams or Datagrams.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">All unidirectional MOQT streams start with a variable-length integer indicating
the type of the stream in question.<a href="#section-9-2" class="pilcrow">¶</a></p>
<table class="center" id="table-10">
        <caption><a href="#table-10" class="selfRef">Table 10</a></caption>
<thead>
          <tr>
            <th class="text-right" rowspan="1" colspan="1">ID</th>
            <th class="text-left" rowspan="1" colspan="1">Type</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x08-0x0D</td>
            <td class="text-left" rowspan="1" colspan="1">SUBGROUP_HEADER  (<a href="#subgroup-header" class="auto internal xref">Section 9.4.2</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x05</td>
            <td class="text-left" rowspan="1" colspan="1">FETCH_HEADER  (<a href="#fetch-header" class="auto internal xref">Section 9.4.4</a>)</td>
          </tr>
        </tbody>
      </table>
<p id="section-9-4">All MOQT datagrams start with a variable-length integer indicating the type of
the datagram.<a href="#section-9-4" class="pilcrow">¶</a></p>
<table class="center" id="table-11">
        <caption><a href="#table-11" class="selfRef">Table 11</a></caption>
<thead>
          <tr>
            <th class="text-right" rowspan="1" colspan="1">ID</th>
            <th class="text-left" rowspan="1" colspan="1">Type</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x00-0x03</td>
            <td class="text-left" rowspan="1" colspan="1">OBJECT_DATAGRAM (<a href="#object-datagram" class="auto internal xref">Section 9.3.1</a>)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">0x04-0x05</td>
            <td class="text-left" rowspan="1" colspan="1">OBJECT_DATAGRAM_STATUS (<a href="#object-datagram" class="auto internal xref">Section 9.3.1</a>)</td>
          </tr>
        </tbody>
      </table>
<p id="section-9-6">An endpoint that receives an unknown stream or datagram type <span class="bcp14">MUST</span> close the
session.<a href="#section-9-6" class="pilcrow">¶</a></p>
<p id="section-9-7">The publisher only sends Objects after receiving a SUBSCRIBE or FETCH.  The
publisher <span class="bcp14">MUST NOT</span> send Objects that are not requested.  If an endpoint receives
an Object it never requested, it <span class="bcp14">SHOULD</span> terminate the session with a protocol
violation. Objects can arrive after a subscription or fetch has been cancelled,
so the session <span class="bcp14">MUST NOT</span> be teriminated in that case.<a href="#section-9-7" class="pilcrow">¶</a></p>
<p id="section-9-8">Every Track has a single 'Object Forwarding Preference' and the Original
Publisher <span class="bcp14">MUST NOT</span> mix different forwarding preferences within a single track
(see <a href="#malformed-tracks" class="auto internal xref">Section 2.5</a>).<a href="#section-9-8" class="pilcrow">¶</a></p>
<div id="track-alias">
<section id="section-9.1">
        <h3 id="name-track-alias">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-track-alias" class="section-name selfRef">Track Alias</a>
        </h3>
<p id="section-9.1-1">To optimize wire efficiency, Subgroups and Datagrams refer to a track by a
numeric identifier, rather than the Full Track Name.  Track Alias is chosen by
the publisher and included in SUBSCRIBE_OK (<a href="#message-subscribe-ok" class="auto internal xref">Section 8.8</a> or PUBLISH
(<a href="#message-publish" class="auto internal xref">Section 8.13</a>).<a href="#section-9.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-object">
<section id="section-9.2">
        <h3 id="name-objects-2">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-objects-2" class="section-name selfRef">Objects</a>
        </h3>
<p id="section-9.2-1">An Object contains a range of contiguous bytes from the
specified track, as well as associated metadata required to deliver,
cache, and forward it.  Objects are sent by publishers.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<div id="object-properties">
<section id="section-9.2.1">
          <h4 id="name-canonical-object-properties">
<a href="#section-9.2.1" class="section-number selfRef">9.2.1. </a><a href="#name-canonical-object-properties" class="section-name selfRef">Canonical Object Properties</a>
          </h4>
<p id="section-9.2.1-1">A canonical MoQ Object has the following information:<a href="#section-9.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2.1-2.1">
              <p id="section-9.2.1-2.1.1">Track Namespace and Track Name: The track this object belongs to.<a href="#section-9.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.2.1-2.2">
              <p id="section-9.2.1-2.2.1">Group ID: The object is a member of the indicated group ID
<a href="#model-group" class="auto internal xref">Section 2.3</a> within the track.<a href="#section-9.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.2.1-2.3">
              <p id="section-9.2.1-2.3.1">Object ID: The order of the object within the group.<a href="#section-9.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.2.1-2.4">
              <p id="section-9.2.1-2.4.1">Publisher Priority: An 8 bit integer indicating the publisher's priority for
the Object <a href="#priorities" class="auto internal xref">Section 6</a>.<a href="#section-9.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.2.1-2.5">
              <p id="section-9.2.1-2.5.1">Object Forwarding Preference: An enumeration indicating how a publisher sends
an object. The preferences are Subgroup and Datagram.  When in response to a
SUBSCRIBE, an Object <span class="bcp14">MUST</span> be sent according to its <code>Object Forwarding
Preference</code>, described below.<a href="#section-9.2.1-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.2.1-2.6">
              <p id="section-9.2.1-2.6.1">Subgroup ID: The object is a member of the indicated subgroup ID (<a href="#model-subgroup" class="auto internal xref">Section 2.2</a>)
within the group. This field is omitted if the Object Forwarding Preference is
Datagram.<a href="#section-9.2.1-2.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.2.1-2.7">
              <p id="section-9.2.1-2.7.1">Object Status: As enumeration used to indicate missing
objects or mark the end of a group or track. See <a href="#object-status" class="auto internal xref">Section 9.2.1.1</a> below.<a href="#section-9.2.1-2.7.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.2.1-2.8">
              <p id="section-9.2.1-2.8.1">Object Extension Length: The total length of the Object Extension Headers
block, in bytes.<a href="#section-9.2.1-2.8.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.2.1-2.9">
              <p id="section-9.2.1-2.9.1">Object Extensions : A sequence of Object Extension Headers. See
<a href="#object-extensions" class="auto internal xref">Section 9.2.1.2</a> below.<a href="#section-9.2.1-2.9.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.2.1-2.10">
              <p id="section-9.2.1-2.10.1">Object Payload: An opaque payload intended for an End Subscriber and <span class="bcp14">SHOULD NOT</span> be processed by a relay. Only present when 'Object Status' is Normal (0x0).<a href="#section-9.2.1-2.10.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div id="object-status">
<section id="section-9.2.1.1">
            <h5 id="name-object-status">
<a href="#section-9.2.1.1" class="section-number selfRef">9.2.1.1. </a><a href="#name-object-status" class="section-name selfRef">Object Status</a>
            </h5>
<p id="section-9.2.1.1-1">The Object Status informs subscribers what objects will not be received
because they were never produced, are no longer available, or because they
are beyond the end of a group or track.<a href="#section-9.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-9.2.1.1-2"><code>Status</code> can have following values:<a href="#section-9.2.1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2.1.1-3.1">
                <p id="section-9.2.1.1-3.1.1">0x0 := Normal object. This status is implicit for any non-zero length object.
       Zero-length objects explicitly encode the Normal status.<a href="#section-9.2.1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.2.1.1-3.2">
                <p id="section-9.2.1.1-3.2.1">0x1 := Indicates Object does not exist. Indicates that this object
       does not exist at any publisher and it will not be published in
       the future. This <span class="bcp14">SHOULD</span> be cached.<a href="#section-9.2.1.1-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.2.1.1-3.3">
                <p id="section-9.2.1.1-3.3.1">0x3 := Indicates end of Group. ObjectId is one greater that the
       largest object produced in the group identified by the
       GroupID. This is sent right after the last object in the
       group. If the ObjectID is 0, it indicates there are no Objects
       in this Group. This <span class="bcp14">SHOULD</span> be cached. A publisher <span class="bcp14">MAY</span> use an end of
       Group object to signal the end of all open Subgroups in a Group. A
       non-zero-length Object can be the End of Group, as signaled in
       the DATAGRAM or SUBGROUP_HEADER Type field (see <a href="#object-datagram" class="auto internal xref">Section 9.3.1</a>
       and <a href="#subgroup-header" class="auto internal xref">Section 9.4.2</a>).<a href="#section-9.2.1.1-3.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.2.1.1-3.4">
                <p id="section-9.2.1.1-3.4.1">0x4 := Indicates end of Track. GroupID is either the largest group produced
       in this track and the ObjectID is one greater than the largest object
       produced in that group, or GroupID is one greater than the largest
       group produced in this track and the ObjectID is zero. This status
       also indicates the last group has ended. An object with this status
       that has a Group ID less than any other GroupID, or an ObjectID less
       than or equal to the largest in the specified group, is a protocol
       error, and the receiver <span class="bcp14">MUST</span> terminate the session. This <span class="bcp14">SHOULD</span> be
       cached.<a href="#section-9.2.1.1-3.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-9.2.1.1-4">Any other value <span class="bcp14">SHOULD</span> be treated as a protocol error and terminate the
session with a Protocol Violation (<a href="#session-termination" class="auto internal xref">Section 3.4</a>).
Any object with a status code other than zero <span class="bcp14">MUST</span> have an empty payload.<a href="#section-9.2.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="object-extensions">
<section id="section-9.2.1.2">
            <h5 id="name-object-extension-header">
<a href="#section-9.2.1.2" class="section-number selfRef">9.2.1.2. </a><a href="#name-object-extension-header" class="section-name selfRef">Object Extension Header</a>
            </h5>
<p id="section-9.2.1.2-1">Any Object may have extension headers except those with Object Status 'Object
Does Not Exist'.  If an endpoint receives a non-existent Object containing
extension headers it <span class="bcp14">MUST</span> close the session with a Protocol Violation.<a href="#section-9.2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2.1.2-2">Object Extension Headers are visible to relays and allow the transmission of
future metadata relevant to MOQT Object distribution. Any Object metadata never
accessed by the transport or relays <span class="bcp14">SHOULD</span> be serialized as part of the Object
payload and not as an extension header.<a href="#section-9.2.1.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2.1.2-3">Extension Headers are defined in external specifications and registered in an
IANA table <a href="#iana" class="auto internal xref">Section 12</a>. These specifications define the type and value of the
header, along with any rules concerning processing, modification, caching and
forwarding. A relay which is coded to implement these rules is said to
"support" the extension.<a href="#section-9.2.1.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2.1.2-4">If unsupported by the relay, Extension Headers <span class="bcp14">MUST NOT</span> be modified, <span class="bcp14">MUST</span> be
cached as part of the Object and <span class="bcp14">MUST</span> be forwarded by relays.<a href="#section-9.2.1.2-4" class="pilcrow">¶</a></p>
<p id="section-9.2.1.2-5">If supported by the relay and subject to the processing rules specified in the
definition of the extension, Extension Headers <span class="bcp14">MAY</span> be modified, added, removed,
and/or cached by relays.<a href="#section-9.2.1.2-5" class="pilcrow">¶</a></p>
<p id="section-9.2.1.2-6">Object Extension Headers are serialized as Key-Value-Pairs (see
<a href="#moq-key-value-pair" class="auto internal xref">Figure 2</a>).<a href="#section-9.2.1.2-6" class="pilcrow">¶</a></p>
<p id="section-9.2.1.2-7">Header types are registered in the IANA table 'MOQ Extension Headers'.
See <a href="#iana" class="auto internal xref">Section 12</a>.<a href="#section-9.2.1.2-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="datagrams">
<section id="section-9.3">
        <h3 id="name-datagrams">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-datagrams" class="section-name selfRef">Datagrams</a>
        </h3>
<p id="section-9.3-1">A single object can be conveyed in a datagram.  The Track Alias field
<a href="#track-alias" class="auto internal xref">Section 9.1</a> indicates the track this Datagram belongs to.  If an endpoint
receives a datagram with an unknown Track Alias, it <span class="bcp14">MAY</span> drop the datagram or
choose to buffer it for a brief period to handle reordering with the control
message that establishes the Track Alias.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">An Object received in an <code>OBJECT_DATAGRAM</code> or <code>OBJECT_DATAGRAM_STATUS</code> message
has an <code>Object Forwarding Preference</code> = <code>Datagram</code>.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
<p id="section-9.3-3">To send an Object with <code>Object Forwarding Preference</code> = <code>Datagram</code>, determine
the length of the header and payload and send the Object as datagram.  When the
total size is larger than maximum datagram size for the session, the Object will
be dropped without any explicit notification.<a href="#section-9.3-3" class="pilcrow">¶</a></p>
<p id="section-9.3-4">Each session along the path between the Original Publisher and End Subscriber
might have different maximum datagram sizes. Additionally, Object Extension
Headers (<a href="#object-extensions" class="auto internal xref">Section 9.2.1.2</a>) can be added to Objects as they pass through
the MOQT network, increasing the size of the Object and the chances it will
exceed the maximum datagram size of a downstream session and be dropped.<a href="#section-9.3-4" class="pilcrow">¶</a></p>
<div id="object-datagram">
<section id="section-9.3.1">
          <h4 id="name-object-datagram">
<a href="#section-9.3.1" class="section-number selfRef">9.3.1. </a><a href="#name-object-datagram" class="section-name selfRef">Object Datagram</a>
          </h4>
<p id="section-9.3.1-1">An <code>OBJECT_DATAGRAM</code> carries a single object in a datagram.<a href="#section-9.3.1-1" class="pilcrow">¶</a></p>
<span id="name-moqt-object_datagram"></span><div id="object-datagram-format">
<figure id="figure-31">
            <div class="alignLeft art-text artwork" id="section-9.3.1-2.1">
<pre>
OBJECT_DATAGRAM {
  Type (i) = 0x0-0x4,
  Track Alias (i),
  Group ID (i),
  Object ID (i),
  Publisher Priority (8),
  [Extension Headers Length (i),
  Extension headers (...)],
  Object Payload (..),
}
</pre>
</div>
<figcaption><a href="#figure-31" class="selfRef">Figure 31</a>:
<a href="#name-moqt-object_datagram" class="selfRef">MOQT OBJECT_DATAGRAM</a>
            </figcaption></figure>
</div>
<p id="section-9.3.1-3">There are 4 defined Type values for OBJECT_DATAGRAM:<a href="#section-9.3.1-3" class="pilcrow">¶</a></p>
<table class="center" id="table-12">
            <caption><a href="#table-12" class="selfRef">Table 12</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">End Of Group</th>
                <th class="text-left" rowspan="1" colspan="1">Extensions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">Present</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x00</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x01</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x02</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x03</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
              </tr>
            </tbody>
          </table>
<p id="section-9.3.1-5">For Type values where End of Group is Yes, the Object is the last Object in the
Group.<a href="#section-9.3.1-5" class="pilcrow">¶</a></p>
<p id="section-9.3.1-6">For Type values where Extensions Present is No, Extensions Headers Length is not
present and the Object has no extensions.  When Extensions Present is Yes,
Extension Headers Length is present.  If an endpoint receives a datagram with
Type 0x01 and Extension Headers Length is 0, it <span class="bcp14">MUST</span> close the session with
Protocol Violation.<a href="#section-9.3.1-6" class="pilcrow">¶</a></p>
<p id="section-9.3.1-7">There is no explicit length field.  The entirety of the transport datagram
following Publisher Priority contains the Object Payload.<a href="#section-9.3.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="object-datagram-status">
<section id="section-9.3.2">
          <h4 id="name-object-datagram-status">
<a href="#section-9.3.2" class="section-number selfRef">9.3.2. </a><a href="#name-object-datagram-status" class="section-name selfRef">Object Datagram Status</a>
          </h4>
<p id="section-9.3.2-1">An <code>OBJECT_DATAGRAM_STATUS</code> is similar to OBJECT_DATAGRAM except it
conveys an Object Status and has no payload.<a href="#section-9.3.2-1" class="pilcrow">¶</a></p>
<span id="name-moqt-object_datagram_status"></span><div id="object-datagram-status-format">
<figure id="figure-32">
            <div class="alignLeft art-text artwork" id="section-9.3.2-2.1">
<pre>
OBJECT_DATAGRAM_STATUS {
  Type (i),
  Track Alias (i),
  Group ID (i),
  Object ID (i),
  Publisher Priority (8),
  [Extension Headers Length (i),
  Extension headers (...)],
  Object Status (i),
}
</pre>
</div>
<figcaption><a href="#figure-32" class="selfRef">Figure 32</a>:
<a href="#name-moqt-object_datagram_status" class="selfRef">MOQT OBJECT_DATAGRAM_STATUS</a>
            </figcaption></figure>
</div>
<p id="section-9.3.2-3">There are 2 defined Type values for OBJECT_DATAGRAM_STATUS:<a href="#section-9.3.2-3" class="pilcrow">¶</a></p>
<table class="center" id="table-13">
            <caption><a href="#table-13" class="selfRef">Table 13</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Extensions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">Present</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x04</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x05</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
              </tr>
            </tbody>
          </table>
<p id="section-9.3.2-5">The LSB of the type determines if the Extensions Headers Length and Extension
headers are present. If an endpoint receives a datagram with Type 0x05 and
Extension Headers Length is 0, it <span class="bcp14">MUST</span> close the session with Protocol Violation.<a href="#section-9.3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="streams">
<section id="section-9.4">
        <h3 id="name-streams">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-streams" class="section-name selfRef">Streams</a>
        </h3>
<p id="section-9.4-1">When objects are sent on streams, the stream begins with a Subgroup Header
and is followed by one or more sets of serialized object fields.
If a stream ends gracefully in the middle of a serialized Object, the session
<span class="bcp14">SHOULD</span> be terminated with a Protocol Violation.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2">A publisher <span class="bcp14">SHOULD NOT</span> open more than one stream at a time with the same Subgroup
Header field values.<a href="#section-9.4-2" class="pilcrow">¶</a></p>
<div id="stream-cancellation">
<section id="section-9.4.1">
          <h4 id="name-stream-cancellation">
<a href="#section-9.4.1" class="section-number selfRef">9.4.1. </a><a href="#name-stream-cancellation" class="section-name selfRef">Stream Cancellation</a>
          </h4>
<p id="section-9.4.1-1">Streams aside from the control stream <span class="bcp14">MAY</span> be canceled due to congestion
or other reasons by either the publisher or subscriber. Early termination of a
stream does not affect the MoQ application state, and therefore has no
effect on outstanding subscriptions.<a href="#section-9.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subgroup-header">
<section id="section-9.4.2">
          <h4 id="name-subgroup-header">
<a href="#section-9.4.2" class="section-number selfRef">9.4.2. </a><a href="#name-subgroup-header" class="section-name selfRef">Subgroup Header</a>
          </h4>
<p id="section-9.4.2-1">All Objects on a Subgroup stream belong to the track identified by <code>Track Alias</code>
(see <a href="#track-alias" class="auto internal xref">Section 9.1</a>) and the Subgroup indicated by 'Group ID' and <code>Subgroup
ID</code> in the SUBGROUP_HEADER.<a href="#section-9.4.2-1" class="pilcrow">¶</a></p>
<p id="section-9.4.2-2">If an endpoint receives a subgroup with an unknown Track Alias, it <span class="bcp14">MAY</span> abandon
the stream, or choose to buffer it for a brief period to handle reordering with
the control message that establishes the Track Alias.  The endpoint <span class="bcp14">MAY</span> withhold
stream flow control beyond the SUBGROUP_HEADER until the Track Alias has been
established.  To prevent deadlocks, the publisher <span class="bcp14">MUST</span> allocate connection flow
control to the control stream before allocating it any data streams. Otherwise,
a receiver might wait for a control message containing a Track Alias to release
flow control, while the sender waits for flow control to send the message.<a href="#section-9.4.2-2" class="pilcrow">¶</a></p>
<span id="name-moqt-subgroup_header"></span><div id="object-header-format">
<figure id="figure-33">
            <div class="alignLeft art-text artwork" id="section-9.4.2-3.1">
<pre>
SUBGROUP_HEADER {
  Type (i) = 0x8..0xD,
  Track Alias (i),
  Group ID (i),
  [Subgroup ID (i),]
  Publisher Priority (8),
}
</pre>
</div>
<figcaption><a href="#figure-33" class="selfRef">Figure 33</a>:
<a href="#name-moqt-subgroup_header" class="selfRef">MOQT SUBGROUP_HEADER</a>
            </figcaption></figure>
</div>
<p id="section-9.4.2-4">All Objects received on a stream opened with <code>SUBGROUP_HEADER</code> have an
<code>Object Forwarding Preference</code> = <code>Subgroup</code>.<a href="#section-9.4.2-4" class="pilcrow">¶</a></p>
<p id="section-9.4.2-5">There are 12 defined Type values for SUBGROUP_HEADER:<a href="#section-9.4.2-5" class="pilcrow">¶</a></p>
<table class="center" id="table-14">
            <caption><a href="#table-14" class="selfRef">Table 14</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Subgroup ID</th>
                <th class="text-left" rowspan="1" colspan="1">Subgroup ID</th>
                <th class="text-left" rowspan="1" colspan="1">Extensions</th>
                <th class="text-left" rowspan="1" colspan="1">Contains End</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">Field Present</td>
                <td class="text-left" rowspan="1" colspan="1">Value</td>
                <td class="text-left" rowspan="1" colspan="1">Present</td>
                <td class="text-left" rowspan="1" colspan="1">of Group</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x10</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x11</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x12</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
                <td class="text-left" rowspan="1" colspan="1">First Object ID</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x13</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
                <td class="text-left" rowspan="1" colspan="1">First Object ID</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x14</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x15</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x18</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x19</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x1A</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
                <td class="text-left" rowspan="1" colspan="1">First Object ID</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x1B</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
                <td class="text-left" rowspan="1" colspan="1">First Object ID</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x1C</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">No</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x1D</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
                <td class="text-left" rowspan="1" colspan="1">Yes</td>
              </tr>
            </tbody>
          </table>
<p id="section-9.4.2-7">For Type values where Contains End of Group is Yes, the last Object in this
Subgroup stream before a FIN is the last Object in the Group.  If the Subgroup
stream is terminated with a RESET_STREAM or RESET_STREAM_AT, the receiver cannot
determine the End of Group Object ID.<a href="#section-9.4.2-7" class="pilcrow">¶</a></p>
<p id="section-9.4.2-8">For Type values where Subgroup ID Field Present is No, there is no explicit
Subgroup ID field in the header and the Subgroup ID is either 0 (for Types
0x10-11 and 0x18-19) or the Object ID of the first object transmitted in this
subgroup (for Types 0x12-13 and 0x1A-1B).<a href="#section-9.4.2-8" class="pilcrow">¶</a></p>
<p id="section-9.4.2-9">For Type values where Extensions Present is No, Extensions Headers Length is
not present and all Objects have no extensions.  When Extensions Present is
Yes, Extension Headers Length is present in all Objects in this subgroup.
Objects with no extensions set Extension Headers Length to 0.<a href="#section-9.4.2-9" class="pilcrow">¶</a></p>
<p id="section-9.4.2-10">To send an Object with <code>Object Forwarding Preference</code> = <code>Subgroup</code>, find the open
stream that is associated with the subscription, <code>Group ID</code> and <code>Subgroup ID</code>,
or open a new one and send the <code>SUBGROUP_HEADER</code>. Then serialize the
following fields.<a href="#section-9.4.2-10" class="pilcrow">¶</a></p>
<p id="section-9.4.2-11">The Object Status field is only sent if the Object Payload Length is zero.<a href="#section-9.4.2-11" class="pilcrow">¶</a></p>
<span id="name-moqt-subgroup-object-fields"></span><div id="object-subgroup-format">
<figure id="figure-34">
            <div class="alignLeft art-text artwork" id="section-9.4.2-12.1">
<pre>
{
  Object ID (i),
  [Extension Headers Length (i),
  Extension headers (...)],
  Object Payload Length (i),
  [Object Status (i)],
  Object Payload (..),
}
</pre>
</div>
<figcaption><a href="#figure-34" class="selfRef">Figure 34</a>:
<a href="#name-moqt-subgroup-object-fields" class="selfRef">MOQT Subgroup Object Fields</a>
            </figcaption></figure>
</div>
<p id="section-9.4.2-13">A publisher <span class="bcp14">MUST NOT</span> send an Object on a stream if its Object ID is less than a
previously sent Object ID within a given group in that stream.<a href="#section-9.4.2-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="closing-subgroup-streams">
<section id="section-9.4.3">
          <h4 id="name-closing-subgroup-streams">
<a href="#section-9.4.3" class="section-number selfRef">9.4.3. </a><a href="#name-closing-subgroup-streams" class="section-name selfRef">Closing Subgroup Streams</a>
          </h4>
<p id="section-9.4.3-1">Subscribers will often need to know if they have received all objects in a
Subgroup, particularly if they serve as a relay or cache. QUIC and Webtransport
streams provide signals that can be used for this purpose. Closing Subgroups
promptly frees system resources and often unlocks flow control credit to open
more streams.<a href="#section-9.4.3-1" class="pilcrow">¶</a></p>
<p id="section-9.4.3-2">If a sender has delivered all objects in a Subgroup to the QUIC stream, except
any Objects with Locations smaller than the subscription's Start Location, it
<span class="bcp14">MUST</span> close the stream with a FIN.<a href="#section-9.4.3-2" class="pilcrow">¶</a></p>
<p id="section-9.4.3-3">If a sender closes the stream before delivering all such objects to the QUIC
stream, it <span class="bcp14">MUST</span> use a RESET_STREAM or RESET_STREAM_AT
<span>[<a href="#I-D.draft-ietf-quic-reliable-stream-reset" class="cite xref">I-D.draft-ietf-quic-reliable-stream-reset</a>]</span> frame. This includes an open
Subgroup exceeding its Delivery Timeout, early termination of subscription due
to an UNSUBSCRIBE message, a publisher's decision to end the subscription early,
or a SUBSCRIBE_UPDATE moving the subscription's End Group to a smaller Group or
the Start Location to a larger Location.  When RESET_STREAM_AT is used, the
reliable_size <span class="bcp14">SHOULD</span> include the stream header so the receiver can identify the
corresponding subscription and accurately account for reset data streams when
handling SUBSCRIBE_DONE (see <a href="#message-subscribe-done" class="auto internal xref">Section 8.12</a>).  Publishers that reset
data streams without using RESET_STREAM_AT with an appropriate reliable_size can
cause subscribers to hold on to subscription state until a timeout expires.<a href="#section-9.4.3-3" class="pilcrow">¶</a></p>
<p id="section-9.4.3-4">A sender might send all objects in a Subgroup and the FIN on a QUIC stream,
and then reset the stream. In this case, the receiving application would receive
the FIN if and only if all objects were received. If the application receives
all data on the stream and the FIN, it can ignore any RESET_STREAM it receives.<a href="#section-9.4.3-4" class="pilcrow">¶</a></p>
<p id="section-9.4.3-5">If a sender will not deliver any objects from a Subgroup, it <span class="bcp14">MAY</span> send
a SUBGROUP_HEADER on a new stream, with no objects, and then send RESET_STREAM_AT
with a reliable_size equal to the length of the stream header. This explicitly
tells the receiver there is an unsent Subgroup.<a href="#section-9.4.3-5" class="pilcrow">¶</a></p>
<p id="section-9.4.3-6">A relay <span class="bcp14">MUST NOT</span> forward an Object on an existing Subgroup stream unless it is
the next Object in that Subgroup.  A relay knows that an Object is the next
Object in the Subgroup if at least one of the following is true:
 * the Object ID is one greater than the previous Object sent on this Subgroup
   stream.
 * the Object was received on the same upstream Subgroup stream as the
   previously sent Object on the downstream Subgroup stream, with no other
   Objects in between.
 * it knows all Object IDs between the current and previous Object IDs
   on the Subgroup stream belong to different Subgroups or do not exist.<a href="#section-9.4.3-6" class="pilcrow">¶</a></p>
<p id="section-9.4.3-7">If the relay does not know if an Object is the next Object, it <span class="bcp14">MUST</span> reset the
Subgroup stream and open a new one to forward it.<a href="#section-9.4.3-7" class="pilcrow">¶</a></p>
<p id="section-9.4.3-8">Since SUBSCRIBEs always end on a group boundary, an ending subscription can
always cleanly close all its subgroups. A sender that terminates a stream
early for any other reason (e.g., to handoff to a different sender) <span class="bcp14">MUST</span>
use RESET_STREAM or RESET_STREAM_AT. Senders <span class="bcp14">SHOULD</span> terminate a stream on
Group boundaries to avoid doing so.<a href="#section-9.4.3-8" class="pilcrow">¶</a></p>
<p id="section-9.4.3-9">An MOQT implementation that processes a stream FIN is assured it has received
all objects in a subgroup from the start of the subscription. If a relay, it
can forward stream FINs to its own subscribers once those objects have been
sent. A relay <span class="bcp14">MAY</span> treat receipt of EndOfGroup, GroupDoesNotExist, or
EndOfTrack objects as a signal to close corresponding streams even if the FIN
has not arrived, as further objects on the stream would be a protocol violation.<a href="#section-9.4.3-9" class="pilcrow">¶</a></p>
<p id="section-9.4.3-10">Similarly, an EndOfGroup message indicates the maximum Object ID in the
Group, so if all Objects in the Group have been received, a FIN can be sent on
any stream where the entire subgroup has been sent. This might be complex to
implement.<a href="#section-9.4.3-10" class="pilcrow">¶</a></p>
<p id="section-9.4.3-11">Processing a RESET_STREAM or RESET_STREAM_AT means that there might be other
objects in the Subgroup beyond the last one received. A relay might immediately
reset the corresponding downstream stream, or it might attempt to recover the
missing Objects in an effort send all the objects in the subgroups and the FIN. It also
might send RESET_STREAM_AT with reliable_size set to the last object it has, so
as to reliably deliver the objects it has while signaling that other objects
might exist.<a href="#section-9.4.3-11" class="pilcrow">¶</a></p>
<p id="section-9.4.3-12">A subscriber <span class="bcp14">MAY</span> send a QUIC STOP_SENDING frame for a subgroup stream if the Group
or Subgroup is no longer of interest to it. The publisher <span class="bcp14">SHOULD</span> respond with
RESET_STREAM or RESET_STREAM_AT. If RESET_STREAM_AT is sent, note that the receiver
has indicated no interest in the objects, so setting a reliable_size beyond the
stream header is of questionable utility.<a href="#section-9.4.3-12" class="pilcrow">¶</a></p>
<p id="section-9.4.3-13">RESET_STREAM and STOP_SENDING on SUBSCRIBE data streams have no impact on other
Subgroups in the Group or the subscription, although applications might cancel all
Subgroups in a Group at once.<a href="#section-9.4.3-13" class="pilcrow">¶</a></p>
<p id="section-9.4.3-14">The application <span class="bcp14">SHOULD</span> use a relevant error code in RESET_STREAM or
RESET_STREAM_AT, as defined below:<a href="#section-9.4.3-14" class="pilcrow">¶</a></p>
<table class="center" id="table-15">
            <caption><a href="#table-15" class="selfRef">Table 15</a></caption>
<thead>
              <tr>
                <th class="text-right" rowspan="1" colspan="1">Code</th>
                <th class="text-left" rowspan="1" colspan="1">Reason</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">0x0</td>
                <td class="text-left" rowspan="1" colspan="1">Internal Error</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">0x1</td>
                <td class="text-left" rowspan="1" colspan="1">Cancelled</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">0x2</td>
                <td class="text-left" rowspan="1" colspan="1">Delivery Timeout</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">0x3</td>
                <td class="text-left" rowspan="1" colspan="1">Session Closed</td>
              </tr>
            </tbody>
          </table>
<span class="break"></span><dl class="dlParallel" id="section-9.4.3-16">
            <dt id="section-9.4.3-16.1">Internal Error:</dt>
            <dd style="margin-left: 1.5em" id="section-9.4.3-16.2">
              <p id="section-9.4.3-16.2.1">An implementation specific error<a href="#section-9.4.3-16.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-9.4.3-16.3">Cancelled:</dt>
            <dd style="margin-left: 1.5em" id="section-9.4.3-16.4">
              <p id="section-9.4.3-16.4.1">The subscriber requested cancellation via UNSUBSCRIBE, FETCH_CANCEL or
STOP_SENDING, or the publisher ended the subscription, in which case
SUBSCRIBE_DONE (<a href="#message-subscribe-done" class="auto internal xref">Section 8.12</a>) will have a more detailed
status code.<a href="#section-9.4.3-16.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-9.4.3-16.5">Delivery Timeout:</dt>
            <dd style="margin-left: 1.5em" id="section-9.4.3-16.6">
              <p id="section-9.4.3-16.6.1">The DELIVERY TIMEOUT <a href="#delivery-timeout" class="auto internal xref">Section 8.2.1.2</a> was exceeded for this
stream<a href="#section-9.4.3-16.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-9.4.3-16.7">Session Closed:</dt>
            <dd style="margin-left: 1.5em" id="section-9.4.3-16.8">
              <p id="section-9.4.3-16.8.1">The publisher session is being closed<a href="#section-9.4.3-16.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="fetch-header">
<section id="section-9.4.4">
          <h4 id="name-fetch-header">
<a href="#section-9.4.4" class="section-number selfRef">9.4.4. </a><a href="#name-fetch-header" class="section-name selfRef">Fetch Header</a>
          </h4>
<p id="section-9.4.4-1">When a stream begins with <code>FETCH_HEADER</code>, all objects on the stream belong to the
track requested in the Fetch message identified by <code>Request ID</code>.<a href="#section-9.4.4-1" class="pilcrow">¶</a></p>
<span id="name-moqt-fetch_header"></span><div id="fetch-header-format">
<figure id="figure-35">
            <div class="alignLeft art-text artwork" id="section-9.4.4-2.1">
<pre>
FETCH_HEADER {
  Type (i) = 0x5,
  Request ID (i),
}
</pre>
</div>
<figcaption><a href="#figure-35" class="selfRef">Figure 35</a>:
<a href="#name-moqt-fetch_header" class="selfRef">MOQT FETCH_HEADER</a>
            </figcaption></figure>
</div>
<p id="section-9.4.4-3">Each object sent on a fetch stream after the FETCH_HEADER has the following format:<a href="#section-9.4.4-3" class="pilcrow">¶</a></p>
<span id="name-moqt-fetch-object-fields"></span><div id="object-fetch-format">
<figure id="figure-36">
            <div class="alignLeft art-text artwork" id="section-9.4.4-4.1">
<pre>
{
  Group ID (i),
  Subgroup ID (i),
  Object ID (i),
  Publisher Priority (8),
  Extension Headers Length (i),
  [Extension headers (...)],
  Object Payload Length (i),
  [Object Status (i)],
  Object Payload (..),
}
</pre>
</div>
<figcaption><a href="#figure-36" class="selfRef">Figure 36</a>:
<a href="#name-moqt-fetch-object-fields" class="selfRef">MOQT Fetch Object Fields</a>
            </figcaption></figure>
</div>
<p id="section-9.4.4-5">The Object Status field is only sent if the Object Payload Length is zero.<a href="#section-9.4.4-5" class="pilcrow">¶</a></p>
<p id="section-9.4.4-6">The Subgroup ID field of an object with a Forwarding Preference of "Datagram"
(see <a href="#object-properties" class="auto internal xref">Section 9.2.1</a>) is set to the Object ID.<a href="#section-9.4.4-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="section-9.5">
        <h3 id="name-examples">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
        </h3>
<p id="section-9.5-1">Sending a subgroup on one stream:<a href="#section-9.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.5-2">
<pre>
Stream = 2

SUBGROUP_HEADER {
  Type = 0
  Track Alias = 2
  Group ID = 0
  Subgroup ID = 0
  Publisher Priority = 0
}
{
  Object ID = 0
  Object Payload Length = 4
  Payload = "abcd"
}
{
  Object ID = 1
  Object Payload Length = 4
  Payload = "efgh"
}
</pre><a href="#section-9.5-2" class="pilcrow">¶</a>
</div>
<p id="section-9.5-3">Sending a group on one stream, with the first object containing two
Extension Headers.<a href="#section-9.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.5-4">
<pre>
Stream = 2

SUBGROUP_HEADER {
  Type = 1
  Track Alias = 2
  Group ID = 0
  Publisher Priority = 0
}
{
  Object ID = 0
  Extension Headers Length = 33
    { Type = 4
      Value = 2186796243
    },
    { Type = 77
      Length = 21
      Value = "traceID:123456"
    }
  Object Payload Length = 4
  Payload = "abcd"
}
{
  Object ID = 1
  Extension Headers Length = 0
  Object Payload Length = 4
  Payload = "efgh"
}

</pre><a href="#section-9.5-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="extension-headers">
<section id="section-10">
      <h2 id="name-extension-headers">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-extension-headers" class="section-name selfRef">Extension Headers</a>
      </h2>
<p id="section-10-1">The following Object Extension Headers are defined in MOQT.<a href="#section-10-1" class="pilcrow">¶</a></p>
<div id="prior-group-id-gap">
<section id="section-10.1">
        <h3 id="name-prior-group-id-gap">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-prior-group-id-gap" class="section-name selfRef">Prior Group ID Gap</a>
        </h3>
<p id="section-10.1-1">Prior Group ID Gap (Extension Header Type 0x40) is a variable length integer
containing the number of Groups prior to the current Group that do not and will
never exist. For example, if the Original Publisher published an Object in Group
7 and knows it will never publish any Objects in Group 8 or Group 9, it can
include Prior Group ID Gap = 2 in any number of Objects in Group 10, as it sees
fit.  A track with a Group that contains more than one Object with different
values for Prior Group ID Gap or has a Prior Group ID Gap larger than the Group
ID is considered malformed.  If an endpoint receives an Object with a Group ID
within a previously communicated gap it also treats the track as malformed
(see <a href="#malformed-tracks" class="auto internal xref">Section 2.5</a>.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">This extension is optional, as publishers might not know the prior gap gize, or
there may not be a gap. If Prior Group ID Gap is not present, the receiver
cannot infer any information about the existence of prior groups (see
<a href="#group-ordering" class="auto internal xref">Section 2.3.1</a>).<a href="#section-10.1-2" class="pilcrow">¶</a></p>
<p id="section-10.1-3">This extension can be added by the Original Publisher, but <span class="bcp14">MUST NOT</span> be added by
relays. This extension <span class="bcp14">MUST NOT</span> be modified or removed.<a href="#section-10.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-11">
      <h2 id="name-security-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-11-1">TODO: Expand this section, including subscriptions.<a href="#section-11-1" class="pilcrow">¶</a></p>
<div id="resource-exhaustion">
<section id="section-11.1">
        <h3 id="name-resource-exhaustion">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-resource-exhaustion" class="section-name selfRef">Resource Exhaustion</a>
        </h3>
<p id="section-11.1-1">Live content requires significant bandwidth and resources.  Failure to
set limits will quickly cause resource exhaustion.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<p id="section-11.1-2">MOQT uses stream limits and flow control to impose resource limits at
the network layer.  Endpoints <span class="bcp14">SHOULD</span> set flow control limits based on the
anticipated bitrate.<a href="#section-11.1-2" class="pilcrow">¶</a></p>
<p id="section-11.1-3">Endpoints <span class="bcp14">MAY</span> impose a MAX STREAM count limit which would restrict the
number of concurrent streams which an application could have in
flight.<a href="#section-11.1-3" class="pilcrow">¶</a></p>
<p id="section-11.1-4">The publisher prioritizes and transmits streams out of order.  Streams
might be starved indefinitely during congestion.  The publisher and
subscriber <span class="bcp14">MUST</span> cancel a stream, preferably the lowest priority, after
reaching a resource limit.<a href="#section-11.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="timeouts">
<section id="section-11.2">
        <h3 id="name-timeouts">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-timeouts" class="section-name selfRef">Timeouts</a>
        </h3>
<p id="section-11.2-1">Implementations are advised to use timeouts to prevent resource
exhaustion attacks by a peer that does not send expected data within
an expected time.  Each implementation is expected to set its own limits.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-12">
      <h2 id="name-iana-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-12-1">TODO: fill out currently missing registries:<a href="#section-12-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12-2.1">
          <p id="section-12-2.1.1">MOQT version numbers<a href="#section-12-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-2.2">
          <p id="section-12-2.2.1">Setup parameters<a href="#section-12-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-2.3">
          <p id="section-12-2.3.1">Subscribe parameters - List which params can be repeated in the table.<a href="#section-12-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-2.4">
          <p id="section-12-2.4.1">Subscribe Error codes<a href="#section-12-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-2.5">
          <p id="section-12-2.5.1">Subscribe Namespace Error codes<a href="#section-12-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-2.6">
          <p id="section-12-2.6.1">Publish Error codes<a href="#section-12-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-2.7">
          <p id="section-12-2.7.1">Announce Error codes<a href="#section-12-2.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-2.8">
          <p id="section-12-2.8.1">Announce Cancel Reason codes<a href="#section-12-2.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-2.9">
          <p id="section-12-2.9.1">Message types<a href="#section-12-2.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-2.10">
          <p id="section-12-2.10.1">MOQ Extension headers - we wish to reserve extension types 0-63 for
standards utilization where space is a premium, 64 - 16383 for
standards utilization where space is less of a concern, and 16384 and
above for first-come-first-served non-standardization usage.
List which headers can be repeated in the table.<a href="#section-12-2.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-2.11">
          <p id="section-12-2.11.1">MOQT Auth Token Type<a href="#section-12-2.11.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-12-3">TODO: register the URI scheme and the ALPN and grease the Extension types<a href="#section-12-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="section-13">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="section-13-1">The original design behind this protocol was inspired by three independent
proposals: WARP <span>[<a href="#I-D.draft-lcurley-warp" class="cite xref">I-D.draft-lcurley-warp</a>]</span> by Luke Curley, RUSH
<span>[<a href="#I-D.draft-kpugin-rush" class="cite xref">I-D.draft-kpugin-rush</a>]</span> by Kirill Pugin, Nitin Garg, Alan Frindell, Jordi
Cenzano and Jake Weissman, and QUICR <span>[<a href="#I-D.draft-jennings-moq-quicr-proto" class="cite xref">I-D.draft-jennings-moq-quicr-proto</a>]</span> by
Cullen Jennings, Suhas Nandakumar and Christian Huitema.  The authors of those
documents merged their proposals to create the first draft of moq-transport.
The IETF MoQ Working Group received an enormous amount of support from many
people. The following people provided substantive contributions to this
document:<a href="#section-13-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13-2.1">
          <p id="section-13-2.1.1">Ali Begen<a href="#section-13-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-13-2.2">
          <p id="section-13-2.2.1">Charles Krasic<a href="#section-13-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-13-2.3">
          <p id="section-13-2.3.1">Christian Huitema<a href="#section-13-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-13-2.4">
          <p id="section-13-2.4.1">Cullen Jennings<a href="#section-13-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-13-2.5">
          <p id="section-13-2.5.1">James Hurley<a href="#section-13-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-13-2.6">
          <p id="section-13-2.6.1">Jordi Cenzano<a href="#section-13-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-13-2.7">
          <p id="section-13-2.7.1">Kirill Pugin<a href="#section-13-2.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-13-2.8">
          <p id="section-13-2.8.1">Luke Curley<a href="#section-13-2.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-13-2.9">
          <p id="section-13-2.9.1">Martin Duke<a href="#section-13-2.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-13-2.10">
          <p id="section-13-2.10.1">Mike English<a href="#section-13-2.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-13-2.11">
          <p id="section-13-2.11.1">Mo Zanaty<a href="#section-13-2.11.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-13-2.12">
          <p id="section-13-2.12.1">Will Law<a href="#section-13-2.12.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="sec-combined-references">
<section id="section-14">
      <h2 id="name-references">
<a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-14.1">
        <h3 id="name-normative-references">
<a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.draft-ietf-quic-reliable-stream-reset">[I-D.draft-ietf-quic-reliable-stream-reset]</dt>
        <dd>
<span class="refAuthor">Seemann, M.</span> and <span class="refAuthor">K. Oku</span>, <span class="refTitle">"QUIC Stream Resets with Partial Delivery"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-reliable-stream-reset-07</span>, <time datetime="2025-06-14" class="refDate">14 June 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-reliable-stream-reset-07">https://datatracker.ietf.org/doc/html/draft-ietf-quic-reliable-stream-reset-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC">[QUIC]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7301">[RFC7301]</dt>
        <dd>
<span class="refAuthor">Friedl, S.</span>, <span class="refAuthor">Popov, A.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">E. Stephan</span>, <span class="refTitle">"Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension"</span>, <span class="seriesInfo">RFC 7301</span>, <span class="seriesInfo">DOI 10.17487/RFC7301</span>, <time datetime="2014-07" class="refDate">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7301">https://www.rfc-editor.org/rfc/rfc7301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8615">[RFC8615]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Well-Known Uniform Resource Identifiers (URIs)"</span>, <span class="seriesInfo">RFC 8615</span>, <span class="seriesInfo">DOI 10.17487/RFC8615</span>, <time datetime="2019-05" class="refDate">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8615">https://www.rfc-editor.org/rfc/rfc8615</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9110">https://www.rfc-editor.org/rfc/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WebTransport">[WebTransport]</dt>
      <dd>
<span class="refAuthor">Frindell, A.</span>, <span class="refAuthor">Kinnear, E.</span>, and <span class="refAuthor">V. Vasiliev</span>, <span class="refTitle">"WebTransport over HTTP/3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-webtrans-http3-13</span>, <time datetime="2025-07-07" class="refDate">7 July 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-http3-13">https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-http3-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-14.2">
        <h3 id="name-informative-references">
<a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.draft-jennings-moq-quicr-proto">[I-D.draft-jennings-moq-quicr-proto]</dt>
        <dd>
<span class="refAuthor">Jennings, C. F.</span>, <span class="refAuthor">Nandakumar, S.</span>, and <span class="refAuthor">C. Huitema</span>, <span class="refTitle">"QuicR - Media Delivery Protocol over QUIC"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-jennings-moq-quicr-proto-01</span>, <time datetime="2022-07-11" class="refDate">11 July 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-jennings-moq-quicr-proto-01">https://datatracker.ietf.org/doc/html/draft-jennings-moq-quicr-proto-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-kpugin-rush">[I-D.draft-kpugin-rush]</dt>
        <dd>
<span class="refAuthor">Pugin, K.</span>, <span class="refAuthor">Garg, N.</span>, <span class="refAuthor">Frindell, A.</span>, <span class="refAuthor">Ferret, J. C.</span>, and <span class="refAuthor">J. Weissman</span>, <span class="refTitle">"RUSH - Reliable (unreliable) streaming protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-kpugin-rush-03</span>, <time datetime="2025-04-21" class="refDate">21 April 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-kpugin-rush-03">https://datatracker.ietf.org/doc/html/draft-kpugin-rush-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-lcurley-warp">[I-D.draft-lcurley-warp]</dt>
        <dd>
<span class="refAuthor">Curley, L.</span>, <span class="refAuthor">Pugin, K.</span>, <span class="refAuthor">Nandakumar, S.</span>, and <span class="refAuthor">V. Vasiliev</span>, <span class="refTitle">"Warp - Live Media Transport over QUIC"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-lcurley-warp-04</span>, <time datetime="2023-03-13" class="refDate">13 March 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-lcurley-warp-04">https://datatracker.ietf.org/doc/html/draft-lcurley-warp-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-webtrans-overview">[I-D.ietf-webtrans-overview]</dt>
        <dd>
<span class="refAuthor">Kinnear, E.</span> and <span class="refAuthor">V. Vasiliev</span>, <span class="refTitle">"The WebTransport Protocol Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-webtrans-overview-10</span>, <time datetime="2025-07-07" class="refDate">7 July 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-overview-10">https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-overview-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6582">[RFC6582]</dt>
        <dd>
<span class="refAuthor">Henderson, T.</span>, <span class="refAuthor">Floyd, S.</span>, <span class="refAuthor">Gurtov, A.</span>, and <span class="refAuthor">Y. Nishida</span>, <span class="refTitle">"The NewReno Modification to TCP's Fast Recovery Algorithm"</span>, <span class="seriesInfo">RFC 6582</span>, <span class="seriesInfo">DOI 10.17487/RFC6582</span>, <time datetime="2012-04" class="refDate">April 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6582">https://www.rfc-editor.org/rfc/rfc6582</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9438">[RFC9438]</dt>
      <dd>
<span class="refAuthor">Xu, L.</span>, <span class="refAuthor">Ha, S.</span>, <span class="refAuthor">Rhee, I.</span>, <span class="refAuthor">Goel, V.</span>, and <span class="refAuthor">L. Eggert, Ed.</span>, <span class="refTitle">"CUBIC for Fast and Long-Distance Networks"</span>, <span class="seriesInfo">RFC 9438</span>, <span class="seriesInfo">DOI 10.17487/RFC9438</span>, <time datetime="2023-08" class="refDate">August 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9438">https://www.rfc-editor.org/rfc/rfc9438</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="change-log">
<section id="appendix-A">
      <h2 id="name-change-log">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-change-log" class="section-name selfRef">Change Log</a>
      </h2>
<p id="appendix-A-1">RFC Editor's Note: Please remove this section prior to publication of a final version of this document.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">Issue and pull request numbers are listed with a leading octothorp.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<div id="since-draft-ietf-moq-transport-12">
<section id="appendix-A.1">
        <h3 id="name-since-draft-ietf-moq-transp">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-since-draft-ietf-moq-transp" class="section-name selfRef">Since draft-ietf-moq-transport-12</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.1-1.1">
            <p id="appendix-A.1-1.1.1">TRACK_STATUS_REQUEST and TRACK_STATUS have changed to directly mirror
SUBSCRIBE/OK/ERROR (#1015)<a href="#appendix-A.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.2">
            <p id="appendix-A.1-1.2.1">SUBSCRIBE_ANNOUNCES was renamed back to SUBSCRIBE_NAMESPACE (#1049)<a href="#appendix-A.1-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-ietf-moq-transport-11">
<section id="appendix-A.2">
        <h3 id="name-since-draft-ietf-moq-transpo">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-since-draft-ietf-moq-transpo" class="section-name selfRef">Since draft-ietf-moq-transport-11</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.2-1.1">
            <p id="appendix-A.2-1.1.1">Move Track Alias from SUBSCRIBE to SUBSCRIBE_OK (#977)<a href="#appendix-A.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.2">
            <p id="appendix-A.2-1.2.1">Expand cases FETCH_OK returns Invalid Range (#946) and clarify fields (#936)<a href="#appendix-A.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.3">
            <p id="appendix-A.2-1.3.1">Add an error code to FETCH_ERROR when an Object status is unknown (#825)<a href="#appendix-A.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.4">
            <p id="appendix-A.2-1.4.1">Rename Latest Object to Largest Object (#1024) and clarify what to
do when it's incomplete (#937)<a href="#appendix-A.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.5">
            <p id="appendix-A.2-1.5.1">Explain Malformed Tracks and what to do with them (#938)<a href="#appendix-A.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.6">
            <p id="appendix-A.2-1.6.1">Allow End of Group to be indicated in a normal Object (#1011)<a href="#appendix-A.2-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.7">
            <p id="appendix-A.2-1.7.1">Relays <span class="bcp14">MUST</span> have an upstream subscription to send SUBSCRIBE_OK (#1017)<a href="#appendix-A.2-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.8">
            <p id="appendix-A.2-1.8.1">Allow AUTHORIZATION TOKEN in CLIENT_SETUP, SERVER_SETUP and
other fixes (#1013)<a href="#appendix-A.2-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.9">
            <p id="appendix-A.2-1.9.1">Add PUBLISH for publisher initiated subscriptions (#995) and
fix the PUBLISH codepoints (#1048, #1051)<a href="#appendix-A.2-1.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-ietf-moq-transport-10">
<section id="appendix-A.3">
        <h3 id="name-since-draft-ietf-moq-transpor">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-since-draft-ietf-moq-transpor" class="section-name selfRef">Since draft-ietf-moq-transport-10</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.3-1.1">
            <p id="appendix-A.3-1.1.1">Added Common Structure definitions - Location, Key-Value-Pair and Reason
Phrase<a href="#appendix-A.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.2">
            <p id="appendix-A.3-1.2.1">Limit lengths of all variable length fields, including Track Namespace and Name<a href="#appendix-A.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.3">
            <p id="appendix-A.3-1.3.1">Control Message length is now 16 bits instead of variable length<a href="#appendix-A.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.4">
            <p id="appendix-A.3-1.4.1">Subscribe ID became Request ID, and was added to most control messages. Request ID
is used to correlate OK/ERROR responses for ANNOUNCE, SUBSCRIBE_NAMESPACE,
and TRACK_STATUS.  Like Subscribe ID, Request IDs are flow controlled.<a href="#appendix-A.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.5">
            <p id="appendix-A.3-1.5.1">Explain rules for caching in more detail<a href="#appendix-A.3-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.6">
            <p id="appendix-A.3-1.6.1">Changed the SETUP parameter format for even number parameters to match the
Object Header Extension format<a href="#appendix-A.3-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.7">
            <p id="appendix-A.3-1.7.1">Rotated SETUP code points<a href="#appendix-A.3-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.8">
            <p id="appendix-A.3-1.8.1">Added Parameters to TRACK_STATUS and TRACK_STATUS_REQUEST<a href="#appendix-A.3-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.9">
            <p id="appendix-A.3-1.9.1">Clarified how subscribe filters work<a href="#appendix-A.3-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.10">
            <p id="appendix-A.3-1.10.1">Added Next Group Filter to SUBSCRIBE<a href="#appendix-A.3-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.11">
            <p id="appendix-A.3-1.11.1">Added Forward flag to SUBSCRIBE<a href="#appendix-A.3-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.12">
            <p id="appendix-A.3-1.12.1">Renamed FETCH_OK field to End and clarified how to set it<a href="#appendix-A.3-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.13">
            <p id="appendix-A.3-1.13.1">Added Absolute Joining Fetch<a href="#appendix-A.3-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.14">
            <p id="appendix-A.3-1.14.1">Clarified No Error vs Invalid Range FETCH_ERROR cases<a href="#appendix-A.3-1.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.15">
            <p id="appendix-A.3-1.15.1">Use bits in SUBGROUP_HEADER and DATAGRAM* types to compress subgroup ID and
extensions<a href="#appendix-A.3-1.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.16">
            <p id="appendix-A.3-1.16.1">Coalesced END_OF_GROUP and END_OF_TRACK_AND_GROUP status<a href="#appendix-A.3-1.16.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.17">
            <p id="appendix-A.3-1.17.1">Objects that Do Not Exist cannot have extensions when sent on the wire<a href="#appendix-A.3-1.17.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.18">
            <p id="appendix-A.3-1.18.1">Specified error codes for resetting data streams<a href="#appendix-A.3-1.18.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.19">
            <p id="appendix-A.3-1.19.1">Defined an Object Header Extension for communicating a known Group ID gap<a href="#appendix-A.3-1.19.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.20">
            <p id="appendix-A.3-1.20.1">Replaced AUTHORIZATION_INFO with AUTHORIZATION_TOKEN, which has more structure,
compression, and additional Auth related error codes (#760)<a href="#appendix-A.3-1.20.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Suhas Nandakumar</span></div>
<div dir="auto" class="left"><span class="org">Cisco</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:snandaku@cisco.com" class="email">snandaku@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Victor Vasiliev</span></div>
<div dir="auto" class="left"><span class="org">Google</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:vasilvv@google.com" class="email">vasilvv@google.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ian Swett (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Google</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ianswett@google.com" class="email">ianswett@google.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Alan Frindell (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Meta</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:afrind@meta.com" class="email">afrind@meta.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
